/*! For license information please see component---src-pages-index-js-836ed9b2d609e1dc419d.js.LICENSE.txt */
(self.webpackChunktrainwreck=self.webpackChunktrainwreck||[]).push([[678],{4378:function(){},2549:function(t,e,n){"use strict";n.d(e,{A7:function(){return g},G5:function(){return x},I2:function(){return o},Nt:function(){return f},T$:function(){return s},UN:function(){return y},V0:function(){return i},Vi:function(){return r},WB:function(){return d},aH:function(){return c},cB:function(){return m},iw:function(){return p},lg:function(){return a},mr:function(){return _},oT:function(){return l},sp:function(){return u},vK:function(){return h},yl:function(){return v}});var r=function(t){return t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2",t}(r||{}),i=function(t){return t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t}(i||{}),s=function(t){return t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR",t}(s||{}),a=function(t){return t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t}(a||{}),o=function(t){return t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t}(o||{}),u=function(t){return t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t}(u||{}),h=function(t){return t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT",t}(h||{}),l=function(t){return t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT",t}(l||{}),c=function(t){return t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR",t}(c||{}),f=function(t){return t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t}(f||{}),d=function(t){return t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL",t}(d||{}),p=function(t){return t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",t}(p||{}),v=function(t){return t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT",t}(v||{}),y=function(t){return t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL",t}(y||{}),m=function(t){return t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp",t}(m||{}),g=function(t){return t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR",t}(g||{}),x=function(t){return t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH",t}(x||{}),_=function(t){return t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t}(_||{})},4662:function(t,e,n){"use strict";n.d(e,{iw:function(){return s.iw},T$:function(){return s.T$},VL:function(){return xt},a$:function(){return ir},JZ:function(){return hr},Ie:function(){return sr},lW:function(){return re},qm:function(){return vt},yl:function(){return s.yl},Cd:function(){return o.Cd},ZX:function(){return o.ZX},lg:function(){return s.lg},Pj:function(){return o.Pj},nw:function(){return a.n},I2:function(){return s.I2},wn:function(){return qe},wG:function(){return ue},A7:function(){return s.A7},KI:function(){return s.WB},y3:function(){return o.y3},bO:function(){return xe},AB:function(){return o.AB},_b:function(){return o._b},E9:function(){return o.E9},mg:function(){return o.mg},$r:function(){return ze},ud:function(){return fe},jl:function(){return o.jl},Ae:function(){return o.Ae},TI:function(){return Jt},c9:function(){return o.c9},HS:function(){return o.HS},pX:function(){return Ot},ex:function(){return Ve},ZM:function(){return Ye},vK:function(){return s.vK},xE:function(){return $t},UX:function(){return Qe},vB:function(){return c.vB},wx:function(){return o.wx},uF:function(){return c.uF},oo:function(){return pe},Rv:function(){return ar},Nt:function(){return s.Nt},e6:function(){return Qn},Y9:function(){return tr},kP:function(){return Jn},Rw:function(){return a.R},Xd:function(){return i.Xd},P6:function(){return r}});var r={};n.r(r),n.d(r,{BaseTextureCache:function(){return $},CanvasRenderTarget:function(){return tt},DATA_URI:function(){return nt},EventEmitter:function(){return d()},ProgramCache:function(){return K},TextureCache:function(){return q},clearTextureCache:function(){return J},correctBlendMode:function(){return C},createIndicesForQuads:function(){return N},decomposeDataUri:function(){return rt},deprecation:function(){return Y},destroyTextureCache:function(){return Q},determineCrossOrigin:function(){return st},earcut:function(){return v()},getBufferType:function(){return L},getResolutionOfUrl:function(){return at},hex2rgb:function(){return R},hex2string:function(){return S},interleaveTypedArrays:function(){return F},isMobile:function(){return i.tq},isPow2:function(){return G},isWebGLSupported:function(){return T},log2:function(){return H},nextPow2:function(){return U},path:function(){return b},premultiplyBlendMode:function(){return M},premultiplyRgba:function(){return O},premultiplyTint:function(){return D},premultiplyTintToRgba:function(){return B},removeItems:function(){return X},rgb2hex:function(){return P},sayHello:function(){return E},sign:function(){return W},skipHello:function(){return w},string2hex:function(){return I},trimCanvas:function(){return et},uid:function(){return z},url:function(){return m}});var i=n(1025),s=n(2549);i.Xd.PREFER_ENV=s.Vi.WEBGL2,i.Xd.STRICT_TEXTURE_CACHE=!1;var a=n(4734),o=n(4386),u=n(5671),h=n(3144),l=function(){function t(e){(0,u.Z)(this,t),this.items=[],this._name=e,this._aliasCount=0}return(0,h.Z)(t,[{key:"emit",value:function(t,e,n,r,i,s,a,o){if(arguments.length>8)throw new Error("max arguments reached");var u=this.name,h=this.items;this._aliasCount++;for(var l=0,c=h.length;l<c;l++)h[l][u](t,e,n,r,i,s,a,o);return h===this.items&&this._aliasCount--,this}},{key:"ensureNonAliasedItems",value:function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}},{key:"add",value:function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}},{key:"remove",value:function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}},{key:"contains",value:function(t){return this.items.includes(t)}},{key:"removeAll",value:function(){return this.ensureNonAliasedItems(),this.items.length=0,this}},{key:"destroy",value:function(){this.removeAll(),this.items=null,this._name=null}},{key:"empty",get:function(){return 0===this.items.length}},{key:"name",get:function(){return this._name}}]),t}();Object.defineProperties(l.prototype,{dispatch:{value:l.prototype.emit},run:{value:l.prototype.emit}});var c=n(6397),f=n(5556),d=n.n(f),p=n(7478),v=n.n(p),y=n(3629),m={parse:y.Qc,format:y.WU,resolve:y.DB};function g(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received ".concat(JSON.stringify(t)))}function x(t){return t.split("?")[0].split("#")[0]}var _,b={toPosix:function(t){return e="\\",n="/",t.replace(new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),n);var e,n},isUrl:function(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:function(t){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t)},hasProtocol:function(t){return/^[^/:]+:\//.test(this.toPosix(t))},getProtocol:function(t){g(t),t=this.toPosix(t);var e="",n=/^file:\/\/\//.exec(t),r=/^[^/:]+:\/\//.exec(t),i=/^[^/:]+:\//.exec(t);if(n||r||i){var s=(null==n?void 0:n[0])||(null==r?void 0:r[0])||(null==i?void 0:i[0]);e=s,t=t.slice(s.length)}return e},toAbsolute:function(t,e,n){if(this.isDataUrl(t))return t;var r=x(this.toPosix(null!=e?e:i.Xd.ADAPTER.getBaseUrl())),s=x(this.toPosix(null!=n?n:this.rootname(r)));return g(t),(t=this.toPosix(t)).startsWith("/")?b.join(s,t.slice(1)):this.isAbsolute(t)?t:this.join(r,t)},normalize:function(t){if(g(t=this.toPosix(t)),0===t.length)return".";var e="",n=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));var r=t.endsWith("/");return(t=function(t,e){for(var n,r="",i=0,s=-1,a=0,o=0;o<=t.length;++o){if(o<t.length)n=t.charCodeAt(o);else{if(47===n)break;n=47}if(47===n){if(s===o-1||1===a);else if(s!==o-1&&2===a){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){-1===u?(r="",i=0):i=(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),s=o,a=0;continue}}else if(2===r.length||1===r.length){r="",i=0,s=o,a=0;continue}e&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/".concat(t.slice(s+1,o)):r=t.slice(s+1,o),i=o-s-1;s=o,a=0}else 46===n&&-1!==a?++a:a=-1}return r}(t,!1)).length>0&&r&&(t+="/"),n?"/".concat(t):e+t},isAbsolute:function(t){return g(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join:function(){if(0===arguments.length)return".";for(var t,e=0;e<arguments.length;++e){var n=e<0||arguments.length<=e?void 0:arguments[e];if(g(n),n.length>0)if(void 0===t)t=n;else{var r,i=null!==(r=e-1<0||arguments.length<=e-1?void 0:arguments[e-1])&&void 0!==r?r:"";this.extname(i)?t+="/../".concat(n):t+="/".concat(n)}}return void 0===t?".":this.normalize(t)},dirname:function(t){if(g(t),0===t.length)return".";for(var e=(t=this.toPosix(t)).charCodeAt(0),n=47===e,r=-1,i=!0,s=this.getProtocol(t),a=t,o=(t=t.slice(s.length)).length-1;o>=1;--o)if(47===(e=t.charCodeAt(o))){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":this.isUrl(a)?s+t:s:n&&1===r?"//":s+t.slice(0,r)},rootname:function(t){g(t);var e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){var n=t.indexOf("/",e.length);(e=-1!==n?t.slice(0,n):t).endsWith("/")||(e+="/")}return e},basename:function(t,e){g(t),e&&g(e),t=this.toPosix(t);var n,r=0,i=-1,s=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var a=e.length-1,o=-1;for(n=t.length-1;n>=0;--n){var u=t.charCodeAt(n);if(47===u){if(!s){r=n+1;break}}else-1===o&&(s=!1,o=n+1),a>=0&&(u===e.charCodeAt(a)?-1==--a&&(i=n):(a=-1,i=o))}return r===i?i=o:-1===i&&(i=t.length),t.slice(r,i)}for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!s){r=n+1;break}}else-1===i&&(s=!1,i=n+1);return-1===i?"":t.slice(r,i)},extname:function(t){g(t);for(var e=-1,n=0,r=-1,i=!0,s=0,a=(t=this.toPosix(t)).length-1;a>=0;--a){var o=t.charCodeAt(a);if(47!==o)-1===r&&(i=!1,r=a+1),46===o?-1===e?e=a:1!==s&&(s=1):-1!==e&&(s=-1);else if(!i){n=a+1;break}}return-1===e||-1===r||0===s||1===s&&e===r-1&&e===n+1?"":t.slice(e,r)},parse:function(t){g(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;var n,r=(t=this.toPosix(t)).charCodeAt(0),i=this.isAbsolute(t);e.root=this.rootname(t),n=i||this.hasProtocol(t)?1:0;for(var s=-1,a=0,o=-1,u=!0,h=t.length-1,l=0;h>=n;--h)if(47!==(r=t.charCodeAt(h)))-1===o&&(u=!1,o=h+1),46===r?-1===s?s=h:1!==l&&(l=1):-1!==s&&(l=-1);else if(!u){a=h+1;break}return-1===s||-1===o||0===l||1===l&&s===o-1&&s===a+1?-1!==o&&(e.base=e.name=0===a&&i?t.slice(1,o):t.slice(a,o)):(0===a&&i?(e.name=t.slice(1,s),e.base=t.slice(1,o)):(e.name=t.slice(a,s),e.base=t.slice(a,o)),e.ext=t.slice(s,o)),e.dir=this.dirname(t),e},sep:"/",delimiter:":"};function w(){}function E(){}function T(){return void 0===_&&(_=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:i.Xd.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!i.Xd.ADAPTER.getWebGLRenderingContext())return!1;var e=i.Xd.ADAPTER.createCanvas(),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),r=!(!n||!n.getContextAttributes().stencil);if(n){var s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=null,r}catch(a){return!1}}()),_}i.Xd.RETINA_PREFIX=/@([0-9\.]+)x/,i.Xd.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var k=n(885),A={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function R(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function S(t){var e=t.toString(16);return e="000000".substring(0,6-e.length)+e,"#".concat(e)}function I(t){if("string"==typeof t&&("#"===(t=A[t.toLowerCase()]||t)[0]&&(t=t.slice(1)),3===t.length)){var e=t,n=(0,k.Z)(e,3),r=n[0],i=n[1],s=n[2];t=r+r+i+i+s+s}return parseInt(t,16)}function P(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}var M=function(){for(var t=[],e=[],n=0;n<32;n++)t[n]=n,e[n]=n;t[s.T$.NORMAL_NPM]=s.T$.NORMAL,t[s.T$.ADD_NPM]=s.T$.ADD,t[s.T$.SCREEN_NPM]=s.T$.SCREEN,e[s.T$.NORMAL]=s.T$.NORMAL_NPM,e[s.T$.ADD]=s.T$.ADD_NPM,e[s.T$.SCREEN]=s.T$.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function C(t,e){return M[e?1:0][t]}function O(t,e,n,r){return n=n||new Float32Array(4),r||void 0===r?(n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e):(n[0]=t[0],n[1]=t[1],n[2]=t[2]),n[3]=e,n}function D(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var n=t>>16&255,r=t>>8&255,i=255&t;return(255*e<<24)+((n=n*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(i=i*e+.5|0)}function B(t,e,n,r){return(n=n||new Float32Array(4))[0]=(t>>16&255)/255,n[1]=(t>>8&255)/255,n[2]=(255&t)/255,(r||void 0===r)&&(n[0]*=e,n[1]*=e,n[2]*=e),n[3]=e,n}function N(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got ".concat(e.length," and expected ").concat(n));for(var r=0,i=0;r<n;r+=6,i+=4)e[r+0]=i+0,e[r+1]=i+1,e[r+2]=i+2,e[r+3]=i+0,e[r+4]=i+2,e[r+5]=i+3;return e}function L(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var Z={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function F(t,e){for(var n=0,r=0,i={},s=0;s<t.length;s++)r+=e[s],n+=t[s].length;for(var a=new ArrayBuffer(4*n),o=null,u=0,h=0;h<t.length;h++){var l=e[h],c=t[h],f=L(c);i[f]||(i[f]=new Z[f](a)),o=i[f];for(var d=0;d<c.length;d++){o[(d/l|0)*r+u+d%l]=c[d]}u+=l}return new Float32Array(a)}function U(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function G(t){return!(t&t-1||!t)}function H(t){var e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,e|=n=((t>>>=n)>15?1:0)<<2,(e|=n=((t>>>=n)>3?1:0)<<1)|(t>>>=n)>>1}function X(t,e,n){var r,i=t.length;if(!(e>=i||0===n)){var s=i-(n=e+n>i?i-e:n);for(r=e;r<s;++r)t[r]=t[r+n];t.length=s}}function W(t){return 0===t?0:t<0?-1:1}var j=0;function z(){return++j}var V={};function Y(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(!V[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ","".concat(e,"\nDeprecated since v").concat(t)):(r=r.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6","".concat(e,"\nDeprecated since v").concat(t)),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ","".concat(e,"\nDeprecated since v").concat(t)),console.warn(r))),V[e]=!0}}var K={},q=Object.create(null),$=Object.create(null);function Q(){var t;for(t in q)q[t].destroy();for(t in $)$[t].destroy()}function J(){var t;for(t in q)delete q[t];for(t in $)delete $[t]}var tt=function(){function t(e,n,r){(0,u.Z)(this,t),this.canvas=i.Xd.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=r||i.Xd.RESOLUTION,this.resize(e,n)}return(0,h.Z)(t,[{key:"clear",value:function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"resize",value:function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)}},{key:"destroy",value:function(){this.context=null,this.canvas=null}},{key:"width",get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)}},{key:"height",get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)}}]),t}();function et(t){var e,n,r,i=t.width,s=t.height,a=t.getContext("2d",{willReadFrequently:!0}),o=a.getImageData(0,0,i,s).data,u=o.length,h={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<u;e+=4)0!==o[e+3]&&(n=e/4%i,r=~~(e/4/i),null===h.top&&(h.top=r),(null===h.left||n<h.left)&&(h.left=n),(null===h.right||h.right<n)&&(h.right=n+1),(null===h.bottom||h.bottom<r)&&(h.bottom=r));return null!==h.top&&(i=h.right-h.left,s=h.bottom-h.top+1,l=a.getImageData(h.left,h.top,i,s)),{height:s,width:i,data:l}}var nt=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function rt(t){var e=nt.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}var it;n(5743);function st(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:globalThis.location;if(t.startsWith("data:"))return"";e=e||globalThis.location,it||(it=document.createElement("a")),it.href=t;var n=m.parse(it.href),r=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&r&&n.protocol===e.protocol?"":"anonymous"}function at(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=i.Xd.RETINA_PREFIX.exec(t);return n?parseFloat(n[1]):e}var ot=[];function ut(t,e){if(!t)return null;var n="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(n=r[1].toLowerCase())}for(var i=ot.length-1;i>=0;--i){var s=ot[i];if(s.test&&s.test(t,n))return new s(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}var ht=n(1752),lt=n(136),ct=n(2963),ft=n(1120),dt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,u.Z)(this,t),this._width=e,this._height=n,this.destroyed=!1,this.internal=!1,this.onResize=new l("setRealSize"),this.onUpdate=new l("update"),this.onError=new l("onError")}return(0,h.Z)(t,[{key:"bind",value:function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}},{key:"unbind",value:function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}},{key:"resize",value:function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))}},{key:"valid",get:function(){return!!this._width&&!!this._height}},{key:"update",value:function(){this.destroyed||this.onUpdate.emit()}},{key:"load",value:function(){return Promise.resolve(this)}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"style",value:function(t,e,n){return!1}},{key:"dispose",value:function(){}},{key:"destroy",value:function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}}],[{key:"test",value:function(t,e){return!1}}]),t}();function pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var vt=function(t){(0,lt.Z)(n,t);var e=pt(n);function n(t,r){var i;(0,u.Z)(this,n);var s=r||{},a=s.width,o=s.height;if(!a||!o)throw new Error("BufferResource width or height invalid");return(i=e.call(this,a,o)).data=t,i}return(0,h.Z)(n,[{key:"upload",value:function(t,e,n){var r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===s.iw.UNPACK);var i=e.realWidth,a=e.realHeight;return n.width===i&&n.height===a?r.texSubImage2D(e.target,0,0,0,i,a,e.format,n.type,this.data):(n.width=i,n.height=a,r.texImage2D(e.target,0,n.internalFormat,i,a,0,e.format,n.type,this.data)),!0}},{key:"dispose",value:function(){this.data=null}}],[{key:"test",value:function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}]),n}(dt);function yt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var mt={scaleMode:s.aH.NEAREST,format:s.I2.RGBA,alphaMode:s.iw.NPM},gt=function(t){(0,lt.Z)(n,t);var e=yt(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,u.Z)(this,n),t=e.call(this);var o=a=a||{},h=o.alphaMode,l=o.mipmap,c=o.anisotropicLevel,f=o.scaleMode,d=o.width,p=o.height,v=o.wrapMode,y=o.format,m=o.type,g=o.target,x=o.resolution,_=o.resourceOptions;return!r||r instanceof dt||((r=ut(r,_)).internal=!0),t.resolution=x||i.Xd.RESOLUTION,t.width=Math.round((d||0)*t.resolution)/t.resolution,t.height=Math.round((p||0)*t.resolution)/t.resolution,t._mipmap=null!=l?l:i.Xd.MIPMAP_TEXTURES,t.anisotropicLevel=null!=c?c:i.Xd.ANISOTROPIC_LEVEL,t._wrapMode=v||i.Xd.WRAP_MODE,t._scaleMode=null!=f?f:i.Xd.SCALE_MODE,t.format=y||s.I2.RGBA,t.type=m||s.vK.UNSIGNED_BYTE,t.target=g||s.sp.TEXTURE_2D,t.alphaMode=null!=h?h:s.iw.UNPACK,t.uid=z(),t.touched=0,t.isPowerOfTwo=!1,t._refreshPOT(),t._glTextures={},t.dirtyId=0,t.dirtyStyleId=0,t.cacheId=null,t.valid=d>0&&p>0,t.textureCacheIds=[],t.destroyed=!1,t.resource=null,t._batchEnabled=0,t._batchLocation=0,t.parentTextureArray=null,t.setResource(r),t}return(0,h.Z)(n,[{key:"realWidth",get:function(){return Math.round(this.width*this.resolution)}},{key:"realHeight",get:function(){return Math.round(this.height*this.resolution)}},{key:"mipmap",get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}},{key:"scaleMode",get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}},{key:"wrapMode",get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}},{key:"setStyle",value:function(t,e){var n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this}},{key:"setSize",value:function(t,e,n){return n=n||this.resolution,this.setRealSize(t*n,e*n,n)}},{key:"setRealSize",value:function(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}},{key:"_refreshPOT",value:function(){this.isPowerOfTwo=G(this.realWidth)&&G(this.realHeight)}},{key:"setResolution",value:function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this}},{key:"setResource",value:function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}},{key:"update",value:function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}},{key:"onError",value:function(t){this.emit("error",this,t)}},{key:"destroy",value:function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete $[this.cacheId],delete q[this.cacheId],this.cacheId=null),this.dispose(),n.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}},{key:"dispose",value:function(){this.emit("dispose",this)}},{key:"castToBaseTexture",value:function(){return this}}],[{key:"from",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.Xd.STRICT_TEXTURE_CACHE,s="string"==typeof t,a=null;if(s)a=t;else{if(!t._pixiId){var o=(null==e?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId="".concat(o,"_").concat(z())}a=t._pixiId}var u=$[a];if(s&&r&&!u)throw new Error('The cacheId "'.concat(a,'" does not exist in BaseTextureCache.'));return u||((u=new n(t,e)).cacheId=a,n.addToCache(u,a)),u}},{key:"fromBuffer",value:function(t,e,r,i){t=t||new Float32Array(e*r*4);var a=new vt(t,{width:e,height:r}),o=t instanceof Float32Array?s.vK.FLOAT:s.vK.UNSIGNED_BYTE;return new n(a,Object.assign({},mt,i||{width:e,height:r,type:o}))}},{key:"addToCache",value:function(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),$[e]&&console.warn("BaseTexture added to the cache with an id [".concat(e,"] that already had an entry")),$[e]=t)}},{key:"removeFromCache",value:function(t){if("string"==typeof t){var e=$[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete $[t],e}}else if(null!=t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete $[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null}}]),n}(d()),xt=gt;function _t(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}xt._globalBatch=0;var bt=function(t){(0,lt.Z)(n,t);var e=_t(n);function n(t,r){var i;(0,u.Z)(this,n);var s=r||{},a=s.width,o=s.height;(i=e.call(this,a,o)).items=[],i.itemDirtyIds=[];for(var h=0;h<t;h++){var l=new xt;i.items.push(l),i.itemDirtyIds.push(-2)}return i.length=t,i._load=null,i.baseTexture=null,i}return(0,h.Z)(n,[{key:"initFromArray",value:function(t,e){for(var n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof dt?this.addResourceAt(t[n],n):this.addResourceAt(ut(t[n],e),n))}},{key:"dispose",value:function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}},{key:"addResourceAt",value:function(t,e){if(!this.items[e])throw new Error("Index ".concat(e," is out of bounds"));return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}},{key:"bind",value:function(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");(0,ht.Z)((0,ft.Z)(n.prototype),"bind",this).call(this,t);for(var e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}},{key:"unbind",value:function(t){(0,ht.Z)((0,ft.Z)(n.prototype),"unbind",this).call(this,t);for(var e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}},{key:"load",value:function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],n=e.realWidth,r=e.realHeight;return t.resize(n,r),Promise.resolve(t)})),this._load}}]),n}(dt);function wt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var Et=function(t){(0,lt.Z)(n,t);var e=wt(n);function n(t,r){var i;(0,u.Z)(this,n);var s,a,o=r||{},h=o.width,l=o.height;return Array.isArray(t)?(s=t,a=t.length):a=t,i=e.call(this,a,{width:h,height:l}),s&&i.initFromArray(s,r),i}return(0,h.Z)(n,[{key:"addBaseTextureAt",value:function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this}},{key:"bind",value:function(t){(0,ht.Z)((0,ft.Z)(n.prototype),"bind",this).call(this,t),t.target=s.sp.TEXTURE_2D_ARRAY}},{key:"upload",value:function(t,e,n){var r=this.length,i=this.itemDirtyIds,s=this.items,a=t.gl;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,e.format,n.type,null);for(var o=0;o<r;o++){var u=s[o];i[o]<u.dirtyId&&(i[o]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,o,u.resource.width,u.resource.height,1,e.format,n.type,u.resource.source))}return!0}}]),n}(bt);function Tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var kt=function(t){(0,lt.Z)(n,t);var e=Tt(n);function n(t){var r;(0,u.Z)(this,n);var i=t,s=i.naturalWidth||i.videoWidth||i.width,a=i.naturalHeight||i.videoHeight||i.height;return(r=e.call(this,s,a)).source=t,r.noSubImage=!1,r}return(0,h.Z)(n,[{key:"upload",value:function(t,e,n,r){var i=t.gl,a=e.realWidth,o=e.realHeight;if(r=r||this.source,"undefined"!=typeof HTMLImageElement&&r instanceof HTMLImageElement){if(!r.complete||0===r.naturalWidth)return!1}else if("undefined"!=typeof HTMLVideoElement&&r instanceof HTMLVideoElement&&r.readyState<=1&&0===r.buffered.length)return!1;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===s.iw.UNPACK),this.noSubImage||e.target!==i.TEXTURE_2D||n.width!==a||n.height!==o?(n.width=a,n.height=o,i.texImage2D(e.target,0,n.internalFormat,e.format,n.type,r)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,e.format,n.type,r),!0}},{key:"update",value:function(){if(!this.destroyed){var t=this.source,e=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;this.resize(e,r),(0,ht.Z)((0,ft.Z)(n.prototype),"update",this).call(this)}}},{key:"dispose",value:function(){this.source=null}}],[{key:"crossOrigin",value:function(t,e,n){void 0!==n||e.startsWith("data:")?!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous"):t.crossOrigin=st(e)}}]),n}(dt);function At(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var Rt=function(t){(0,lt.Z)(n,t);var e=At(n);function n(t){return(0,u.Z)(this,n),e.call(this,t)}return(0,h.Z)(n,null,[{key:"test",value:function(t){var e=globalThis.OffscreenCanvas;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}]),n}(kt);function St(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var It=function(t){(0,lt.Z)(n,t);var e=St(n);function n(t,r){var i;(0,u.Z)(this,n);var a=r||{},o=a.width,h=a.height,l=a.autoLoad,c=a.linkBaseTexture;if(t&&t.length!==n.SIDES)throw new Error("Invalid length. Got ".concat(t.length,", expected 6"));i=e.call(this,6,{width:o,height:h});for(var f=0;f<n.SIDES;f++)i.items[f].target=s.sp.TEXTURE_CUBE_MAP_POSITIVE_X+f;return i.linkBaseTexture=!1!==c,t&&i.initFromArray(t,r),!1!==l&&i.load(),i}return(0,h.Z)(n,[{key:"bind",value:function(t){(0,ht.Z)((0,ft.Z)(n.prototype),"bind",this).call(this,t),t.target=s.sp.TEXTURE_CUBE_MAP}},{key:"addBaseTextureAt",value:function(t,e,n){if(void 0===n&&(n=this.linkBaseTexture),!this.items[e])throw new Error("Index ".concat(e," is out of bounds"));if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=s.sp.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}},{key:"upload",value:function(t,e,r){for(var i=this.itemDirtyIds,s=0;s<n.SIDES;s++){var a=this.items[s];(i[s]<a.dirtyId||r.dirtyId<e.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(t,a,r),i[s]=a.dirtyId):i[s]<-1&&(t.gl.texImage2D(a.target,0,r.internalFormat,e.realWidth,e.realHeight,0,e.format,r.type,null),i[s]=-1))}return!0}}],[{key:"test",value:function(t){return Array.isArray(t)&&t.length===n.SIDES}}]),n}(bt);function Pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}It.SIDES=6;var Mt=function(t){(0,lt.Z)(n,t);var e=Pt(n);function n(t,r){var s,a;if((0,u.Z)(this,n),r=r||{},"string"==typeof t){var o=new Image;kt.crossOrigin(o,t,r.crossorigin),o.src=t,t=o}return a=e.call(this,t),!t.complete&&a._width&&a._height&&(a._width=0,a._height=0),a.url=t.src,a._process=null,a.preserveBitmap=!1,a.createBitmap=(null!==(s=r.createBitmap)&&void 0!==s?s:i.Xd.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,a.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,a.bitmap=null,a._load=null,!1!==r.autoLoad&&a.load(),a}return(0,h.Z)(n,[{key:"load",value:function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,n){var r=e.source;e.url=r.src;var i=function(){e.destroyed||(r.onload=null,r.onerror=null,e.resize(r.width,r.height),e._load=null,e.createBitmap?t(e.process()):t(e))};r.complete&&r.src?i():(r.onload=i,r.onerror=function(t){n(t),e.onError.emit(t)})}))),this._load}},{key:"process",value:function(){var t=this,e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var n=globalThis.createImageBitmap,r=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:r?"cors":"no-cors"}).then((function(t){return t.blob()})).then((function(r){return n(r,0,0,e.width,e.height,{premultiplyAlpha:null===t.alphaMode||t.alphaMode===s.iw.UNPACK?"premultiply":"none"})})).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process}},{key:"upload",value:function(t,e,r){if("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),!this.createBitmap)return(0,ht.Z)((0,ft.Z)(n.prototype),"upload",this).call(this,t,e,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if((0,ht.Z)((0,ft.Z)(n.prototype),"upload",this).call(this,t,e,r,this.bitmap),!this.preserveBitmap){var i=!0,s=e._glTextures;for(var a in s){var o=s[a];if(o!==r&&o.dirtyId!==e.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}},{key:"dispose",value:function(){this.source.onload=null,this.source.onerror=null,(0,ht.Z)((0,ft.Z)(n.prototype),"dispose",this).call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}}],[{key:"test",value:function(t){return"undefined"!=typeof HTMLImageElement&&("string"==typeof t||t instanceof HTMLImageElement)}}]),n}(kt);function Ct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var Ot=function(t){(0,lt.Z)(n,t);var e=Ct(n);function n(t,r){var s;return(0,u.Z)(this,n),r=r||{},(s=e.call(this,i.Xd.ADAPTER.createCanvas()))._width=0,s._height=0,s.svg=t,s.scale=r.scale||1,s._overrideWidth=r.width,s._overrideHeight=r.height,s._resolve=null,s._crossorigin=r.crossorigin,s._load=null,!1!==r.autoLoad&&s.load(),s}return(0,h.Z)(n,[{key:"load",value:function(){var t=this;return this._load||(this._load=new Promise((function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},n.SVG_XML.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,".concat(btoa(unescape(encodeURIComponent(t.svg))))}t._loadSvg()}))),this._load}},{key:"_loadSvg",value:function(){var t=this,e=new Image;kt.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(n){t._resolve&&(e.onerror=null,t.onError.emit(n))},e.onload=function(){if(t._resolve){var n=e.width,r=e.height;if(!n||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=n*t.scale,s=r*t.scale;(t._overrideWidth||t._overrideHeight)&&(i=t._overrideWidth||t._overrideHeight/r*n,s=t._overrideHeight||t._overrideWidth/n*r),i=Math.round(i),s=Math.round(s);var a=t.source;a.width=i,a.height=s,a._pixiId="canvas_".concat(z()),a.getContext("2d").drawImage(e,0,0,n,r,0,0,i,s),t._resolve(),t._resolve=null}}}},{key:"dispose",value:function(){(0,ht.Z)((0,ft.Z)(n.prototype),"dispose",this).call(this),this._resolve=null,this._crossorigin=null}}],[{key:"getSize",value:function(t){var e=n.SVG_SIZE.exec(t),r={};return e&&(r[e[1]]=Math.round(parseFloat(e[3])),r[e[5]]=Math.round(parseFloat(e[7]))),r}},{key:"test",value:function(t,e){return"svg"===e||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&n.SVG_XML.test(t)}}]),n}(kt);Ot.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Ot.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Dt=n(7326);function Bt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var Nt=function(t){(0,lt.Z)(n,t);var e=Bt(n);function n(t,r){var i;if((0,u.Z)(this,n),r=r||{},!(t instanceof HTMLVideoElement)){var s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]);var a=t[0].src||t[0];kt.crossOrigin(s,a,r.crossorigin);for(var o=0;o<t.length;++o){var h=document.createElement("source"),l=t[o],c=l.src,f=l.mime,d=(c=c||t[o]).split("?").shift().toLowerCase(),p=d.slice(d.lastIndexOf(".")+1);f=f||n.MIME_TYPES[p]||"video/".concat(p),h.src=c,h.type=f,s.appendChild(h)}t=s}return(i=e.call(this,t)).noSubImage=!0,i._autoUpdate=!0,i._isConnectedToTicker=!1,i._updateFPS=r.updateFPS||0,i._msToNextUpdate=0,i.autoPlay=!1!==r.autoPlay,i._load=null,i._resolve=null,i._onCanPlay=i._onCanPlay.bind((0,Dt.Z)(i)),i._onError=i._onError.bind((0,Dt.Z)(i)),!1!==r.autoLoad&&i.load(),i}return(0,h.Z)(n,[{key:"update",value:function(){if(!this.destroyed){var t=c.vB.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&((0,ht.Z)((0,ft.Z)(n.prototype),"update",this).call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}},{key:"load",value:function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(n){t.valid?n(t):(t._resolve=n,e.load())})),this._load}},{key:"_onError",value:function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)}},{key:"_isSourcePlaying",value:function(){var t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()}},{key:"_isSourceReady",value:function(){return this.source.readyState>2}},{key:"_onPlayStart",value:function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(c.vB.shared.add(this.update,this),this._isConnectedToTicker=!0)}},{key:"_onPlayStop",value:function(){this._isConnectedToTicker&&(c.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1)}},{key:"_onCanPlay",value:function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}},{key:"dispose",value:function(){this._isConnectedToTicker&&(c.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),(0,ht.Z)((0,ft.Z)(n.prototype),"dispose",this).call(this)}},{key:"autoUpdate",get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(c.vB.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(c.vB.shared.add(this.update,this),this._isConnectedToTicker=!0))}},{key:"updateFPS",get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)}}],[{key:"test",value:function(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||n.TYPES.includes(e)}}]),n}(kt);Nt.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Nt.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};var Lt=n(5861),Zt=n(4687),Ft=n.n(Zt);function Ut(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var Gt=function(t){(0,lt.Z)(n,t);var e=Ut(n);function n(t,r){var i,s,a=this;(0,u.Z)(this,n);var o=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];s=e.call.apply(e,[a].concat(n))};return r=r||{},"string"==typeof t?(o(n.EMPTY),s.url=t):(o(t),s.url=null),s.crossOrigin=null===(i=r.crossOrigin)||void 0===i||i,s.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,s._load=null,!1!==r.autoLoad&&s.load(),(0,ct.Z)(s)}return(0,h.Z)(n,[{key:"load",value:function(){var t=this;return this._load||(this._load=new Promise(function(){var e=(0,Lt.Z)(Ft().mark((function e(n,r){var a,o,u;return Ft().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t.url){e.next=3;break}return n(t),e.abrupt("return");case 3:return e.prev=3,e.next=6,i.Xd.ADAPTER.fetch(t.url,{mode:t.crossOrigin?"cors":"no-cors"});case 6:if(a=e.sent,!t.destroyed){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,a.blob();case 11:if(o=e.sent,!t.destroyed){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,createImageBitmap(o,{premultiplyAlpha:null===t.alphaMode||t.alphaMode===s.iw.UNPACK?"premultiply":"none"});case 16:if(u=e.sent,!t.destroyed){e.next=19;break}return e.abrupt("return");case 19:t.source=u,t.update(),n(t),e.next=30;break;case 24:if(e.prev=24,e.t0=e.catch(3),!t.destroyed){e.next=28;break}return e.abrupt("return");case 28:r(e.t0),t.onError.emit(e.t0);case 30:case"end":return e.stop()}}),e,null,[[3,24]])})));return function(t,n){return e.apply(this,arguments)}}())),this._load}},{key:"upload",value:function(t,e,r){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(e.alphaMode=this.alphaMode),(0,ht.Z)((0,ft.Z)(n.prototype),"upload",this).call(this,t,e,r)):(this.load(),!1)}},{key:"dispose",value:function(){this.source instanceof ImageBitmap&&this.source.close(),(0,ht.Z)((0,ft.Z)(n.prototype),"dispose",this).call(this),this._load=null}}],[{key:"test",value:function(t){return!!globalThis.createImageBitmap&&"undefined"!=typeof ImageBitmap&&("string"==typeof t||t instanceof ImageBitmap)}},{key:"EMPTY",get:function(){var t;return n._EMPTY=null!==(t=n._EMPTY)&&void 0!==t?t:i.Xd.ADAPTER.createCanvas(0,0),n._EMPTY}}]),n}(kt);function Ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}ot.push(Gt,Mt,Rt,Nt,Ot,vt,It,Et);var Xt=function(t){(0,lt.Z)(n,t);var e=Ht(n);function n(){return(0,u.Z)(this,n),e.apply(this,arguments)}return(0,h.Z)(n,[{key:"upload",value:function(t,e,n){var r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===s.iw.UNPACK);var i=e.realWidth,a=e.realHeight;return n.width===i&&n.height===a?r.texSubImage2D(e.target,0,0,0,i,a,e.format,n.type,this.data):(n.width=i,n.height=a,r.texImage2D(e.target,0,n.internalFormat,i,a,0,e.format,n.type,this.data)),!0}}]),n}(vt),Wt=function(){function t(e,n){(0,u.Z)(this,t),this.width=Math.round(e||100),this.height=Math.round(n||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new l("disposeFramebuffer"),this.multisample=s.G5.NONE}return(0,h.Z)(t,[{key:"colorTexture",get:function(){return this.colorTextures[0]}},{key:"addColorTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return this.colorTextures[t]=e||new xt(null,{scaleMode:s.aH.NEAREST,resolution:1,mipmap:s.WB.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}},{key:"addDepthTexture",value:function(t){return this.depthTexture=t||new xt(new Xt(null,{width:this.width,height:this.height}),{scaleMode:s.aH.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:s.WB.OFF,format:s.I2.DEPTH_COMPONENT,type:s.vK.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}},{key:"enableDepth",value:function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}},{key:"enableStencil",value:function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}},{key:"resize",value:function(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var r=this.colorTextures[n],i=r.resolution;r.setSize(t/i,e/i)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}}},{key:"dispose",value:function(){this.disposeRunner.emit(this,!1)}},{key:"destroyDepthTexture",value:function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}]),t}();function jt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var zt=function(t){(0,lt.Z)(n,t);var e=jt(n);function n(){var t,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,u.Z)(this,n),"number"==typeof i){var a=arguments[0],o=arguments[1],h=arguments[2],l=arguments[3];i={width:a,height:o,scaleMode:h,resolution:l}}return i.width=i.width||100,i.height=i.height||100,null!==(t=i.multisample)&&void 0!==t||(i.multisample=s.G5.NONE),(r=e.call(this,null,i)).mipmap=s.WB.OFF,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new Wt(r.realWidth,r.realHeight).addColorTexture(0,(0,Dt.Z)(r)),r.framebuffer.multisample=i.multisample,r.maskStack=[],r.filterStack=[{}],r}return(0,h.Z)(n,[{key:"resize",value:function(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}},{key:"dispose",value:function(){this.framebuffer.dispose(),(0,ht.Z)((0,ft.Z)(n.prototype),"dispose",this).call(this)}},{key:"destroy",value:function(){(0,ht.Z)((0,ft.Z)(n.prototype),"destroy",this).call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}]),n}(xt),Vt=function(){function t(){(0,u.Z)(this,t),this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return(0,h.Z)(t,[{key:"set",value:function(t,e,n){var r=e.width,i=e.height;if(n){var s=t.width/2/r,a=t.height/2/i,u=t.x/r+s,h=t.y/i+a;n=o.Lv.add(n,o.Lv.NW),this.x0=u+s*o.Lv.uX(n),this.y0=h+a*o.Lv.uY(n),n=o.Lv.add(n,2),this.x1=u+s*o.Lv.uX(n),this.y1=h+a*o.Lv.uY(n),n=o.Lv.add(n,2),this.x2=u+s*o.Lv.uX(n),this.y2=h+a*o.Lv.uY(n),n=o.Lv.add(n,2),this.x3=u+s*o.Lv.uX(n),this.y3=h+a*o.Lv.uY(n)}else this.x0=t.x/r,this.y0=t.y/i,this.x1=(t.x+t.width)/r,this.y1=t.y/i,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/i,this.x3=t.x/r,this.y3=(t.y+t.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}]),t}();function Yt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var Kt=new Vt;function qt(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}var $t=function(t){(0,lt.Z)(n,t);var e=Yt(n);function n(t,r,i,s,a,h){var l;if((0,u.Z)(this,n),(l=e.call(this)).noFrame=!1,r||(l.noFrame=!0,r=new o.Ae(0,0,1,1)),t instanceof n&&(t=t.baseTexture),l.baseTexture=t,l._frame=r,l.trim=s,l.valid=!1,l._uvs=Kt,l.uvMatrix=null,l.orig=i||r,l._rotate=Number(a||0),!0===a)l._rotate=2;else if(l._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return l.defaultAnchor=h?new o.E9(h.x,h.y):new o.E9(0,0),l._updateID=0,l.textureCacheIds=[],t.valid?l.noFrame?t.valid&&l.onBaseTextureUpdated(t):l.frame=r:t.once("loaded",l.onBaseTextureUpdated,(0,Dt.Z)(l)),l.noFrame&&t.on("update",l.onBaseTextureUpdated,(0,Dt.Z)(l)),l}return(0,h.Z)(n,[{key:"update",value:function(){this.baseTexture.resource&&this.baseTexture.resource.update()}},{key:"onBaseTextureUpdated",value:function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}},{key:"destroy",value:function(t){if(this.baseTexture){if(t){var e=this.baseTexture.resource;null!=e&&e.url&&q[e.url]&&n.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,n.removeFromCache(this),this.textureCacheIds=null}},{key:"clone",value:function(){var t,e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),i=new n(this.baseTexture,!this.noFrame&&e,r,null===(t=this.trim)||void 0===t?void 0:t.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=e),i}},{key:"updateUvs",value:function(){this._uvs===Kt&&(this._uvs=new Vt),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}},{key:"resolution",get:function(){return this.baseTexture.resolution}},{key:"frame",get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,n=t.y,r=t.width,i=t.height,s=e+r>this.baseTexture.width,a=n+i>this.baseTexture.height;if(s||a){var o=s&&a?"and":"or",u="X: ".concat(e," + ").concat(r," = ").concat(e+r," > ").concat(this.baseTexture.width),h="Y: ".concat(n," + ").concat(i," = ").concat(n+i," > ").concat(this.baseTexture.height);throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: ".concat(u," ").concat(o," ").concat(h))}this.valid=r&&i&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()}},{key:"rotate",get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()}},{key:"width",get:function(){return this.orig.width}},{key:"height",get:function(){return this.orig.height}},{key:"castToBaseTexture",value:function(){return this.baseTexture}}],[{key:"from",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.Xd.STRICT_TEXTURE_CACHE,s="string"==typeof t,a=null;if(s)a=t;else if(t instanceof xt){if(!t.cacheId){var o=(null==e?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId="".concat(o,"-").concat(z()),xt.addToCache(t,t.cacheId)}a=t.cacheId}else{if(!t._pixiId){var u=(null==e?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId="".concat(u,"_").concat(z())}a=t._pixiId}var h=q[a];if(s&&r&&!h)throw new Error('The cacheId "'.concat(a,'" does not exist in TextureCache.'));return h||t instanceof xt?!h&&t instanceof xt&&(h=new n(t),n.addToCache(h,a)):(e.resolution||(e.resolution=at(t)),(h=new n(new xt(t,e))).baseTexture.cacheId=a,xt.addToCache(h.baseTexture,a),n.addToCache(h,a)),h}},{key:"fromURL",value:function(t,e){var r=Object.assign({autoLoad:!1},null==e?void 0:e.resourceOptions),i=n.from(t,Object.assign({resourceOptions:r},e),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then((function(){return Promise.resolve(i)}))}},{key:"fromBuffer",value:function(t,e,r,i){return new n(xt.fromBuffer(t,e,r,i))}},{key:"fromLoader",value:function(t,e,r,s){var a=new xt(t,Object.assign({scaleMode:i.Xd.SCALE_MODE,resolution:at(e)},s)),o=a.resource;o instanceof Mt&&(o.url=e);var u=new n(a);return r||(r=e),xt.addToCache(u.baseTexture,r),n.addToCache(u,r),r!==e&&(xt.addToCache(u.baseTexture,e),n.addToCache(u,e)),u.baseTexture.valid?Promise.resolve(u):new Promise((function(t){u.baseTexture.once("loaded",(function(){return t(u)}))}))}},{key:"addToCache",value:function(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),q[e]&&console.warn("Texture added to the cache with an id [".concat(e,"] that already had an entry")),q[e]=t)}},{key:"removeFromCache",value:function(t){if("string"==typeof t){var e=q[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete q[t],e}}else if(null!=t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)q[t.textureCacheIds[r]]===t&&delete q[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null}},{key:"EMPTY",get:function(){return n._EMPTY||(n._EMPTY=new n(new xt),qt(n._EMPTY),qt(n._EMPTY.baseTexture)),n._EMPTY}},{key:"WHITE",get:function(){if(!n._WHITE){var t=i.Xd.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),n._WHITE=new n(xt.from(t)),qt(n._WHITE),qt(n._WHITE.baseTexture)}return n._WHITE}}]),n}(d());function Qt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var Jt=function(t){(0,lt.Z)(n,t);var e=Qt(n);function n(t,r){var i;return(0,u.Z)(this,n),(i=e.call(this,t,r)).valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return(0,h.Z)(n,[{key:"framebuffer",get:function(){return this.baseTexture.framebuffer}},{key:"multisample",get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t}},{key:"resize",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.baseTexture.resolution,i=Math.round(t*r)/r,s=Math.round(e*r)/r;this.valid=i>0&&s>0,this._frame.width=this.orig.width=i,this._frame.height=this.orig.height=s,n&&this.baseTexture.resize(i,s),this.updateUvs()}},{key:"setResolution",value:function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}}],[{key:"create",value:function(t){return new n(new zt(t))}}]),n}($t),te=function(){function t(e){(0,u.Z)(this,t),this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return(0,h.Z)(t,[{key:"createTexture",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.G5.NONE,r=new zt(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new Jt(r)}},{key:"getOptimalTexture",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.G5.NONE;t=Math.ceil(t*r-1e-6),e=Math.ceil(e*r-1e-6),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?n=i>1?-i:-1:(n=((65535&(t=U(t)))<<16|65535&(e=U(e)))>>>0,i>1&&(n+=4294967296*i)),this.texturePool[n]||(this.texturePool[n]=[]);var a=this.texturePool[n].pop();return a||(a=this.createTexture(t,e,i)),a.filterPoolKey=n,a.setResolution(r),a}},{key:"getFilterTexture",value:function(t,e,n){var r=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||s.G5.NONE);return r.filterFrame=t.filterFrame,r}},{key:"returnTexture",value:function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}},{key:"returnFilterTexture",value:function(t){this.returnTexture(t)}},{key:"clear",value:function(t){if(t=!1!==t)for(var e in this.texturePool){var n=this.texturePool[e];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0)}this.texturePool={}}},{key:"setScreenSize",value:function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){for(var e in this.enableFullScreen=t.width>0&&t.height>0,this.texturePool)if(Number(e)<0){var n=this.texturePool[e];if(n)for(var r=0;r<n.length;r++)n[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}]),t}();te.SCREEN_KEY=-1;var ee=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.vK.FLOAT,a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,h=arguments.length>6?arguments[6]:void 0;(0,u.Z)(this,t),this.buffer=e,this.size=n,this.normalized=r,this.type=i,this.stride=a,this.start=o,this.instance=h}return(0,h.Z)(t,[{key:"destroy",value:function(){this.buffer=null}}],[{key:"from",value:function(e,n,r,i,s){return new t(e,n,r,i,s)}}]),t}(),ne=0,re=function(){function t(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,u.Z)(this,t),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=n,this.id=ne++,this.disposeRunner=new l("disposeBuffer")}return(0,h.Z)(t,[{key:"update",value:function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}},{key:"dispose",value:function(){this.disposeRunner.emit(this,!1)}},{key:"destroy",value:function(){this.dispose(),this.data=null}},{key:"index",get:function(){return this.type===s.mr.ELEMENT_ARRAY_BUFFER},set:function(t){this.type=t?s.mr.ELEMENT_ARRAY_BUFFER:s.mr.ARRAY_BUFFER}}],[{key:"from",value:function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)}}]),t}(),ie={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var se={5126:4,5123:2,5121:1},ae=0,oe={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},ue=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,u.Z)(this,t),this.buffers=e,this.indexBuffer=null,this.attributes=n,this.glVertexArrayObjects={},this.id=ae++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new l("disposeGeometry"),this.refCount=0}return(0,h.Z)(t,[{key:"addAttribute",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof re||(e instanceof Array&&(e=new Float32Array(e)),e=new re(e));var u=t.split("|");if(u.length>1){for(var h=0;h<u.length;h++)this.addAttribute(u[h],e,n,r,i);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new ee(l,n,r,i,s,a,o),this.instanced=this.instanced||o,this}},{key:"getAttribute",value:function(t){return this.attributes[t]}},{key:"getBuffer",value:function(t){return this.buffers[this.getAttribute(t).buffer]}},{key:"addIndex",value:function(t){return t instanceof re||(t instanceof Array&&(t=new Uint16Array(t)),t=new re(t)),t.type=s.mr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}},{key:"getIndex",value:function(){return this.indexBuffer}},{key:"interleave",value:function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],n=[],r=new re;for(t in this.attributes){var i=this.attributes[t],s=this.buffers[i.buffer];e.push(s.data),n.push(i.size*se[i.type]/4),i.buffer=0}for(r.data=function(t,e){for(var n=0,r=0,i={},s=0;s<t.length;s++)r+=e[s],n+=t[s].length;for(var a=new ArrayBuffer(4*n),o=null,u=0,h=0;h<t.length;h++){var l=e[h],c=t[h],f=L(c);i[f]||(i[f]=new ie[f](a)),o=i[f];for(var d=0;d<c.length;d++)o[(d/l|0)*r+u+d%l]=c[d];u+=l}return new Float32Array(a)}(e,n),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}},{key:"getSize",value:function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}},{key:"dispose",value:function(){this.disposeRunner.emit(this,!1)}},{key:"destroy",value:function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}},{key:"clone",value:function(){for(var e=new t,n=0;n<this.buffers.length;n++)e.buffers[n]=new re(this.buffers[n].data.slice(0));for(var r in this.attributes){var i=this.attributes[r];e.attributes[r]=new ee(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=s.mr.ELEMENT_ARRAY_BUFFER),e}}],[{key:"merge",value:function(e){for(var n,r=new t,i=[],a=[],o=[],u=0;u<e.length;u++){n=e[u];for(var h=0;h<n.buffers.length;h++)a[h]=a[h]||0,a[h]+=n.buffers[h].data.length,o[h]=0}for(var l=0;l<n.buffers.length;l++)i[l]=new(oe[L(n.buffers[l].data)])(a[l]),r.buffers[l]=new re(i[l]);for(var c=0;c<e.length;c++){n=e[c];for(var f=0;f<n.buffers.length;f++)i[f].set(n.buffers[f].data,o[f]),o[f]+=n.buffers[f].data.length}if(r.attributes=n.attributes,n.indexBuffer){r.indexBuffer=r.buffers[n.buffers.indexOf(n.indexBuffer)],r.indexBuffer.type=s.mr.ELEMENT_ARRAY_BUFFER;for(var d=0,p=0,v=0,y=0,m=0;m<n.buffers.length;m++)if(n.buffers[m]!==n.indexBuffer){y=m;break}for(var g in n.attributes){var x=n.attributes[g];(0|x.buffer)===y&&(p+=x.size*se[x.type]/4)}for(var _=0;_<e.length;_++){for(var b=e[_].indexBuffer.data,w=0;w<b.length;w++)r.indexBuffer.data[w+v]+=d;d+=e[_].buffers[y].data.length/p,v+=b.length}}return r}}]),t}();function he(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var le=function(t){(0,lt.Z)(n,t);var e=he(n);function n(){var t;return(0,u.Z)(this,n),(t=e.call(this)).addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return(0,h.Z)(n)}(ue);function ce(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var fe=function(t){(0,lt.Z)(n,t);var e=ce(n);function n(){var t;return(0,u.Z)(this,n),(t=e.call(this)).vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new re(t.vertices),t.uvBuffer=new re(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return(0,h.Z)(n,[{key:"map",value:function(t,e){var n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+e.width/t.width,this.uvs[3]=r,this.uvs[4]=n+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=n,this.uvs[7]=r+e.height/t.height,n=e.x,r=e.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+e.width,this.vertices[3]=r,this.vertices[4]=n+e.width,this.vertices[5]=r+e.height,this.vertices[6]=n,this.vertices[7]=r+e.height,this.invalidate(),this}},{key:"invalidate",value:function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}]),n}(ue),de=0,pe=function(){function t(e,n,r){(0,u.Z)(this,t),this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=de++,this.static=!!n,this.ubo=!!r,e instanceof re?(this.buffer=e,this.buffer.type=s.mr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new re(new Float32Array(1)),this.buffer.type=s.mr.UNIFORM_BUFFER,this.autoManage=!0))}return(0,h.Z)(t,[{key:"update",value:function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}},{key:"add",value:function(e,n,r){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new t(n,r)}}],[{key:"from",value:function(e,n,r){return new t(e,n,r)}},{key:"uboFrom",value:function(e,n){return new t(e,null==n||n,!0)}}]),t}(),ve=function(){function t(){(0,u.Z)(this,t),this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=s.G5.NONE,this.sourceFrame=new o.Ae,this.destinationFrame=new o.Ae,this.bindingSourceFrame=new o.Ae,this.bindingDestinationFrame=new o.Ae,this.filters=[],this.transform=null}return(0,h.Z)(t,[{key:"clear",value:function(){this.target=null,this.filters=null,this.renderTexture=null}}]),t}(),ye=[new o.E9,new o.E9,new o.E9,new o.E9],me=new o.y3,ge=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new te,this.statePool=[],this.quad=new le,this.quadUv=new fe,this.tempRect=new o.Ae,this.activeState={},this.globalUniforms=new pe({outputFrame:new o.Ae,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return(0,h.Z)(t,[{key:"init",value:function(){this.texturePool.setScreenSize(this.renderer.view)}},{key:"push",value:function(t,e){for(var n,r=this.renderer,i=this.defaultFilterStack,s=this.statePool.pop()||new ve,a=this.renderer.renderTexture,o=e[0].resolution,u=e[0].multisample,h=e[0].padding,l=e[0].autoFit,c=null===(n=e[0].legacy)||void 0===n||n,f=1;f<e.length;f++){var d,p=e[f];o=Math.min(o,p.resolution),u=Math.min(u,p.multisample),h=this.useMaxPadding?Math.max(h,p.padding):h+p.padding,l=l&&p.autoFit,c=c||null===(d=p.legacy)||void 0===d||d}1===i.length&&(this.defaultFilterStack[0].renderTexture=a.current),i.push(s),s.resolution=o,s.multisample=u,s.legacy=c,s.target=t,s.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),s.sourceFrame.pad(h);var v=this.tempRect.copyFrom(a.sourceFrame);r.projection.transform&&this.transformAABB(me.copyFrom(r.projection.transform).invert(),v),l?(s.sourceFrame.fit(v),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(v)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,a.current?a.current.resolution:r.resolution,a.sourceFrame,a.destinationFrame,r.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,o,u),s.filters=e,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;var y=this.tempRect;y.x=0,y.y=0,y.width=s.sourceFrame.width,y.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(a.sourceFrame),s.bindingDestinationFrame.copyFrom(a.destinationFrame),s.transform=r.projection.transform,r.projection.transform=null,a.bind(s.renderTexture,s.sourceFrame,y),r.framebuffer.clear(0,0,0,0)}},{key:"pop",value:function(){var t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var i=r.inputSize,a=r.inputPixel,o=r.inputClamp;if(i[0]=e.destinationFrame.width,i[1]=e.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],a[0]=Math.round(i[0]*e.resolution),a[1]=Math.round(i[1]*e.resolution),a[2]=1/a[0],a[3]=1/a[1],o[0]=.5*a[2],o[1]=.5*a[3],o[2]=e.sourceFrame.width*i[2]-.5*a[2],o[3]=e.sourceFrame.height*i[3]-.5*a[3],e.legacy){var u=r.filterArea;u[0]=e.destinationFrame.width,u[1]=e.destinationFrame.height,u[2]=e.sourceFrame.x,u[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,h.renderTexture,s.yl.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var l=e.renderTexture,c=this.getOptimalFilterTexture(l.width,l.height,e.resolution);c.filterFrame=l.filterFrame;var f=0;for(f=0;f<n.length-1;++f){1===f&&e.multisample>1&&((c=this.getOptimalFilterTexture(l.width,l.height,e.resolution)).filterFrame=l.filterFrame),n[f].apply(this,l,c,s.yl.CLEAR,e);var d=l;l=c,c=d}n[f].apply(this,l,h.renderTexture,s.yl.BLEND,e),f>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)}},{key:"bindAndClear",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.yl.CLEAR,n=this.renderer,r=n.renderTexture,i=n.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,null!=t&&t.filterFrame){var a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,r.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var o=1&i.stateId||this.forceClear;(e===s.yl.CLEAR||e===s.yl.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}},{key:"applyFilter",value:function(t,e,n,r){var i=this.renderer;i.state.set(t.state),this.bindAndClear(n,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(s.lg.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(s.lg.TRIANGLE_STRIP))}},{key:"calculateSpriteMatrix",value:function(t,e){var n=this.activeState,r=n.sourceFrame,i=n.destinationFrame,s=e._texture.orig,a=t.set(i.width,0,0,i.height,r.x,r.y),u=e.worldTransform.copyTo(o.y3.TEMP_MATRIX);return u.invert(),a.prepend(u),a.scale(1/s.width,1/s.height),a.translate(e.anchor.x,e.anchor.y),a}},{key:"destroy",value:function(){this.renderer=null,this.texturePool.clear(!1)}},{key:"getOptimalFilterTexture",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.G5.NONE;return this.texturePool.getOptimalTexture(t,e,n,r)}},{key:"getFilterTexture",value:function(t,e,n){if("number"==typeof t){var r=t;t=e,e=r}t=t||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||s.G5.NONE);return i.filterFrame=t.filterFrame,i}},{key:"returnFilterTexture",value:function(t){this.texturePool.returnTexture(t)}},{key:"emptyPool",value:function(){this.texturePool.clear(!0)}},{key:"resize",value:function(){this.texturePool.setScreenSize(this.renderer.view)}},{key:"transformAABB",value:function(t,e){var n=ye[0],r=ye[1],i=ye[2],s=ye[3];n.set(e.left,e.top),r.set(e.left,e.bottom),i.set(e.right,e.top),s.set(e.right,e.bottom),t.apply(n,n),t.apply(r,r),t.apply(i,i),t.apply(s,s);var a=Math.min(n.x,r.x,i.x,s.x),o=Math.min(n.y,r.y,i.y,s.y),u=Math.max(n.x,r.x,i.x,s.x),h=Math.max(n.y,r.y,i.y,s.y);e.x=a,e.y=o,e.width=u-a,e.height=h-o}},{key:"roundFrame",value:function(t,e,n,r,i){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(i){var s=i,a=s.a,o=s.b,u=s.c,h=s.d;if((Math.abs(o)>1e-4||Math.abs(u)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(h)>1e-4))return}(i=i?me.copyFrom(i):me.identity()).translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.transformAABB(i,t),t.ceil(e),this.transformAABB(i.invert(),t)}}}]),t}();ge.extension={type:a.n.RendererSystem,name:"filter"},a.R.add(ge);var xe=function(){function t(e){(0,u.Z)(this,t),this.renderer=e}return(0,h.Z)(t,[{key:"flush",value:function(){}},{key:"destroy",value:function(){this.renderer=null}},{key:"start",value:function(){}},{key:"stop",value:function(){this.flush()}},{key:"render",value:function(t){}}]),t}(),_e=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.emptyRenderer=new xe(e),this.currentRenderer=this.emptyRenderer}return(0,h.Z)(t,[{key:"setObjectRenderer",value:function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}},{key:"flush",value:function(){this.setObjectRenderer(this.emptyRenderer)}},{key:"reset",value:function(){this.setObjectRenderer(this.emptyRenderer)}},{key:"copyBoundTextures",value:function(t,e){for(var n=this.renderer.texture.boundTextures,r=e-1;r>=0;--r)t[r]=n[r]||null,t[r]&&(t[r]._batchLocation=r)}},{key:"boundArray",value:function(t,e,n,r){for(var i=t.elements,s=t.ids,a=t.count,o=0,u=0;u<a;u++){var h=i[u],l=h._batchLocation;if(l>=0&&l<r&&e[l]===h)s[u]=l;else for(;o<r;){var c=e[o];if(!c||c._batchEnabled!==n||c._batchLocation!==o){s[u]=o,h._batchLocation=o,e[o]=h;break}o++}}}},{key:"destroy",value:function(){this.renderer=null}}]),t}();_e.extension={type:a.n.RendererSystem,name:"batch"},a.R.add(_e);var be=0,we=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}return(0,h.Z)(t,[{key:"isLost",get:function(){return!this.gl||this.gl.isContextLost()}},{key:"contextChange",value:function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=be++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()}},{key:"init",value:function(t){if(t.context)this.initFromContext(t.context);else{var e,n=this.renderer.background.alpha<1,r=null===(e=t.premultipliedAlpha)||void 0===e||e;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:n,premultipliedAlpha:r,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}},{key:"initFromContext",value:function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=be++,this.renderer.runners.contextChange.emit(t);var e=this.renderer.view;void 0!==e.addEventListener&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}},{key:"initFromOptions",value:function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)}},{key:"createContext",value:function(t,e){var n;if(i.Xd.PREFER_ENV>=s.Vi.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}},{key:"getExtensions",value:function(){var t=this.gl,e={anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}},{key:"handleContextLost",value:function(t){t.preventDefault()}},{key:"handleContextRestored",value:function(){this.renderer.runners.contextChange.emit(this.gl)}},{key:"destroy",value:function(){var t=this.renderer.view;this.renderer=null,void 0!==t.removeEventListener&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}},{key:"postrender",value:function(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}},{key:"validateContext",value:function(t){var e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var r=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}]),t}();we.extension={type:a.n.RendererSystem,name:"context"},a.R.add(we);var Ee=(0,h.Z)((function t(e){(0,u.Z)(this,t),this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=s.G5.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0})),Te=new o.Ae,ke=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Wt(10,10),this.msaaSamples=null}return(0,h.Z)(t,[{key:"contextChange",value:function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new o.Ae,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;i.Xd.PREFER_ENV===s.Vi.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}},{key:"bind",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.gl;if(t){var i=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,i.mipLevel=n),i.dirtyId!==t.dirtyId&&(i.dirtyId=t.dirtyId,i.dirtyFormat!==t.dirtyFormat?(i.dirtyFormat=t.dirtyFormat,i.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):i.dirtySize!==t.dirtySize&&(i.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var s=0;s<t.colorTextures.length;s++){var a=t.colorTextures[s];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var o=e.width>>n,u=e.height>>n,h=o/e.width;this.setViewport(e.x*h,e.y*h,o,u)}else{var l=t.width>>n,c=t.height>>n;this.setViewport(0,0,l,c)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}},{key:"setViewport",value:function(t,e,n,r){var i=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),r=Math.round(r),i.width===n&&i.height===r&&i.x===t&&i.y===e||(i.x=t,i.y=e,i.width=n,i.height=r,this.gl.viewport(t,e,n,r))}},{key:"size",get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}},{key:"clear",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.V0.COLOR|s.V0.DEPTH,a=this.gl;a.clearColor(t,e,n,r),a.clear(i)}},{key:"initFramebuffer",value:function(t){var e=this.gl,n=new Ee(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n}},{key:"resizeFramebuffer",value:function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var r=t.colorTextures,i=r.length;e.drawBuffers||(i=Math.min(i,1));for(var s=0;s<i;s++){var a=r[s],o=a.parentTextureArray||a;this.renderer.texture.bind(o,0),0===s&&n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,o._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}},{key:"updateFramebuffer",value:function(t,e){var n=this.gl,r=t.glFramebuffers[this.CONTEXT_UID],i=t.colorTextures,s=i.length;n.drawBuffers||(s=Math.min(s,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||n.createRenderbuffer():r.msaaBuffer&&(n.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));for(var a=[],o=0;o<s;o++){var u=i[o],h=u.parentTextureArray||u;this.renderer.texture.bind(h,0),0===o&&r.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,r.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+o,u.target,h._glTextures[this.CONTEXT_UID].texture,e),a.push(n.COLOR_ATTACHMENT0+o))}if((a.length>1&&n.drawBuffers(a),t.depthTexture)&&this.writeDepthTexture){var l=t.depthTexture;this.renderer.texture.bind(l,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?r.stencil&&(n.deleteRenderbuffer(r.stencil),r.stencil=null):(r.stencil=r.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,r.stencil))}},{key:"canMultisampleFramebuffer",value:function(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture}},{key:"detectSamples",value:function(t){var e=this.msaaSamples,n=s.G5.NONE;if(t<=1||null===e)return n;for(var r=0;r<e.length;r++)if(e[r]<=t){n=e[r];break}return 1===n&&(n=s.G5.NONE),n}},{key:"blit",value:function(t,e,n){var r=this.current,i=this.renderer,s=this.gl,a=this.CONTEXT_UID;if(2===i.context.webGLVersion&&r){var o=r.glFramebuffers[a];if(o){if(!t){if(!o.msaaBuffer)return;var u=r.colorTextures[0];if(!u)return;o.blitFramebuffer||(o.blitFramebuffer=new Wt(r.width,r.height),o.blitFramebuffer.addColorTexture(0,u)),(t=o.blitFramebuffer).colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),t.width===r.width&&t.height===r.height||(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||((e=Te).width=r.width,e.height=r.height),n||(n=e);var h=e.width===n.width&&e.height===n.height;this.bind(t),s.bindFramebuffer(s.READ_FRAMEBUFFER,o.framebuffer),s.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,s.COLOR_BUFFER_BIT,h?s.NEAREST:s.LINEAR)}}}},{key:"disposeFramebuffer",value:function(t,e){var n=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(n){delete t.glFramebuffers[this.CONTEXT_UID];var i=this.managedFramebuffers.indexOf(t);i>=0&&this.managedFramebuffers.splice(i,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&r.deleteRenderbuffer(n.msaaBuffer),n.stencil&&r.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&n.blitFramebuffer.dispose()}}},{key:"disposeAll",value:function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)}},{key:"forceStencil",value:function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.stencil=!0;var n=t.width,r=t.height,i=this.gl,s=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,s),e.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,e.multisample,i.DEPTH24_STENCIL8,n,r):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,n,r),e.stencil=s,i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,s)}}}},{key:"reset",value:function(){this.current=this.unknownFramebuffer,this.viewport=new o.Ae}},{key:"destroy",value:function(){this.renderer=null}}]),t}();ke.extension={type:a.n.RendererSystem,name:"framebuffer"},a.R.add(ke);var Ae={5126:4,5123:2,5121:1},Re=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return(0,h.Z)(t,[{key:"contextChange",value:function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){var n=this.renderer.context.extensions.vertexArrayObject;i.Xd.PREFER_ENV===s.Vi.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=function(){return n.createVertexArrayOES()},t.bindVertexArray=function(t){return n.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return n.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(2!==e.webGLVersion){var r=t.getExtension("ANGLE_instanced_arrays");r?(t.vertexAttribDivisor=function(t,e){return r.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,n,i,s){return r.drawElementsInstancedANGLE(t,e,n,i,s)},t.drawArraysInstanced=function(t,e,n,i){return r.drawArraysInstancedANGLE(t,e,n,i)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex}},{key:"bind",value:function(t,e){e=e||this.renderer.shader.shader;var n=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID],i=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},i=!0);var s=r[e.program.id]||this.initGeometryVao(t,e,i);this._activeGeometry=t,this._activeVao!==s&&(this._activeVao=s,this.hasVao?n.bindVertexArray(s):this.activateVao(t,e.program)),this.updateBuffers()}},{key:"reset",value:function(){this.unbind()}},{key:"updateBuffers",value:function(){for(var t=this._activeGeometry,e=this.renderer.buffer,n=0;n<t.buffers.length;n++){var r=t.buffers[n];e.update(r)}}},{key:"checkCompatibility",value:function(t,e){var n=t.attributes,r=e.attributeData;for(var i in r)if(!n[i])throw new Error('shader and geometry incompatible, geometry missing the "'.concat(i,'" attribute'))}},{key:"getSignature",value:function(t,e){var n=t.attributes,r=e.attributeData,i=["g",t.id];for(var s in n)r[s]&&i.push(s,r[s].location);return i.join("-")}},{key:"initGeometryVao",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.gl,i=this.CONTEXT_UID,a=this.renderer.buffer,o=e.program;o.glPrograms[i]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);var u=this.getSignature(t,o),h=t.glVertexArrayObjects[this.CONTEXT_UID],l=h[u];if(l)return h[o.id]=l,l;var c=t.buffers,f=t.attributes,d={},p={};for(var v in c)d[v]=0,p[v]=0;for(var y in f)!f[y].size&&o.attributeData[y]?f[y].size=o.attributeData[y].size:f[y].size||console.warn("PIXI Geometry attribute '".concat(y,"' size cannot be determined (likely the bound shader does not have the attribute)")),d[f[y].buffer]+=f[y].size*Ae[f[y].type];for(var m in f){var g=f[m],x=g.size;void 0===g.stride&&(d[g.buffer]===x*Ae[g.type]?g.stride=0:g.stride=d[g.buffer]),void 0===g.start&&(g.start=p[g.buffer],p[g.buffer]+=x*Ae[g.type])}l=r.createVertexArray(),r.bindVertexArray(l);for(var _=0;_<c.length;_++){var b=c[_];a.bind(b),n&&b._glBuffers[i].refCount++}return this.activateVao(t,o),h[o.id]=l,h[u]=l,r.bindVertexArray(null),a.unbind(s.mr.ARRAY_BUFFER),l}},{key:"disposeGeometry",value:function(t,e){var n;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var r=t.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,s=t.buffers,a=null===(n=this.renderer)||void 0===n?void 0:n.buffer;if(t.disposeRunner.remove(this),r){if(a)for(var o=0;o<s.length;o++){var u=s[o]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,0!==u.refCount||e||a.dispose(s[o],e))}if(!e)for(var h in r)if("g"===h[0]){var l=r[h];this._activeVao===l&&this.unbind(),i.deleteVertexArray(l)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}}},{key:"disposeAll",value:function(t){for(var e=Object.keys(this.managedGeometries),n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)}},{key:"activateVao",value:function(t,e){var n=this.gl,r=this.CONTEXT_UID,i=this.renderer.buffer,s=t.buffers,a=t.attributes;t.indexBuffer&&i.bind(t.indexBuffer);var o=null;for(var u in a){var h=a[u],l=s[h.buffer],c=l._glBuffers[r];if(e.attributeData[u]){o!==c&&(i.bind(l),o=c);var f=e.attributeData[u].location;if(n.enableVertexAttribArray(f),n.vertexAttribPointer(f,h.size,h.type||n.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(f,1)}}}}},{key:"draw",value:function(t,e,n,r){var i=this.gl,s=this._activeGeometry;if(s.indexBuffer){var a=s.indexBuffer.data.BYTES_PER_ELEMENT,o=2===a?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?s.instanced?i.drawElementsInstanced(t,e||s.indexBuffer.data.length,o,(n||0)*a,r||1):i.drawElements(t,e||s.indexBuffer.data.length,o,(n||0)*a):console.warn("unsupported index buffer type: uint32")}else s.instanced?i.drawArraysInstanced(t,n,e||s.getSize(),r||1):i.drawArrays(t,n,e||s.getSize());return this}},{key:"unbind",value:function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}},{key:"destroy",value:function(){this.renderer=null}}]),t}();Re.extension={type:a.n.RendererSystem,name:"geometry"},a.R.add(Re);var Se,Ie=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,u.Z)(this,t),this.type=s.A7.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=i.Xd.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return(0,h.Z)(t,[{key:"filter",get:function(){return this._filters?this._filters[0]:null},set:function(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}},{key:"reset",value:function(){this.pooled&&(this.maskObject=null,this.type=s.A7.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}},{key:"copyCountersOrReset",value:function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}]),t}(),Pe={},Me=Pe;function Ce(){if(!Se){Se=s.cB.MEDIUM;var t=function(){var t;if(Me===Pe||null!==(t=Me)&&void 0!==t&&t.isContextLost()){var e,n=i.Xd.ADAPTER.createCanvas();i.Xd.PREFER_ENV>=s.Vi.WEBGL2&&(e=n.getContext("webgl2",{})),e||((e=n.getContext("webgl",{})||n.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),Me=e}return Me}();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Se=e.precision?s.cB.HIGH:s.cB.MEDIUM}}return Se}function Oe(t,e,n){if("precision"!==t.substring(0,9)){var r=e;return e===s.cB.HIGH&&n!==s.cB.HIGH&&(r=s.cB.MEDIUM),"precision ".concat(r," float;\n").concat(t)}return n!==s.cB.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var De={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Be(t){return De[t]}var Ne=null,Le={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Ze(t,e){if(!Ne){var n=Object.keys(Le);Ne={};for(var r=0;r<n.length;++r){var i=n[r];Ne[t[i]]=Le[i]}}return Ne[e]}var Fe=[{test:function(t){return"float"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n            if(uv["'.concat(t,'"] !== ud["').concat(t,'"].value)\n            {\n                ud["').concat(t,'"].value = uv["').concat(t,'"]\n                gl.uniform1f(ud["').concat(t,'"].location, uv["').concat(t,'"])\n            }\n            ')}},{test:function(t,e){return!("sampler2D"!==t.type&&"samplerCube"!==t.type&&"sampler2DArray"!==t.type||1!==t.size||t.isArray||null!=e&&void 0===e.castToBaseTexture)},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'.concat(t,'"], t);\n\n            if(ud["').concat(t,'"].value !== t)\n            {\n                ud["').concat(t,'"].value = t;\n                gl.uniform1i(ud["').concat(t,'"].location, t);\n; // eslint-disable-line max-len\n            }')}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'.concat(t,'"].location, false, uv["').concat(t,'"].toArray(true));\n            ')},codeUbo:function(t){return"\n                var ".concat(t,"_matrix = uv.").concat(t,".toArray(true);\n\n                data[offset] = ").concat(t,"_matrix[0];\n                data[offset+1] = ").concat(t,"_matrix[1];\n                data[offset+2] = ").concat(t,"_matrix[2];\n        \n                data[offset + 4] = ").concat(t,"_matrix[3];\n                data[offset + 5] = ").concat(t,"_matrix[4];\n                data[offset + 6] = ").concat(t,"_matrix[5];\n        \n                data[offset + 8] = ").concat(t,"_matrix[6];\n                data[offset + 9] = ").concat(t,"_matrix[7];\n                data[offset + 10] = ").concat(t,"_matrix[8];\n            ")}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==e.x},code:function(t){return'\n                cv = ud["'.concat(t,'"].value;\n                v = uv["').concat(t,'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["').concat(t,'"].location, v.x, v.y);\n                }')},codeUbo:function(t){return"\n                v = uv.".concat(t,";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            ")}},{test:function(t){return"vec2"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n                cv = ud["'.concat(t,'"].value;\n                v = uv["').concat(t,'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["').concat(t,'"].location, v[0], v[1]);\n                }\n            ')}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.width},code:function(t){return'\n                cv = ud["'.concat(t,'"].value;\n                v = uv["').concat(t,'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["').concat(t,'"].location, v.x, v.y, v.width, v.height)\n                }')},codeUbo:function(t){return"\n                    v = uv.".concat(t,";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                ")}},{test:function(t){return"vec4"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n                cv = ud["'.concat(t,'"].value;\n                v = uv["').concat(t,'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["').concat(t,'"].location, v[0], v[1], v[2], v[3])\n                }')}}],Ue={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},Ge={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var He=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Xe(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == ".concat(n,".0){}"));return e}var We=0,je={},ze=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pixi-shader",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,u.Z)(this,t),this.extra={},this.id=We++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=n||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=a,"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),je[r]?(je[r]++,r+="-".concat(je[r])):je[r]=1,this.vertexSrc="#define SHADER_NAME ".concat(r,"\n").concat(this.vertexSrc),this.fragmentSrc="#define SHADER_NAME ".concat(r,"\n").concat(this.fragmentSrc),this.vertexSrc=Oe(this.vertexSrc,i.Xd.PRECISION_VERTEX,s.cB.HIGH),this.fragmentSrc=Oe(this.fragmentSrc,i.Xd.PRECISION_FRAGMENT,Ce())),this.glPrograms={},this.syncUniforms=null}return(0,h.Z)(t,null,[{key:"defaultVertexSrc",get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"}},{key:"defaultFragmentSrc",get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"}},{key:"from",value:function(e,n,r){var i=e+n,s=K[i];return s||(K[i]=s=new t(e,n,r)),s}}]),t}(),Ve=function(){function t(e,n){(0,u.Z)(this,t),this.uniformBindCount=0,this.program=e,this.uniformGroup=n?n instanceof pe?n:new pe(n):new pe({}),this.disposeRunner=new l("disposeShader")}return(0,h.Z)(t,[{key:"checkUniformExists",value:function(t,e){if(e.uniforms[t])return!0;for(var n in e.uniforms){var r=e.uniforms[n];if(r.group&&this.checkUniformExists(t,r))return!0}return!1}},{key:"destroy",value:function(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}},{key:"uniforms",get:function(){return this.uniformGroup.uniforms}}],[{key:"from",value:function(e,n,r){return new t(ze.from(e,n),r)}}]),t}(),Ye=function(){function t(){(0,u.Z)(this,t),this.data=0,this.blendMode=s.T$.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return(0,h.Z)(t,[{key:"blend",get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)}},{key:"offsets",get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)}},{key:"culling",get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)}},{key:"depthTest",get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)}},{key:"depthMask",get:function(){return!!(32&this.data)},set:function(t){!!(32&this.data)!==t&&(this.data^=32)}},{key:"clockwiseFrontFace",get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)}},{key:"blendMode",get:function(){return this._blendMode},set:function(t){this.blend=t!==s.T$.NONE,this._blendMode=t}},{key:"polygonOffset",get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t}}],[{key:"for2d",value:function(){var e=new t;return e.depthTest=!1,e.blend=!0,e}}]),t}();function Ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var qe=function(t){(0,lt.Z)(n,t);var e=Ke(n);function n(t,r,s){var a;(0,u.Z)(this,n);var o=ze.from(t||n.defaultVertexSrc,r||n.defaultFragmentSrc);return(a=e.call(this,o,s)).padding=0,a.resolution=i.Xd.FILTER_RESOLUTION,a.multisample=i.Xd.FILTER_MULTISAMPLE,a.enabled=!0,a.autoFit=!0,a.state=new Ye,a}return(0,h.Z)(n,[{key:"apply",value:function(t,e,n,r,i){t.applyFilter(this,e,n,r)}},{key:"blendMode",get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t}},{key:"resolution",get:function(){return this._resolution},set:function(t){this._resolution=t}}],[{key:"defaultVertexSrc",get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"}},{key:"defaultFragmentSrc",get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"}}]),n}(Ve),$e=new o.y3,Qe=function(){function t(e,n){(0,u.Z)(this,t),this._texture=e,this.mapCoord=new o.y3,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===n?.5:n,this.isSimple=!1}return(0,h.Z)(t,[{key:"texture",get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1}},{key:"multiplyUvs",value:function(t,e){void 0===e&&(e=t);for(var n=this.mapCoord,r=0;r<t.length;r+=2){var i=t[r],s=t[r+1];e[r]=i*n.a+s*n.c+n.tx,e[r+1]=i*n.b+s*n.d+n.ty}return e}},{key:"update",value:function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var r=e.orig,i=e.trim;i&&($e.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append($e));var s=e.baseTexture,a=this.uClampFrame,o=this.clampMargin/s.resolution,u=this.clampOffset;return a[0]=(e._frame.x+o+u)/s.width,a[1]=(e._frame.y+o+u)/s.height,a[2]=(e._frame.x+e._frame.width-o+u)/s.width,a[3]=(e._frame.y+e._frame.height-o+u)/s.height,this.uClampOffset[0]=u/s.realWidth,this.uClampOffset[1]=u/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0}}]),t}();function Je(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var tn=function(t){(0,lt.Z)(n,t);var e=Je(n);function n(t,r,i){var s;(0,u.Z)(this,n);var a=null;return"string"!=typeof t&&void 0===r&&void 0===i&&(a=t,t=void 0,r=void 0,i=void 0),(s=e.call(this,t||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",r||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",i)).maskSprite=a,s.maskMatrix=new o.y3,s}return(0,h.Z)(n,[{key:"maskSprite",get:function(){return this._maskSprite},set:function(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}},{key:"apply",value:function(t,e,n,r){var i=this._maskSprite,s=i._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new Qe(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,i).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,t.applyFilter(this,e,n,r))}}]),n}(qe),en=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return(0,h.Z)(t,[{key:"setMaskStack",value:function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}},{key:"push",value:function(t,e){var n=e;if(!n.isMaskData){var r=this.maskDataPool.pop()||new Ie;r.pooled=!0,r.maskObject=e,n=r}var i=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(i),n._colorMask=i?i._colorMask:15,n.autoDetect&&this.detect(n),n._target=t,n.type!==s.A7.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case s.A7.SCISSOR:this.renderer.scissor.push(n);break;case s.A7.STENCIL:this.renderer.stencil.push(n);break;case s.A7.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case s.A7.COLOR:this.pushColorMask(n)}n.type===s.A7.SPRITE&&this.maskStack.push(n)}},{key:"pop",value:function(t){var e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case s.A7.SCISSOR:this.renderer.scissor.pop(e);break;case s.A7.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case s.A7.SPRITE:this.popSpriteMask(e);break;case s.A7.COLOR:this.popColorMask(e)}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){var n=this.maskStack[this.maskStack.length-1];n.type===s.A7.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}},{key:"detect",value:function(t){var e=t.maskObject;e?e.isSprite?t.type=s.A7.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=s.A7.SCISSOR:t.type=s.A7.STENCIL:t.type=s.A7.COLOR}},{key:"pushSpriteMask",value:function(t){var e=t.maskObject,n=t._target,r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex])||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new tn]);var i,s,a=this.renderer,o=a.renderTexture;if(o.current){var u,h=o.current;i=t.resolution||h.resolution,s=null!==(u=t.multisample)&&void 0!==u?u:h.multisample}else{var l;i=t.resolution||a.resolution,s=null!==(l=t.multisample)&&void 0!==l?l:a.multisample}r[0].resolution=i,r[0].multisample=s,r[0].maskSprite=e;var c=n.filterArea;n.filterArea=e.getBounds(!0),a.filter.push(n,r),n.filterArea=c,t._filters||this.alphaMaskIndex++}},{key:"popSpriteMask",value:function(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}},{key:"pushColorMask",value:function(t){var e=t._colorMask,n=t._colorMask=e&t.colorMask;n!==e&&this.renderer.gl.colorMask(0!=(1&n),0!=(2&n),0!=(4&n),0!=(8&n))}},{key:"popColorMask",value:function(t){var e=t._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==e&&this.renderer.gl.colorMask(0!=(1&n),0!=(2&n),0!=(4&n),0!=(8&n))}},{key:"destroy",value:function(){this.renderer=null}}]),t}();en.extension={type:a.n.RendererSystem,name:"mask"},a.R.add(en);var nn=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.maskStack=[],this.glConst=0}return(0,h.Z)(t,[{key:"getStackLength",value:function(){return this.maskStack.length}},{key:"setMaskStack",value:function(t){var e=this.renderer.gl,n=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==n&&(0===r?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}},{key:"_useCurrent",value:function(){}},{key:"destroy",value:function(){this.renderer=null,this.maskStack=null}}]),t}();function rn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var sn=new o.y3,an=[],on=function(t){(0,lt.Z)(n,t);var e=rn(n);function n(t){var r;return(0,u.Z)(this,n),(r=e.call(this,t)).glConst=i.Xd.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,r}return(0,h.Z)(n,[{key:"getStackLength",value:function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}},{key:"calcScissorRect",value:function(t){var e;if(!t._scissorRectLocal){var n=t._scissorRect,r=t.maskObject,i=this.renderer,s=i.renderTexture,a=r.getBounds(!0,null!==(e=an.pop())&&void 0!==e?e:new o.Ae);this.roundFrameToPixels(a,s.current?s.current.resolution:i.resolution,s.sourceFrame,s.destinationFrame,i.projection.transform),n&&a.fit(n),t._scissorRectLocal=a}}},{key:"testScissor",value:function(t){var e=t.maskObject;if(!e.isFastRect||!e.isFastRect())return!1;if(n.isMatrixRotated(e.worldTransform))return!1;if(n.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var r=t._scissorRectLocal;return r.width>0&&r.height>0}},{key:"roundFrameToPixels",value:function(t,e,r,i,s){n.isMatrixRotated(s)||((s=s?sn.copyFrom(s):sn.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(s,t),t.fit(i),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}},{key:"push",value:function(t){t._scissorRectLocal||this.calcScissorRect(t);var e=this.renderer.gl;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}},{key:"pop",value:function(t){var e=this.renderer.gl;t&&an.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}},{key:"_useCurrent",value:function(){var t,e=this.maskStack[this.maskStack.length-1]._scissorRect;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}}],[{key:"isMatrixRotated",value:function(t){if(!t)return!1;var e=t.a,n=t.b,r=t.c,i=t.d;return(Math.abs(n)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(i)>1e-4)}}]),n}(nn);function un(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}on.extension={type:a.n.RendererSystem,name:"scissor"},a.R.add(on);var hn=function(t){(0,lt.Z)(n,t);var e=un(n);function n(t){var r;return(0,u.Z)(this,n),(r=e.call(this,t)).glConst=i.Xd.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,r}return(0,h.Z)(n,[{key:"getStackLength",value:function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}},{key:"push",value:function(t){var e=t.maskObject,n=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++;var i=t._colorMask;0!==i&&(t._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,r,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==i&&(t._colorMask=i,n.colorMask(0!=(1&i),0!=(2&i),0!=(4&i),0!=(8&i))),this._useCurrent()}},{key:"pop",value:function(t){var e=this.renderer.gl;if(0===this.getStackLength())e.disable(e.STENCIL_TEST);else{var n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,r=n?n._colorMask:15;0!==r&&(n._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==r&&(n._colorMask=r,e.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))),this._useCurrent()}}},{key:"_useCurrent",value:function(){var t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}]),n}(nn);hn.extension={type:a.n.RendererSystem,name:"stencil"},a.R.add(hn);var ln=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new o.y3,this.transform=null}return(0,h.Z)(t,[{key:"update",value:function(t,e,n,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);var i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)}},{key:"calculateProjection",value:function(t,e,n,r){var i=this.projectionMatrix,s=r?-1:1;i.identity(),i.a=1/e.width*2,i.d=s*(1/e.height*2),i.tx=-1-e.x*i.a,i.ty=-s-e.y*i.d}},{key:"setTransform",value:function(t){}},{key:"destroy",value:function(){this.renderer=null}}]),t}();ln.extension={type:a.n.RendererSystem,name:"projection"},a.R.add(ln);var cn=new o.Ae,fn=new o.Ae,dn=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new o.Ae,this.destinationFrame=new o.Ae,this.viewportFrame=new o.Ae}return(0,h.Z)(t,[{key:"bind",value:function(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0,a=this.renderer;this.current=r,r?(n=(t=r.baseTexture).resolution,i||(cn.width=r.frame.width,cn.height=r.frame.height,i=cn),s||(fn.x=r.frame.x,fn.y=r.frame.y,fn.width=i.width,fn.height=i.height,s=fn),e=t.framebuffer):(n=a.resolution,i||(cn.width=a._view.screen.width,cn.height=a._view.screen.height,i=cn),s||((s=cn).width=i.width,s.height=i.height));var o=this.viewportFrame;o.x=s.x*n,o.y=s.y*n,o.width=s.width*n,o.height=s.height*n,r||(o.y=a.view.height-(o.y+o.height)),o.ceil(),this.renderer.framebuffer.bind(e,o),this.renderer.projection.update(s,i,n,!e),r?this.renderer.mask.setMaskStack(t.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(i),this.destinationFrame.copyFrom(s)}},{key:"clear",value:function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.renderer.background.colorRgba;var n=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer._view.screen,i=n.width!==r.width||n.height!==r.height;if(i){var s=this.viewportFrame,a=s.x,o=s.y,u=s.width,h=s.height;a=Math.round(a),o=Math.round(o),u=Math.round(u),h=Math.round(h),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(a,o,u,h)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),i&&this.renderer.scissor.pop()}},{key:"resize",value:function(){this.bind(null)}},{key:"reset",value:function(){this.bind(null)}},{key:"destroy",value:function(){this.renderer=null}}]),t}();function pn(t,e,n,r,i){n.buffer.update(i)}dn.extension={type:a.n.RendererSystem,name:"renderTexture"},a.R.add(dn);var vn={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},yn={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function mn(t,e){if(!t.autoManage)return{size:0,syncFunc:pn};for(var n=function(t,e){var n=[];for(var r in t)e[r]&&n.push(e[r]);return n.sort((function(t,e){return t.index-e.index})),n}(t.uniforms,e),r=function(t){for(var e=t.map((function(t){return{data:t,offset:0,dataLen:0,dirty:0}})),n=0,r=0,i=0,s=0;s<e.length;s++){var a=e[s];if(n=yn[a.data.type],a.data.size>1&&(n=Math.max(n,16)*a.data.size),a.dataLen=n,r%n!=0&&r<16){var o=r%n%16;r+=o,i+=o}r+n>16?(i=16*Math.ceil(i/16),a.offset=i,i+=n,r=n):(a.offset=i,r+=n,i+=n)}return{uboElements:e,size:i=16*Math.ceil(i/16)}}(n),i=r.uboElements,s=r.size,a=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],o=0;o<i.length;o++){for(var u=i[o],h=t.uniforms[u.data.name],l=u.data.name,c=!1,f=0;f<Fe.length;f++){var d=Fe[f];if(d.codeUbo&&d.test(u.data,h)){a.push("offset = ".concat(u.offset/4,";"),Fe[f].codeUbo(u.data.name,h)),c=!0;break}}if(!c)if(u.data.size>1){var p=Be(u.data.type),v=Math.max(yn[u.data.type]/16,1),y=p/v,m=(4-y%4)%4;a.push("\n                cv = ud.".concat(l,".value;\n                v = uv.").concat(l,";\n                offset = ").concat(u.offset/4,";\n\n                t = 0;\n\n                for(var i=0; i < ").concat(u.data.size*v,"; i++)\n                {\n                    for(var j = 0; j < ").concat(y,"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += ").concat(m,";\n                }\n\n                "))}else{var g=vn[u.data.type];a.push("\n                cv = ud.".concat(l,".value;\n                v = uv.").concat(l,";\n                offset = ").concat(u.offset/4,";\n                ").concat(g,";\n                "))}}return a.push("\n       renderer.buffer.update(buffer);\n    "),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",a.join("\n"))}}var gn,xn=function(){function t(e,n){(0,u.Z)(this,t),this.program=e,this.uniformData=n,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return(0,h.Z)(t,[{key:"destroy",value:function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}]),t}();function _n(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}function bn(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=!1;return e}function wn(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return bn(2*e);case"bvec3":return bn(3*e);case"bvec4":return bn(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function En(t,e){var n,r=t.getShaderSource(e).split("\n").map((function(t,e){return"".concat(e,": ").concat(t)})),i=t.getShaderInfoLog(e),s=i.split("\n"),a={},o=s.map((function(t){return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(t){return!(!t||a[t])&&(a[t]=!0,!0)})),u=[""];o.forEach((function(t){r[t-1]="%c".concat(r[t-1],"%c"),u.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var h=r.join("\n");u[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),(n=console).warn.apply(n,u),console.groupEnd()}function Tn(t,e){var n,r=_n(t,t.VERTEX_SHADER,e.vertexSrc),i=_n(t,t.FRAGMENT_SHADER,e.fragmentSrc),s=t.createProgram();t.attachShader(s,r),t.attachShader(s,i);var a=null===(n=e.extra)||void 0===n?void 0:n.transformFeedbackVaryings;if(a&&("function"!=typeof t.transformFeedbackVaryings||t.transformFeedbackVaryings(s,a.names,"separate"===a.bufferMode?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS)),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||function(t,e,n,r){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||En(t,n),t.getShaderParameter(r,t.COMPILE_STATUS)||En(t,r),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,s,r,i),e.attributeData=function(t,e){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var s=e.getActiveAttrib(t,i);if(!s.name.startsWith("gl_")){var a=Ze(e,s.type),o={type:a,name:s.name,size:Be(a),location:e.getAttribLocation(t,s.name)};n[s.name]=o}}return n}(s,t),e.uniformData=function(t,e){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<r;i++){var s=e.getActiveUniform(t,i),a=s.name.replace(/\[.*?\]$/,""),o=!!s.name.match(/\[.*?\]$/),u=Ze(e,s.type);n[a]={name:a,index:i,type:u,size:s.size,isArray:o,value:wn(u,s.size)}}return n}(s,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var o=Object.keys(e.attributeData);o.sort((function(t,e){return t>e?1:-1}));for(var u=0;u<o.length;u++)e.attributeData[o[u]].location=u,t.bindAttribLocation(s,u,o[u]);t.linkProgram(s)}t.deleteShader(r),t.deleteShader(i);var h={};for(var l in e.uniformData){var c=e.uniformData[l];h[l]={location:t.getUniformLocation(s,l),value:wn(c.type,c.size)}}return new xn(s,h)}var kn=0,An={textureCount:0,uboCount:0},Rn=function(){function t(e){(0,u.Z)(this,t),this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=kn++}return(0,h.Z)(t,[{key:"systemCheck",value:function(){if(!function(){if("boolean"==typeof gn)return gn;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");gn=!0===t({a:"b"},"a","b")}catch(e){gn=!1}return gn}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}},{key:"contextChange",value:function(t){this.gl=t,this.reset()}},{key:"bind",value:function(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),e||(An.textureCount=0,An.uboCount=0,this.syncUniformGroup(t.uniformGroup,An)),r}},{key:"setUniforms",value:function(t){var e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)}},{key:"syncUniformGroup",value:function(t,e){var n=this.getGlProgram();t.static&&t.dirtyId===n.uniformDirtyGroups[t.id]||(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))}},{key:"syncUniforms",value:function(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)}},{key:"createSyncGroups",value:function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var n=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var r in t.uniforms){var i=e[r];if(i){for(var s=t.uniforms[r],a=!1,o=0;o<Fe.length;o++)if(Fe[o].test(i,s)){n.push(Fe[o].code(r,s)),a=!0;break}if(!a){var u=(1!==i.size||i.isArray?Ge:Ue)[i.type].replace("location",'ud["'.concat(r,'"].location'));n.push('\n            cu = ud["'.concat(r,'"];\n            cv = cu.value;\n            v = uv["').concat(r,'"];\n            ').concat(u,";"))}}else{var h;null!==(h=t.uniforms[r])&&void 0!==h&&h.group&&(t.uniforms[r].ubo?n.push("\n                        renderer.shader.syncUniformBufferGroup(uv.".concat(r,", '").concat(r,"');\n                    ")):n.push("\n                        renderer.shader.syncUniformGroup(uv.".concat(r,", syncData);\n                    ")))}}return new Function("ud","uv","renderer","syncData",n.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}},{key:"syncUniformBufferGroup",value:function(t,e){var n=this.getGlProgram();if(!t.static||0!==t.dirtyId||!n.uniformGroups[t.id]){t.dirtyId=0;var r=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),r(n.uniformData,t.uniforms,this.renderer,An,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])}},{key:"createSyncBufferGroup",value:function(t,e,n){var r=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var i=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,i,this.shader.uniformBindCount),this.shader.uniformBindCount++;var s=this.getSignature(t,this.shader.program.uniformData,"ubo"),a=this._uboCache[s];if(a||(a=this._uboCache[s]=mn(t,this.shader.program.uniformData)),t.autoManage){var o=new Float32Array(a.size/4);t.buffer.update(o)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}},{key:"getSignature",value:function(t,e,n){var r=t.uniforms,i=["".concat(n,"-")];for(var s in r)i.push(s),e[s]&&i.push(e[s].type);return i.join("-")}},{key:"getGlProgram",value:function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}},{key:"generateProgram",value:function(t){var e=this.gl,n=t.program,r=Tn(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=r,r}},{key:"reset",value:function(){this.program=null,this.shader=null}},{key:"disposeShader",value:function(t){this.shader===t&&(this.shader=null)}},{key:"destroy",value:function(){this.renderer=null,this.destroyed=!0}}]),t}();Rn.extension={type:a.n.RendererSystem,name:"shader"},a.R.add(Rn);var Sn=function(){function t(){(0,u.Z)(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=s.T$.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Ye,this.defaultState.blend=!0}return(0,h.Z)(t,[{key:"contextChange",value:function(t){this.gl=t,this.blendModes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[s.T$.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.ADD]=[t.ONE,t.ONE],e[s.T$.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.NONE]=[0,0],e[s.T$.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[s.T$.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[s.T$.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[s.T$.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[s.T$.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[s.T$.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[s.T$.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[s.T$.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[s.T$.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[s.T$.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[s.T$.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()}},{key:"set",value:function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,n=0;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)}},{key:"forceState",value:function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var n=0;n<this.checks.length;n++)this.checks[n](this,t);this.stateId=t.data}},{key:"setBlend",value:function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}},{key:"setOffset",value:function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}},{key:"setDepthTest",value:function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}},{key:"setDepthMask",value:function(t){this.gl.depthMask(t)}},{key:"setCullFace",value:function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}},{key:"setFrontFace",value:function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}},{key:"setBlendMode",value:function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}}},{key:"setPolygonOffset",value:function(t,e){this.gl.polygonOffset(t,e)}},{key:"reset",value:function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}},{key:"updateCheck",value:function(t,e){var n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):e||-1===n||this.checks.splice(n,1)}},{key:"destroy",value:function(){this.gl=null}}],[{key:"checkBlendMode",value:function(t,e){t.setBlendMode(e.blendMode)}},{key:"checkPolygonOffset",value:function(t,e){t.setPolygonOffset(1,e.polygonOffset)}}]),t}(),In=Sn;In.extension={type:a.n.RendererSystem,name:"state"},a.R.add(In);var Pn=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=i.Xd.GC_MAX_IDLE,this.checkCountMax=i.Xd.GC_MAX_CHECK_COUNT,this.mode=i.Xd.GC_MODE}return(0,h.Z)(t,[{key:"postrender",value:function(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==s.UN.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}},{key:"run",value:function(){for(var t=this.renderer.texture,e=t.managedTextures,n=!1,r=0;r<e.length;r++){var i=e[r];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(t.destroyTexture(i,!0),e[r]=null,n=!0)}if(n){for(var s=0,a=0;a<e.length;a++)null!==e[a]&&(e[s++]=e[a]);e.length=s}}},{key:"unload",value:function(t){var e=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&e.destroyTexture(n);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])}},{key:"destroy",value:function(){this.renderer=null}}]),t}();Pn.extension={type:a.n.RendererSystem,name:"textureGC"},a.R.add(Pn);var Mn=n(4942);var Cn=(0,h.Z)((function t(e){(0,u.Z)(this,t),this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=s.vK.UNSIGNED_BYTE,this.internalFormat=s.I2.RGBA,this.samplerType=0})),On=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new xt,this.hasIntegerTextures=!1}return(0,h.Z)(t,[{key:"contextChange",value:function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){var e,n,r,i,a,o,u,h,l,c,f,d,p;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?(f={},(0,Mn.Z)(f,s.vK.UNSIGNED_BYTE,(n={},(0,Mn.Z)(n,s.I2.RGBA,t.RGBA8),(0,Mn.Z)(n,s.I2.RGB,t.RGB8),(0,Mn.Z)(n,s.I2.RG,t.RG8),(0,Mn.Z)(n,s.I2.RED,t.R8),(0,Mn.Z)(n,s.I2.RGBA_INTEGER,t.RGBA8UI),(0,Mn.Z)(n,s.I2.RGB_INTEGER,t.RGB8UI),(0,Mn.Z)(n,s.I2.RG_INTEGER,t.RG8UI),(0,Mn.Z)(n,s.I2.RED_INTEGER,t.R8UI),(0,Mn.Z)(n,s.I2.ALPHA,t.ALPHA),(0,Mn.Z)(n,s.I2.LUMINANCE,t.LUMINANCE),(0,Mn.Z)(n,s.I2.LUMINANCE_ALPHA,t.LUMINANCE_ALPHA),n)),(0,Mn.Z)(f,s.vK.BYTE,(r={},(0,Mn.Z)(r,s.I2.RGBA,t.RGBA8_SNORM),(0,Mn.Z)(r,s.I2.RGB,t.RGB8_SNORM),(0,Mn.Z)(r,s.I2.RG,t.RG8_SNORM),(0,Mn.Z)(r,s.I2.RED,t.R8_SNORM),(0,Mn.Z)(r,s.I2.RGBA_INTEGER,t.RGBA8I),(0,Mn.Z)(r,s.I2.RGB_INTEGER,t.RGB8I),(0,Mn.Z)(r,s.I2.RG_INTEGER,t.RG8I),(0,Mn.Z)(r,s.I2.RED_INTEGER,t.R8I),r)),(0,Mn.Z)(f,s.vK.UNSIGNED_SHORT,(i={},(0,Mn.Z)(i,s.I2.RGBA_INTEGER,t.RGBA16UI),(0,Mn.Z)(i,s.I2.RGB_INTEGER,t.RGB16UI),(0,Mn.Z)(i,s.I2.RG_INTEGER,t.RG16UI),(0,Mn.Z)(i,s.I2.RED_INTEGER,t.R16UI),(0,Mn.Z)(i,s.I2.DEPTH_COMPONENT,t.DEPTH_COMPONENT16),i)),(0,Mn.Z)(f,s.vK.SHORT,(a={},(0,Mn.Z)(a,s.I2.RGBA_INTEGER,t.RGBA16I),(0,Mn.Z)(a,s.I2.RGB_INTEGER,t.RGB16I),(0,Mn.Z)(a,s.I2.RG_INTEGER,t.RG16I),(0,Mn.Z)(a,s.I2.RED_INTEGER,t.R16I),a)),(0,Mn.Z)(f,s.vK.UNSIGNED_INT,(o={},(0,Mn.Z)(o,s.I2.RGBA_INTEGER,t.RGBA32UI),(0,Mn.Z)(o,s.I2.RGB_INTEGER,t.RGB32UI),(0,Mn.Z)(o,s.I2.RG_INTEGER,t.RG32UI),(0,Mn.Z)(o,s.I2.RED_INTEGER,t.R32UI),(0,Mn.Z)(o,s.I2.DEPTH_COMPONENT,t.DEPTH_COMPONENT24),o)),(0,Mn.Z)(f,s.vK.INT,(u={},(0,Mn.Z)(u,s.I2.RGBA_INTEGER,t.RGBA32I),(0,Mn.Z)(u,s.I2.RGB_INTEGER,t.RGB32I),(0,Mn.Z)(u,s.I2.RG_INTEGER,t.RG32I),(0,Mn.Z)(u,s.I2.RED_INTEGER,t.R32I),u)),(0,Mn.Z)(f,s.vK.FLOAT,(h={},(0,Mn.Z)(h,s.I2.RGBA,t.RGBA32F),(0,Mn.Z)(h,s.I2.RGB,t.RGB32F),(0,Mn.Z)(h,s.I2.RG,t.RG32F),(0,Mn.Z)(h,s.I2.RED,t.R32F),(0,Mn.Z)(h,s.I2.DEPTH_COMPONENT,t.DEPTH_COMPONENT32F),h)),(0,Mn.Z)(f,s.vK.HALF_FLOAT,(l={},(0,Mn.Z)(l,s.I2.RGBA,t.RGBA16F),(0,Mn.Z)(l,s.I2.RGB,t.RGB16F),(0,Mn.Z)(l,s.I2.RG,t.RG16F),(0,Mn.Z)(l,s.I2.RED,t.R16F),l)),(0,Mn.Z)(f,s.vK.UNSIGNED_SHORT_5_6_5,(0,Mn.Z)({},s.I2.RGB,t.RGB565)),(0,Mn.Z)(f,s.vK.UNSIGNED_SHORT_4_4_4_4,(0,Mn.Z)({},s.I2.RGBA,t.RGBA4)),(0,Mn.Z)(f,s.vK.UNSIGNED_SHORT_5_5_5_1,(0,Mn.Z)({},s.I2.RGBA,t.RGB5_A1)),(0,Mn.Z)(f,s.vK.UNSIGNED_INT_2_10_10_10_REV,(c={},(0,Mn.Z)(c,s.I2.RGBA,t.RGB10_A2),(0,Mn.Z)(c,s.I2.RGBA_INTEGER,t.RGB10_A2UI),c)),(0,Mn.Z)(f,s.vK.UNSIGNED_INT_10F_11F_11F_REV,(0,Mn.Z)({},s.I2.RGB,t.R11F_G11F_B10F)),(0,Mn.Z)(f,s.vK.UNSIGNED_INT_5_9_9_9_REV,(0,Mn.Z)({},s.I2.RGB,t.RGB9_E5)),(0,Mn.Z)(f,s.vK.UNSIGNED_INT_24_8,(0,Mn.Z)({},s.I2.DEPTH_STENCIL,t.DEPTH24_STENCIL8)),(0,Mn.Z)(f,s.vK.FLOAT_32_UNSIGNED_INT_24_8_REV,(0,Mn.Z)({},s.I2.DEPTH_STENCIL,t.DEPTH32F_STENCIL8)),e=f):(p={},(0,Mn.Z)(p,s.vK.UNSIGNED_BYTE,(d={},(0,Mn.Z)(d,s.I2.RGBA,t.RGBA),(0,Mn.Z)(d,s.I2.RGB,t.RGB),(0,Mn.Z)(d,s.I2.ALPHA,t.ALPHA),(0,Mn.Z)(d,s.I2.LUMINANCE,t.LUMINANCE),(0,Mn.Z)(d,s.I2.LUMINANCE_ALPHA,t.LUMINANCE_ALPHA),d)),(0,Mn.Z)(p,s.vK.UNSIGNED_SHORT_5_6_5,(0,Mn.Z)({},s.I2.RGB,t.RGB)),(0,Mn.Z)(p,s.vK.UNSIGNED_SHORT_4_4_4_4,(0,Mn.Z)({},s.I2.RGBA,t.RGBA)),(0,Mn.Z)(p,s.vK.UNSIGNED_SHORT_5_5_5_1,(0,Mn.Z)({},s.I2.RGBA,t.RGBA)),e=p),e}(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var n=0;n<e;n++)this.boundTextures[n]=null;this.emptyTextures={};var r=new Cn(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Cn(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var i=0;i<6;i++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var a=0;a<this.boundTextures.length;a++)this.bind(null,a)}},{key:"bind",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.gl;if(null!==(n=t=null===(e=t)||void 0===e?void 0:e.castToBaseTexture())&&void 0!==n&&n.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[r]!==t&&(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[r]=t}else this.currentLocation!==r&&(this.currentLocation=r,i.activeTexture(i.TEXTURE0+r)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[r]=null}},{key:"reset",value:function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}},{key:"unbind",value:function(t){var e=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<n.length;r++)n[r]===this.unknownTexture&&this.bind(null,r)}for(var i=0;i<n.length;i++)n[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[i]=null)}},{key:"ensureSamplerType",value:function(t){var e=this.boundTextures,n=this.hasIntegerTextures,r=this.CONTEXT_UID;if(n)for(var i=t-1;i>=0;--i){var a=e[i];if(a)a._glTextures[r].samplerType!==s.oT.FLOAT&&this.renderer.texture.unbind(a)}}},{key:"initTexture",value:function(t){var e=new Cn(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}},{key:"initTextureType",value:function(t,e){var n,r;e.internalFormat=null!==(n=null===(r=this.internalFormats[t.type])||void 0===r?void 0:r[t.format])&&void 0!==n?n:t.format,2===this.webGLVersion&&t.type===s.vK.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}},{key:"updateTexture",value:function(t){var e,n=t._glTextures[this.CONTEXT_UID];if(n){var r=this.renderer;if(this.initTextureType(t,n),null!==(e=t.resource)&&void 0!==e&&e.upload(r,t,n))n.samplerType!==s.oT.FLOAT&&(this.hasIntegerTextures=!0);else{var i=t.realWidth,a=t.realHeight,o=r.gl;(n.width!==i||n.height!==a||n.dirtyId<0)&&(n.width=i,n.height=a,o.texImage2D(t.target,0,n.internalFormat,i,a,0,t.format,n.type,null))}t.dirtyStyleId!==n.dirtyStyleId&&this.updateTextureStyle(t),n.dirtyId=t.dirtyId}}},{key:"destroyTexture",value:function(t,e){var n=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&X(this.managedTextures,r,1)}}},{key:"updateTextureStyle",value:function(t){var e,n=t._glTextures[this.CONTEXT_UID];n&&(t.mipmap!==s.WB.POW2&&2===this.webGLVersion||t.isPowerOfTwo?n.mipmap=t.mipmap>=1:n.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?n.wrapMode=t.wrapMode:n.wrapMode=s.Nt.CLAMP,null!==(e=t.resource)&&void 0!==e&&e.style(this.renderer,t,n)||this.setStyle(t,n),n.dirtyStyleId=t.dirtyStyleId)}},{key:"setStyle",value:function(t,e){var n=this.gl;if(e.mipmap&&t.mipmap!==s.WB.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===s.aH.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===s.aH.LINEAR){var i=Math.min(t.anisotropicLevel,n.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,i)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===s.aH.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===s.aH.LINEAR?n.LINEAR:n.NEAREST)}},{key:"destroy",value:function(){this.renderer=null}}]),t}();On.extension={type:a.n.RendererSystem,name:"texture"},a.R.add(On);var Dn=n(4925),Bn=["region"];function Nn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Ln=new o.wx,Zn=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this._tempMatrix=new o.y3}return(0,h.Z)(t,[{key:"generateTexture",value:function(t,e){var n=e||{},r=n.region,i=(0,Dn.Z)(n,Bn),s=r||t.getLocalBounds(null,!0);0===s.width&&(s.width=1),0===s.height&&(s.height=1);var a=Jt.create(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nn(Object(n),!0).forEach((function(e){(0,Mn.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({width:s.width,height:s.height},i));this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;var o=t.transform;return t.transform=Ln,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=o,a}},{key:"destroy",value:function(){}}]),t}();Zn.extension={type:[a.n.RendererSystem,a.n.CanvasRendererSystem],name:"textureGenerator"},a.R.add(Zn);var Fn=function(){function t(){(0,u.Z)(this,t),this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}return(0,h.Z)(t,[{key:"init",value:function(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color="string"==typeof t.color?I(t.color):t.color),this.alpha=t.alpha}},{key:"color",get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=S(t),R(t,this._backgroundColorRgba)}},{key:"alpha",get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t}},{key:"colorRgba",get:function(){return this._backgroundColorRgba}},{key:"colorString",get:function(){return this._backgroundColorString}},{key:"destroy",value:function(){}}]),t}();Fn.extension={type:[a.n.RendererSystem,a.n.CanvasRendererSystem],name:"background"},a.R.add(Fn);var Un=function(){function t(e){(0,u.Z)(this,t),this.renderer=e}return(0,h.Z)(t,[{key:"init",value:function(t){this.screen=new o.Ae(0,0,t.width,t.height),this.element=t.view||i.Xd.ADAPTER.createCanvas(),this.resolution=t.resolution||i.Xd.RESOLUTION,this.autoDensity=!!t.autoDensity}},{key:"resizeView",value:function(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);var n=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=n,this.screen.height=r,this.autoDensity&&(this.element.style.width="".concat(n,"px"),this.element.style.height="".concat(r,"px")),this.renderer.emit("resize",n,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}},{key:"destroy",value:function(t){var e;t&&(null===(e=this.element.parentNode)||void 0===e||e.removeChild(this.element));this.renderer=null,this.element=null,this.screen=null}}]),t}();Un.extension={type:[a.n.RendererSystem,a.n.CanvasRendererSystem],name:"_view"},a.R.add(Un);var Gn=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.plugins={}}return(0,h.Z)(t,[{key:"init",value:function(t){for(var e in t)this.plugins[e]=new t[e](this.renderer)}},{key:"destroy",value:function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}]),t}();Gn.extension={type:[a.n.RendererSystem,a.n.CanvasRendererSystem],name:"_plugin"},a.R.add(Gn);var Hn=n(2982);function Xn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Wn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wn(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function Wn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function jn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var zn=function(t){(0,lt.Z)(n,t);var e=jn(n);function n(){var t;return(0,u.Z)(this,n),(t=e.apply(this,arguments)).runners={},t._systemsHash={},t}return(0,h.Z)(n,[{key:"setup",value:function(t){var e;this.addRunners.apply(this,(0,Hn.Z)(t.runners));var n,r=(null!==(e=t.priority)&&void 0!==e?e:[]).filter((function(e){return t.systems[e]})),i=Xn([].concat((0,Hn.Z)(r),(0,Hn.Z)(Object.keys(t.systems).filter((function(t){return!r.includes(t)})))));try{for(i.s();!(n=i.n()).done;){var s=n.value;this.addSystem(t.systems[s],s)}}catch(a){i.e(a)}finally{i.f()}}},{key:"addRunners",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){t.runners[e]=new l(e)}))}},{key:"addSystem",value:function(t,e){var n=new t(this);if(this[e])throw new Error('Whoops! The name "'.concat(e,'" is already in use'));for(var r in this[e]=n,this._systemsHash[e]=n,this.runners)this.runners[r].add(n);return this}},{key:"emitWithCustomOptions",value:function(t,e){var n=this,r=Object.keys(this._systemsHash);t.items.forEach((function(i){var s=r.find((function(t){return n._systemsHash[t]===i}));i[t.name](e[s])}))}},{key:"destroy",value:function(){Object.values(this.runners).forEach((function(t){t.destroy()})),this._systemsHash={}}}]),n}(d()),Vn=function(){function t(e){(0,u.Z)(this,t),this.renderer=e}return(0,h.Z)(t,[{key:"run",value:function(t){var e=this.renderer;e.emitWithCustomOptions(e.runners.init,t),t.hello&&console.log("PixiJS ".concat("7.0.4"," - ",e.rendererLogId," - https://pixijs.com")),e.resize(this.renderer.screen.width,this.renderer.screen.height)}},{key:"destroy",value:function(){}}]),t}();Vn.extension={type:[a.n.RendererSystem,a.n.CanvasRendererSystem],name:"startup"},a.R.add(Vn);var Yn=function(){function t(e){(0,u.Z)(this,t),this.renderer=e}return(0,h.Z)(t,[{key:"contextChange",value:function(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}},{key:"bind",value:function(t){var e=this.gl,n=this.CONTEXT_UID,r=t._glTransformFeedbacks[n]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}},{key:"unbind",value:function(){var t=this.gl;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}},{key:"beginTransformFeedback",value:function(t,e){var n=this.gl,r=this.renderer;e&&r.shader.bind(e),n.beginTransformFeedback(t)}},{key:"endTransformFeedback",value:function(){this.gl.endTransformFeedback()}},{key:"createGLTransformFeedback",value:function(t){var e=this.gl,n=this.renderer,r=this.CONTEXT_UID,i=e.createTransformFeedback();t._glTransformFeedbacks[r]=i,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,i);for(var s=0;s<t.buffers.length;s++){var a=t.buffers[s];a&&(n.buffer.update(a),a._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,s,a._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),i}},{key:"disposeTransformFeedback",value:function(t,e){var n=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);var i=this.renderer.buffer;if(i)for(var s=0;s<t.buffers.length;s++){var a=t.buffers[s];if(a){var o=a._glBuffers[this.CONTEXT_UID];o&&(o.refCount--,0!==o.refCount||e||i.dispose(a,e))}}n&&(e||r.deleteTransformFeedback(n),delete t._glTransformFeedbacks[this.CONTEXT_UID])}},{key:"destroy",value:function(){this.renderer=null}}]),t}();function Kn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return qn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qn(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function qn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Yn.extension={type:a.n.RendererSystem,name:"transformFeedback"},a.R.add(Yn);var $n=[];function Qn(t){var e,n=Kn($n);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.test(t))return new r(t)}}catch(i){n.e(i)}finally{n.f()}throw new Error("Unable to auto-detect a suitable renderer.")}a.R.handleByList(a.n.Renderer,$n);var Jn="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",tr="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";function er(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var nr=function(t){(0,lt.Z)(n,t);var e=er(n);function n(t){var r,s,a;(0,u.Z)(this,n),a=e.call(this),t=Object.assign({},i.Xd.RENDER_OPTIONS,t),a.gl=null,a.CONTEXT_UID=0,a.globalUniforms=new pe({projectionMatrix:new o.y3},!0);var h={runners:["init","destroy","contextChange","reset","update","postrender","prerender","resize"],systems:n.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};a.setup(h);var l={hello:t.hello,_plugin:n.__plugins,background:{alpha:t.backgroundAlpha,color:null!==(r=t.background)&&void 0!==r?r:t.backgroundColor,clearBeforeRender:t.clearBeforeRender},_view:{height:t.height,width:t.width,autoDensity:t.autoDensity,resolution:t.resolution,view:t.view},context:{antialias:t.antialias,context:t.context,powerPreference:t.powerPreference,premultipliedAlpha:null!==(s=t.premultipliedAlpha)&&void 0!==s?s:t.useContextAlpha&&"notMultiplied"!==t.useContextAlpha,preserveDrawingBuffer:t.preserveDrawingBuffer}};return a.startup.run(l),a}return(0,h.Z)(n,[{key:"render",value:function(t,e){this.objectRenderer.render(t,e)}},{key:"resize",value:function(t,e){this._view.resizeView(t,e)}},{key:"reset",value:function(){return this.runners.reset.emit(),this}},{key:"clear",value:function(){this.renderTexture.bind(),this.renderTexture.clear()}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),(0,ht.Z)((0,ft.Z)(n.prototype),"destroy",this).call(this)}},{key:"plugins",get:function(){return this._plugin.plugins}},{key:"multisample",get:function(){return this._multisample.multisample}},{key:"width",get:function(){return this._view.element.width}},{key:"height",get:function(){return this._view.element.height}},{key:"resolution",get:function(){return this._view.resolution}},{key:"autoDensity",get:function(){return this._view.autoDensity}},{key:"view",get:function(){return this._view.element}},{key:"screen",get:function(){return this._view.screen}},{key:"lastObjectRendered",get:function(){return this.objectRenderer.lastObjectRendered}},{key:"renderingToScreen",get:function(){return this.objectRenderer.renderingToScreen}},{key:"rendererLogId",get:function(){return"WebGL ".concat(this.context.webGLVersion)}},{key:"clearBeforeRender",get:function(){return this.background.clearBeforeRender}},{key:"useContextAlpha",get:function(){return this.context.useContextAlpha}},{key:"preserveDrawingBuffer",get:function(){return this.context.preserveDrawingBuffer}},{key:"backgroundColor",get:function(){return this.background.color},set:function(t){this.background.color=t}},{key:"backgroundAlpha",get:function(){return this.background.color},set:function(t){this.background.alpha=t}},{key:"powerPreference",get:function(){return this.context.powerPreference}},{key:"generateTexture",value:function(t,e){return this.textureGenerator.generateTexture(t,e)}}],[{key:"test",value:function(t){return(null==t||!t.forceCanvas)&&T()}}]),n}(zn),rr=nr;rr.extension={type:a.n.Renderer,priority:1},rr.__plugins={},rr.__systems={},a.R.handleByMap(a.n.RendererPlugin,rr.__plugins),a.R.handleByMap(a.n.RendererSystem,rr.__systems),a.R.add(rr);var ir=(0,h.Z)((function t(){(0,u.Z)(this,t),this.texArray=null,this.blend=0,this.type=s.lg.TRIANGLES,this.start=0,this.size=0,this.data=null})),sr=function(){function t(){(0,u.Z)(this,t),this.elements=[],this.ids=[],this.count=0}return(0,h.Z)(t,[{key:"clear",value:function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}]),t}(),ar=function(){function t(e){(0,u.Z)(this,t),"number"==typeof e?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return(0,h.Z)(t,[{key:"int8View",get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}},{key:"uint8View",get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}},{key:"int16View",get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}},{key:"uint16View",get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}},{key:"int32View",get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}},{key:"view",value:function(t){return this["".concat(t,"View")]}},{key:"destroy",value:function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}}],[{key:"sizeOf",value:function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error("".concat(t," isn't a valid view type"))}}}]),t}(),or=function(){function t(e,n){if((0,u.Z)(this,t),this.vertexSrc=e,this.fragTemplate=n,this.programCache={},this.defaultGroupCache={},!n.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!n.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}return(0,h.Z)(t,[{key:"generateShader",value:function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=pe.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,"".concat(t))).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new ze(this.vertexSrc,r)}var i={tint:new Float32Array([1,1,1,1]),translationMatrix:new o.y3,default:this.defaultGroupCache[t]};return new Ve(this.programCache[t],i)}},{key:"generateSampleSrc",value:function(t){var e="";e+="\n",e+="\n";for(var n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+="if(vTextureId < ".concat(n,".5)")),e+="\n{",e+="\n\tcolor = texture2D(uSamplers[".concat(n,"], vTextureCoord);"),e+="\n}";return e+="\n",e+="\n"}}]),t}();function ur(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var hr=function(t){(0,lt.Z)(n,t);var e=ur(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,u.Z)(this,n),(t=e.call(this))._buffer=new re(null,r,!1),t._indexBuffer=new re(null,r,!0),t.addAttribute("aVertexPosition",t._buffer,2,!1,s.vK.FLOAT).addAttribute("aTextureCoord",t._buffer,2,!1,s.vK.FLOAT).addAttribute("aColor",t._buffer,4,!0,s.vK.UNSIGNED_BYTE).addAttribute("aTextureId",t._buffer,1,!0,s.vK.FLOAT).addIndex(t._indexBuffer),t}return(0,h.Z)(n)}(ue);function lr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,ft.Z)(t);if(e){var i=(0,ft.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,ct.Z)(this,n)}}var cr=function(t){(0,lt.Z)(n,t);var e=lr(n);function n(t){var r;return(0,u.Z)(this,n),(r=e.call(this,t)).setShaderGenerator(),r.geometryClass=hr,r.vertexSize=6,r.state=Ye.for2d(),r.size=4*i.Xd.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,(0,Dt.Z)(r)),t.runners.contextChange.add((0,Dt.Z)(r)),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return(0,h.Z)(n,[{key:"setShaderGenerator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vertex,r=void 0===e?n.defaultVertexSrc:e,i=t.fragment,s=void 0===i?n.defaultFragmentTemplate:i;this.shaderGenerator=new or(r,s)}},{key:"contextChange",value:function(){var t=this.renderer.gl;i.Xd.PREFER_ENV===s.Vi.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),i.Xd.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=e.createShader(e.FRAGMENT_SHADER);;){var r=He.replace(/%forloop%/gi,Xe(t));if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}},{key:"initFlushBuffers",value:function(){for(var t=n._drawCallPool,e=n._textureArrayPool,r=this.size/4,i=Math.floor(r/this.MAX_TEXTURES)+1;t.length<r;)t.push(new ir);for(;e.length<i;)e.push(new sr);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null}},{key:"onPrerender",value:function(){this._flushId=0}},{key:"render",value:function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}},{key:"buildTexturesAndDrawCalls",value:function(){var t=this._bufferedTextures,e=this.MAX_TEXTURES,r=n._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,a=this.renderer.textureGC.count,o=++xt._globalBatch,u=0,h=r[0],l=0;i.copyBoundTextures(s,e);for(var c=0;c<this._bufferSize;++c){var f=t[c];t[c]=null,f._batchEnabled!==o&&(h.count>=e&&(i.boundArray(h,s,o,e),this.buildDrawCalls(h,l,c),l=c,h=r[++u],++o),f._batchEnabled=o,f.touched=a,h.elements[h.count++]=f)}h.count>0&&(i.boundArray(h,s,o,e),this.buildDrawCalls(h,l,this._bufferSize),++u,++o);for(var d=0;d<s.length;d++)s[d]=null;xt._globalBatch=o}},{key:"buildDrawCalls",value:function(t,e,r){var i=this._bufferedElements,s=this._attributeBuffer,a=this._indexBuffer,o=this.vertexSize,u=n._drawCallPool,h=this._dcIndex,l=this._aIndex,c=this._iIndex,f=u[h];f.start=this._iIndex,f.texArray=t;for(var d=e;d<r;++d){var p=i[d],v=p._texture.baseTexture,y=M[v.alphaMode?1:0][p.blendMode];i[d]=null,e<d&&f.blend!==y&&(f.size=c-f.start,e=d,(f=u[++h]).texArray=t,f.start=c),this.packInterleavedGeometry(p,s,a,l,c),l+=p.vertexData.length/2*o,c+=p.indices.length,f.blend=y}e<r&&(f.size=c-f.start,++h),this._dcIndex=h,this._aIndex=l,this._iIndex=c}},{key:"bindAndClearTexArray",value:function(t){for(var e=this.renderer.texture,n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0}},{key:"updateGeometry",value:function(){var t=this._packedGeometries,e=this._attributeBuffer,n=this._indexBuffer;i.Xd.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}},{key:"drawBatches",value:function(){for(var t=this._dcIndex,e=this.renderer,r=e.gl,i=e.state,s=n._drawCallPool,a=null,o=0;o<t;o++){var u=s[o],h=u.texArray,l=u.type,c=u.size,f=u.start,d=u.blend;a!==h&&(a=h,this.bindAndClearTexArray(h)),this.state.blendMode=d,i.set(this.state),r.drawElements(l,c,r.UNSIGNED_SHORT,2*f)}}},{key:"flush",value:function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}},{key:"start",value:function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),i.Xd.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}},{key:"stop",value:function(){this.flush()}},{key:"destroy",value:function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),(0,ht.Z)((0,ft.Z)(n.prototype),"destroy",this).call(this)}},{key:"getAttributeBuffer",value:function(t){var e=U(Math.ceil(t/8)),n=H(e),r=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var i=this._aBuffers[r];return i||(this._aBuffers[r]=i=new ar(r*this.vertexSize*4)),i}},{key:"getIndexBuffer",value:function(t){var e=U(Math.ceil(t/12)),n=H(e),r=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var i=this._iBuffers[n];return i||(this._iBuffers[n]=i=new Uint16Array(r)),i}},{key:"packInterleavedGeometry",value:function(t,e,n,r,i){for(var s=e.uint32View,a=e.float32View,o=r/this.vertexSize,u=t.uvs,h=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,f=Math.min(t.worldAlpha,1),d=f<1&&t._texture.baseTexture.alphaMode?D(t._tintRGB,f):t._tintRGB+(255*f<<24),p=0;p<l.length;p+=2)a[r++]=l[p],a[r++]=l[p+1],a[r++]=u[p],a[r++]=u[p+1],s[r++]=d,a[r++]=c;for(var v=0;v<h.length;v++)n[i++]=o+h[v]}}],[{key:"defaultVertexSrc",get:function(){return"precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n"}},{key:"defaultFragmentTemplate",get:function(){return"varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n"}}]),n}(xe),fr=cr;fr.extension={name:"batch",type:a.n.RendererPlugin},fr._drawCallPool=[],fr._textureArrayPool=[],a.R.add(fr);var dr=(0,h.Z)((function t(e){(0,u.Z)(this,t),this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0})),pr=function(){function t(e){(0,u.Z)(this,t),this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}return(0,h.Z)(t,[{key:"destroy",value:function(){this.renderer=null}},{key:"contextChange",value:function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}},{key:"bind",value:function(t){var e=this.gl,n=this.CONTEXT_UID,r=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}},{key:"unbind",value:function(t){this.gl.bindBuffer(t,null)}},{key:"bindBufferBase",value:function(t,e){var n=this.gl,r=this.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var i=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,i.buffer)}}},{key:"bindBufferRange",value:function(t,e,n){var r=this.gl,i=this.CONTEXT_UID;n=n||0;var s=t._glBuffers[i]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,s.buffer,256*n,256)}},{key:"update",value:function(t){var e=this.gl,n=this.CONTEXT_UID,r=t._glBuffers[n]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{var i=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,i)}}},{key:"dispose",value:function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var n=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),n&&(e||r.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}}},{key:"disposeAll",value:function(t){for(var e=Object.keys(this.managedBuffers),n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)}},{key:"createGLBuffer",value:function(t){var e=this.CONTEXT_UID,n=this.gl;return t._glBuffers[e]=new dr(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}]),t}();pr.extension={type:a.n.RendererSystem,name:"buffer"},a.R.add(pr);var vr=function(){function t(e){(0,u.Z)(this,t),this.renderer=e}return(0,h.Z)(t,[{key:"contextChange",value:function(t){var e;if(1===this.renderer.context.webGLVersion){var n=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,n)}else{var r=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,r)}e>=s.G5.HIGH?this.multisample=s.G5.HIGH:e>=s.G5.MEDIUM?this.multisample=s.G5.MEDIUM:e>=s.G5.LOW?this.multisample=s.G5.LOW:this.multisample=s.G5.NONE}},{key:"destroy",value:function(){}}]),t}();vr.extension={type:a.n.RendererSystem,name:"_multisample"},a.R.add(vr);var yr=function(){function t(e){(0,u.Z)(this,t),this.renderer=e}return(0,h.Z)(t,[{key:"render",value:function(t,e){var n,r,i,s,a,o=this.renderer;if(e&&(r=e.renderTexture,i=e.clear,s=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!r,o.runners.prerender.emit(),o.emit("prerender"),o.projection.transform=s,!o.context.isLost){if(r||(this.lastObjectRendered=t),!a){var u=t.enableTempParent();t.updateTransform(),t.disableTempParent(u)}o.renderTexture.bind(r),o.batch.currentRenderer.start(),(null!==(n=i)&&void 0!==n?n:o.background.clearBeforeRender)&&o.renderTexture.clear(),t.render(o),o.batch.currentRenderer.flush(),r&&(e.blit&&o.framebuffer.blit(),r.baseTexture.update()),o.runners.postrender.emit(),o.projection.transform=null,o.emit("postrender")}}},{key:"destroy",value:function(){this.renderer=null,this.lastObjectRendered=null}}]),t}();yr.extension={type:a.n.RendererSystem,name:"objectRenderer"},a.R.add(yr)},6260:function(t,e,n){"use strict";n.d(e,{YZ:function(){return a},W2:function(){return y},s$:function(){return c}});var r=n(4662);r.Xd.SORTABLE_CHILDREN=!1;var i=n(5671),s=n(3144),a=function(){function t(){(0,i.Z)(this,t),this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return(0,s.Z)(t,[{key:"isEmpty",value:function(){return this.minX>this.maxX||this.minY>this.maxY}},{key:"clear",value:function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}},{key:"getRectangle",value:function(t){return this.minX>this.maxX||this.minY>this.maxY?r.Ae.EMPTY:((t=t||new r.Ae(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}},{key:"addPoint",value:function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}},{key:"addPointMatrix",value:function(t,e){var n=t.a,r=t.b,i=t.c,s=t.d,a=t.tx,o=t.ty,u=n*e.x+i*e.y+a,h=r*e.x+s*e.y+o;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)}},{key:"addQuad",value:function(t){var e=this.minX,n=this.minY,r=this.maxX,i=this.maxY,s=t[0],a=t[1];e=s<e?s:e,n=a<n?a:n,r=s>r?s:r,i=a>i?a:i,e=(s=t[2])<e?s:e,n=(a=t[3])<n?a:n,r=s>r?s:r,i=a>i?a:i,e=(s=t[4])<e?s:e,n=(a=t[5])<n?a:n,r=s>r?s:r,i=a>i?a:i,e=(s=t[6])<e?s:e,n=(a=t[7])<n?a:n,r=s>r?s:r,i=a>i?a:i,this.minX=e,this.minY=n,this.maxX=r,this.maxY=i}},{key:"addFrame",value:function(t,e,n,r,i){this.addFrameMatrix(t.worldTransform,e,n,r,i)}},{key:"addFrameMatrix",value:function(t,e,n,r,i){var s=t.a,a=t.b,o=t.c,u=t.d,h=t.tx,l=t.ty,c=this.minX,f=this.minY,d=this.maxX,p=this.maxY,v=s*e+o*n+h,y=a*e+u*n+l;c=v<c?v:c,f=y<f?y:f,d=v>d?v:d,p=y>p?y:p,c=(v=s*r+o*n+h)<c?v:c,f=(y=a*r+u*n+l)<f?y:f,d=v>d?v:d,p=y>p?y:p,c=(v=s*e+o*i+h)<c?v:c,f=(y=a*e+u*i+l)<f?y:f,d=v>d?v:d,p=y>p?y:p,c=(v=s*r+o*i+h)<c?v:c,f=(y=a*r+u*i+l)<f?y:f,d=v>d?v:d,p=y>p?y:p,this.minX=c,this.minY=f,this.maxX=d,this.maxY=p}},{key:"addVertexData",value:function(t,e,n){for(var r=this.minX,i=this.minY,s=this.maxX,a=this.maxY,o=e;o<n;o+=2){var u=t[o],h=t[o+1];r=u<r?u:r,i=h<i?h:i,s=u>s?u:s,a=h>a?h:a}this.minX=r,this.minY=i,this.maxX=s,this.maxY=a}},{key:"addVertices",value:function(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)}},{key:"addVerticesMatrix",value:function(t,e,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:i,a=t.a,o=t.b,u=t.c,h=t.d,l=t.tx,c=t.ty,f=this.minX,d=this.minY,p=this.maxX,v=this.maxY,y=n;y<r;y+=2){var m=e[y],g=e[y+1],x=a*m+u*g+l,_=h*g+o*m+c;f=Math.min(f,x-i),p=Math.max(p,x+i),d=Math.min(d,_-s),v=Math.max(v,_+s)}this.minX=f,this.minY=d,this.maxX=p,this.maxY=v}},{key:"addBounds",value:function(t){var e=this.minX,n=this.minY,r=this.maxX,i=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>i?t.maxY:i}},{key:"addBoundsMask",value:function(t,e){var n=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,i=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=i&&r<=s){var a=this.minX,o=this.minY,u=this.maxX,h=this.maxY;this.minX=n<a?n:a,this.minY=r<o?r:o,this.maxX=i>u?i:u,this.maxY=s>h?s:h}}},{key:"addBoundsMatrix",value:function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}},{key:"addBoundsArea",value:function(t,e){var n=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,i=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=i&&r<=s){var a=this.minX,o=this.minY,u=this.maxX,h=this.maxY;this.minX=n<a?n:a,this.minY=r<o?r:o,this.maxX=i>u?i:u,this.maxY=s>h?s:h}}},{key:"pad",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}},{key:"addFramePad",value:function(t,e,n,r,i,s){t-=i,e-=s,n+=i,r+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}}]),t}(),o=n(136),u=n(2963),h=n(1120);function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,h.Z)(t);if(e){var i=(0,h.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var c=function(t){(0,o.Z)(n,t);var e=l(n);function n(){var t;return(0,i.Z)(this,n),(t=e.call(this)).tempDisplayObjectParent=null,t.transform=new r.wx,t.alpha=1,t.visible=!0,t.renderable=!0,t.cullable=!1,t.cullArea=null,t.parent=null,t.worldAlpha=1,t._lastSortedIndex=0,t._zIndex=0,t.filterArea=null,t.filters=null,t._enabledFilters=null,t._bounds=new a,t._localBounds=null,t._boundsID=0,t._boundsRect=null,t._localBoundsRect=null,t._mask=null,t._maskRefCount=0,t._destroyed=!1,t.isSprite=!1,t.isMask=!1,t}return(0,s.Z)(n,[{key:"destroyed",get:function(){return this._destroyed}},{key:"_recursivePostUpdateTransform",value:function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}},{key:"updateTransform",value:function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}},{key:"getBounds",value:function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new r.Ae),e=this._boundsRect),this._bounds.getRectangle(e)}},{key:"getLocalBounds",value:function(t){t||(this._localBoundsRect||(this._localBoundsRect=new r.Ae),t=this._localBoundsRect),this._localBounds||(this._localBounds=new a);var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,s=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-s,o}},{key:"toGlobal",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}},{key:"toLocal",value:function(t,e,n,r){return e&&(t=e.toGlobal(t,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)}},{key:"setParent",value:function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}},{key:"removeFromParent",value:function(){var t;null===(t=this.parent)||void 0===t||t.removeChild(this)}},{key:"setTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;return this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=r||1,this.rotation=i,this.skew.x=s,this.skew.y=a,this.pivot.x=o,this.pivot.y=u,this}},{key:"destroy",value:function(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}},{key:"_tempDisplayObjectParent",get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new f),this.tempDisplayObjectParent}},{key:"enableTempParent",value:function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t}},{key:"disableTempParent",value:function(t){this.parent=t}},{key:"x",get:function(){return this.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.position.y},set:function(t){this.transform.position.y=t}},{key:"worldTransform",get:function(){return this.transform.worldTransform}},{key:"localTransform",get:function(){return this.transform.localTransform}},{key:"position",get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)}},{key:"scale",get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)}},{key:"pivot",get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)}},{key:"skew",get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t}},{key:"angle",get:function(){return this.transform.rotation*r.jl},set:function(t){this.transform.rotation=t*r.ZX}},{key:"zIndex",get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}},{key:"worldVisible",get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},{key:"mask",get:function(){return this._mask},set:function(t){if(this._mask!==t){if(this._mask){var e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){var n=this._mask.isMaskData?this._mask.maskObject:this._mask;n&&(0===n._maskRefCount&&(n.renderable=!1,n.isMask=!0),n._maskRefCount++)}}}}],[{key:"mixin",value:function(t){for(var e=Object.keys(t),r=0;r<e.length;++r){var i=e[r];Object.defineProperty(n.prototype,i,Object.getOwnPropertyDescriptor(t,i))}}}]),n}(r.P6.EventEmitter),f=function(t){(0,o.Z)(n,t);var e=l(n);function n(){var t;return(0,i.Z)(this,n),(t=e.apply(this,arguments)).sortDirty=null,t}return(0,s.Z)(n)}(c);c.prototype.displayObjectUpdateTransform=c.prototype.updateTransform;var d=n(1752);function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,h.Z)(t);if(e){var i=(0,h.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}function v(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}var y=function(t){(0,o.Z)(n,t);var e=p(n);function n(){var t;return(0,i.Z)(this,n),(t=e.call(this)).children=[],t.sortableChildren=r.Xd.SORTABLE_CHILDREN,t.sortDirty=!1,t}return(0,s.Z)(n,[{key:"onChildrenChange",value:function(t){}},{key:"addChild",value:function(){if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.addChild(t<0||arguments.length<=t?void 0:arguments[t]);else{var e=arguments.length<=0?void 0:arguments[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return arguments.length<=0?void 0:arguments[0]}},{key:"addChildAt",value:function(t,e){if(e<0||e>this.children.length)throw new Error("".concat(t,"addChildAt: The index ").concat(e," supplied is out of bounds ").concat(this.children.length));return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}},{key:"swapChildren",value:function(t,e){if(t!==e){var n=this.getChildIndex(t),r=this.getChildIndex(e);this.children[n]=e,this.children[r]=t,this.onChildrenChange(n<r?n:r)}}},{key:"getChildIndex",value:function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e}},{key:"setChildIndex",value:function(t,e){if(e<0||e>=this.children.length)throw new Error("The index ".concat(e," supplied is out of bounds ").concat(this.children.length));var n=this.getChildIndex(t);r.P6.removeItems(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)}},{key:"getChildAt",value:function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index (".concat(t,") does not exist."));return this.children[t]}},{key:"removeChild",value:function(){if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.removeChild(t<0||arguments.length<=t?void 0:arguments[t]);else{var e=arguments.length<=0?void 0:arguments[0],n=this.children.indexOf(e);if(-1===n)return null;e.parent=null,e.transform._parentID=-1,r.P6.removeItems(this.children,n,1),this._boundsID++,this.onChildrenChange(n),e.emit("removed",this),this.emit("childRemoved",e,this,n)}return arguments.length<=0?void 0:arguments[0]}},{key:"removeChildAt",value:function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,r.P6.removeItems(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}},{key:"removeChildren",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.children.length,r=e,i=n,s=i-r;if(s>0&&s<=i){t=this.children.splice(r,s);for(var a=0;a<t.length;++a)t[a].parent=null,t[a].transform&&(t[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(var o=0;o<t.length;++o)t[o].emit("removed",this),this.emit("childRemoved",t[o],this,o);return t}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}},{key:"sortChildren",value:function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(v),this.sortDirty=!1}},{key:"updateTransform",value:function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform()}}},{key:"calculateBounds",value:function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var n=e._mask.isMaskData?e._mask.maskObject:e._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}},{key:"getLocalBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(0,d.Z)((0,h.Z)(n.prototype),"getLocalBounds",this).call(this,t);if(!e)for(var i=0,s=this.children.length;i<s;++i){var a=this.children[i];a.visible&&a.updateTransform()}return r}},{key:"_calculateBounds",value:function(){}},{key:"_renderWithCulling",value:function(t){var e=t.renderTexture.sourceFrame;if(e.width>0&&e.height>0){var r,i;if(this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==n.prototype._render&&(r=this.getBounds(!0)),r&&e.intersects(r,i))this._render(t);else if(this.cullArea)return;for(var s=0,a=this.children.length;s<a;++s){var o=this.children[s],u=o.cullable;o.cullable=u||!this.cullArea,o.render(t),o.cullable=u}}}},{key:"render",value:function(t){var e;if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||null!==(e=this.filters)&&void 0!==e&&e.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(var n=0,r=this.children.length;n<r;++n)this.children[n].render(t)}}},{key:"renderAdvanced",value:function(t){var e,n,i,s=this.filters,a=this._mask;if(s){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var o=0;o<s.length;o++)s[o].enabled&&this._enabledFilters.push(s[o])}var u=s&&(null===(e=this._enabledFilters)||void 0===e?void 0:e.length)||a&&(!a.isMaskData||a.enabled&&(a.autoDetect||a.type!==r.A7.NONE));if(u&&t.batch.flush(),s&&null!==(n=this._enabledFilters)&&void 0!==n&&n.length&&t.filter.push(this,this._enabledFilters),a&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(var h=0,l=this.children.length;h<l;++h)this.children[h].render(t)}u&&t.batch.flush(),a&&t.mask.pop(this),s&&null!==(i=this._enabledFilters)&&void 0!==i&&i.length&&t.filter.pop()}},{key:"_render",value:function(t){}},{key:"destroy",value:function(t){(0,d.Z)((0,h.Z)(n.prototype),"destroy",this).call(this),this.sortDirty=!1;var e="boolean"==typeof t?t:null==t?void 0:t.children,r=this.removeChildren(0,this.children.length);if(e)for(var i=0;i<r.length;++i)r[i].destroy(t)}},{key:"width",get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}},{key:"height",get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}]),n}(c);y.prototype.containerUpdateTransform=y.prototype.updateTransform},4734:function(t,e,n){"use strict";n.d(e,{R:function(){return u},n:function(){return a}});var r=n(4942);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var a=function(t){return t.Renderer="renderer",t.Application="application",t.RendererSystem="renderer-webgl-system",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererSystem="renderer-canvas-system",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t}(a||{}),o=function(t){("function"==typeof t||"object"==typeof t&&t.extension)&&(t=s(s({},"object"!=typeof t.extension?{type:t.extension}:t.extension),{},{ref:t}));if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t=s({},t)).type&&(t.type=[t.type]),t},u={_addHandlers:{},_removeHandlers:{},_queue:{},remove:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.map(o).forEach((function(e){e.type.forEach((function(n){var r,i;return null===(r=(i=t._removeHandlers)[n])||void 0===r?void 0:r.call(i,e)}))})),this},add:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.map(o).forEach((function(e){e.type.forEach((function(n){var r=t._addHandlers,i=t._queue;r[n]?r[n](e):(i[n]=i[n]||[],i[n].push(e))}))})),this},handle:function(t,e,n){var r=this._addHandlers,i=this._removeHandlers;r[t]=e,i[t]=n;var s=this._queue;return s[t]&&(s[t].forEach((function(t){return e(t)})),delete s[t]),this},handleByMap:function(t,e){return this.handle(t,(function(t){e[t.name]=t.ref}),(function(t){delete e[t.name]}))},handleByList:function(t,e){return this.handle(t,(function(t){e.includes(t.ref)||(e.push(t.ref),e.sort((function(t,e){var n,r;return(null!==(n=e.priority)&&void 0!==n?n:-1)-(null!==(r=t.priority)&&void 0!==r?r:-1)})))}),(function(t){var n=e.indexOf(t.ref);-1!==n&&e.splice(n,1)}))}}},4386:function(t,e,n){"use strict";n.d(e,{Cd:function(){return f},ZX:function(){return o},Pj:function(){return d},y3:function(){return m},AB:function(){return y},_b:function(){return s},E9:function(){return h},mg:function(){return p},jl:function(){return a},Ae:function(){return c},c9:function(){return v},HS:function(){return u},wx:function(){return R},Lv:function(){return k}});var r=n(5671),i=n(3144),s=2*Math.PI,a=180/Math.PI,o=Math.PI/180,u=function(t){return t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC",t}(u||{}),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,r.Z)(this,t),this.x=0,this.y=0,this.x=e,this.y=n}return(0,i.Z)(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){return this.set(t.x,t.y),this}},{key:"copyTo",value:function(t){return t.set(this.x,this.y),t}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this.x=t,this.y=e,this}}]),t}(),l=[new h,new h,new h,new h],c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,r.Z)(this,t),this.x=Number(e),this.y=Number(n),this.width=Number(i),this.height=Number(s),this.type=u.RECT}return(0,i.Z)(t,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}},{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"copyFrom",value:function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}},{key:"copyTo",value:function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}},{key:"contains",value:function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)}},{key:"intersects",value:function(t,e){if(!e){var n=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=n)return!1;var r=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>r}var i=this.left,s=this.right,a=this.top,o=this.bottom;if(s<=i||o<=a)return!1;var u=l[0].set(t.left,t.top),h=l[1].set(t.left,t.bottom),c=l[2].set(t.right,t.top),f=l[3].set(t.right,t.bottom);if(c.x<=u.x||h.y<=u.y)return!1;var d=Math.sign(e.a*e.d-e.b*e.c);if(0===d)return!1;if(e.apply(u,u),e.apply(h,h),e.apply(c,c),e.apply(f,f),Math.max(u.x,h.x,c.x,f.x)<=i||Math.min(u.x,h.x,c.x,f.x)>=s||Math.max(u.y,h.y,c.y,f.y)<=a||Math.min(u.y,h.y,c.y,f.y)>=o)return!1;var p=d*(h.y-u.y),v=d*(u.x-h.x),y=p*i+v*a,m=p*s+v*a,g=p*i+v*o,x=p*s+v*o;if(Math.max(y,m,g,x)<=p*u.x+v*u.y||Math.min(y,m,g,x)>=p*f.x+v*f.y)return!1;var _=d*(u.y-c.y),b=d*(c.x-u.x),w=_*i+b*a,E=_*s+b*a,T=_*i+b*o,k=_*s+b*o;return!(Math.max(w,E,T,k)<=_*u.x+b*u.y||Math.min(w,E,T,k)>=_*f.x+b*f.y)}},{key:"pad",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this}},{key:"fit",value:function(t){var e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),i=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=r,this.height=Math.max(i-r,0),this}},{key:"ceil",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.001,n=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=r-this.y,this}},{key:"enlarge",value:function(t){var e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),i=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=r,this.height=i-r,this}}],[{key:"EMPTY",get:function(){return new t(0,0,0,0)}}]),t}(),f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,r.Z)(this,t),this.x=e,this.y=n,this.radius=i,this.type=u.CIRC}return(0,i.Z)(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.radius)}},{key:"contains",value:function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,r=this.x-t,i=this.y-e;return(r*=r)+(i*=i)<=n}},{key:"getBounds",value:function(){return new c(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}]),t}(),d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,r.Z)(this,t),this.x=e,this.y=n,this.width=i,this.height=s,this.type=u.ELIP}return(0,i.Z)(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"contains",value:function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,r=(e-this.y)/this.height;return(n*=n)+(r*=r)<=1}},{key:"getBounds",value:function(){return new c(this.x-this.width,this.y-this.height,this.width,this.height)}}]),t}(),p=function(){function t(){(0,r.Z)(this,t);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s=Array.isArray(n[0])?n[0]:n;if("number"!=typeof s[0]){for(var a=[],o=0,h=s.length;o<h;o++)a.push(s[o].x,s[o].y);s=a}this.points=s,this.type=u.POLY,this.closeStroke=!0}return(0,i.Z)(t,[{key:"clone",value:function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e}},{key:"contains",value:function(t,e){for(var n=!1,r=this.points.length/2,i=0,s=r-1;i<r;s=i++){var a=this.points[2*i],o=this.points[2*i+1],u=this.points[2*s],h=this.points[2*s+1];o>e!=h>e&&t<(e-o)/(h-o)*(u-a)+a&&(n=!n)}return n}}]),t}(),v=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;(0,r.Z)(this,t),this.x=e,this.y=n,this.width=i,this.height=s,this.radius=a,this.type=u.RREC}return(0,i.Z)(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height,this.radius)}},{key:"contains",value:function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){var n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;var r=t-(this.x+n),i=e-(this.y+n),s=n*n;if(r*r+i*i<=s)return!0;if((r=t-(this.x+this.width-n))*r+i*i<=s)return!0;if(r*r+(i=e-(this.y+this.height-n))*i<=s)return!0;if((r=t-(this.x+n))*r+i*i<=s)return!0}return!1}}]),t}(),y=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,r.Z)(this,t),this._x=i,this._y=s,this.cb=e,this.scope=n}return(0,i.Z)(t,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.cb,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scope;return new t(e,n,this._x,this._y)}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this}},{key:"copyFrom",value:function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}},{key:"copyTo",value:function(t){return t.set(this._x,this._y),t}},{key:"equals",value:function(t){return t.x===this._x&&t.y===this._y}},{key:"x",get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}},{key:"y",get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}]),t}(),m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;(0,r.Z)(this,t),this.array=null,this.a=e,this.b=n,this.c=i,this.d=s,this.tx=a,this.ty=o}return(0,i.Z)(t,[{key:"fromArray",value:function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}},{key:"set",value:function(t,e,n,r,i,s){return this.a=t,this.b=e,this.c=n,this.d=r,this.tx=i,this.ty=s,this}},{key:"toArray",value:function(t,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}},{key:"apply",value:function(t,e){e=e||new h;var n=t.x,r=t.y;return e.x=this.a*n+this.c*r+this.tx,e.y=this.b*n+this.d*r+this.ty,e}},{key:"applyInverse",value:function(t,e){e=e||new h;var n=1/(this.a*this.d+this.c*-this.b),r=t.x,i=t.y;return e.x=this.d*n*r+-this.c*n*i+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*i+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,e}},{key:"translate",value:function(t,e){return this.tx+=t,this.ty+=e,this}},{key:"scale",value:function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}},{key:"rotate",value:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.a,i=this.c,s=this.tx;return this.a=r*e-this.b*n,this.b=r*n+this.b*e,this.c=i*e-this.d*n,this.d=i*n+this.d*e,this.tx=s*e-this.ty*n,this.ty=s*n+this.ty*e,this}},{key:"append",value:function(t){var e=this.a,n=this.b,r=this.c,i=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*i,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*n+t.ty*i+this.ty,this}},{key:"setTransform",value:function(t,e,n,r,i,s,a,o,u){return this.a=Math.cos(a+u)*i,this.b=Math.sin(a+u)*i,this.c=-Math.sin(a-o)*s,this.d=Math.cos(a-o)*s,this.tx=t-(n*this.a+r*this.c),this.ty=e-(n*this.b+r*this.d),this}},{key:"prepend",value:function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var n=this.a,r=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}},{key:"decompose",value:function(t){var e=this.a,n=this.b,r=this.c,i=this.d,a=t.pivot,o=-Math.atan2(-r,i),u=Math.atan2(n,e),h=Math.abs(o+u);return h<1e-5||Math.abs(s-h)<1e-5?(t.rotation=u,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=u),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(r*r+i*i),t.position.x=this.tx+(a.x*e+a.y*r),t.position.y=this.ty+(a.x*n+a.y*i),t}},{key:"invert",value:function(){var t=this.a,e=this.b,n=this.c,r=this.d,i=this.tx,s=t*r-e*n;return this.a=r/s,this.b=-e/s,this.c=-n/s,this.d=t/s,this.tx=(n*this.ty-r*i)/s,this.ty=-(t*this.ty-e*i)/s,this}},{key:"identity",value:function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}},{key:"clone",value:function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}},{key:"copyTo",value:function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}},{key:"copyFrom",value:function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}}],[{key:"IDENTITY",get:function(){return new t}},{key:"TEMP_MATRIX",get:function(){return new t}}]),t}(),g=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],x=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],_=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],b=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],w=[],E=[],T=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];w.push(e);for(var n=0;n<16;n++)for(var r=T(g[t]*g[n]+_[t]*x[n]),i=T(x[t]*g[n]+b[t]*x[n]),s=T(g[t]*_[n]+_[t]*b[n]),a=T(x[t]*_[n]+b[t]*b[n]),o=0;o<16;o++)if(g[o]===r&&x[o]===i&&_[o]===s&&b[o]===a){e.push(o);break}}for(var u=0;u<16;u++){var h=new m;h.set(g[u],x[u],_[u],b[u],0,0),E.push(h)}}();var k={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return g[t]},uY:function(t){return x[t]},vX:function(t){return _[t]},vY:function(t){return b[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return w[t][e]},sub:function(t,e){return w[t][k.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?k.S:k.N:2*Math.abs(e)<=Math.abs(t)?t>0?k.E:k.W:e>0?t>0?k.SE:k.SW:t>0?k.NE:k.NW},matrixAppendRotationInv:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=E[k.inv(e)];i.tx=n,i.ty=r,t.append(i)}},A=function(){function t(){(0,r.Z)(this,t),this.worldTransform=new m,this.localTransform=new m,this.position=new y(this.onChange,this,0,0),this.scale=new y(this.onChange,this,1,1),this.pivot=new y(this.onChange,this,0,0),this.skew=new y(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return(0,i.Z)(t,[{key:"onChange",value:function(){this._localID++}},{key:"updateSkew",value:function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}},{key:"updateLocalTransform",value:function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)}},{key:"updateTransform",value:function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var n=t.worldTransform,r=this.worldTransform;r.a=e.a*n.a+e.b*n.c,r.b=e.a*n.b+e.b*n.d,r.c=e.c*n.a+e.d*n.c,r.d=e.c*n.b+e.d*n.d,r.tx=e.tx*n.a+e.ty*n.c+n.tx,r.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}}},{key:"setFromMatrix",value:function(t){t.decompose(this),this._localID++}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}}]),t}(),R=A;R.IDENTITY=new A},1025:function(t,e,n){"use strict";n.d(e,{tq:function(){return b},Xd:function(){return w}});var r=n(2549),i={createCanvas:function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var t;return null!==(t=document.baseURI)&&void 0!==t?t:window.location.href},getFontFaceSet:function(){return document.fonts},fetch:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return fetch(t,e)}))},s=(n(5743),/iPhone/i),a=/iPod/i,o=/iPad/i,u=/\biOS-universal(?:.+)Mac\b/i,h=/\bAndroid(?:.+)Mobile\b/i,l=/Android/i,c=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,f=/Silk/i,d=/Windows Phone/i,p=/\bWindows(?:.+)ARM\b/i,v=/BlackBerry/i,y=/BB10/i,m=/Opera Mini/i,g=/\b(CriOS|Chrome)(?:.+)Mobile/i,x=/Mobile(?:.+)Firefox\b/i,_=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};var b=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,r=n.split("[FBAN");void 0!==r[1]&&(n=r[0]),void 0!==(r=n.split("Twitter"))[1]&&(n=r[0]);var i=function(t){return function(e){return e.test(t)}}(n),b={apple:{phone:i(s)&&!i(d),ipod:i(a),tablet:!i(s)&&(i(o)||_(e))&&!i(d),universal:i(u),device:(i(s)||i(a)||i(o)||i(u)||_(e))&&!i(d)},amazon:{phone:i(c),tablet:!i(c)&&i(f),device:i(c)||i(f)},android:{phone:!i(d)&&i(c)||!i(d)&&i(h),tablet:!i(d)&&!i(c)&&!i(h)&&(i(f)||i(l)),device:!i(d)&&(i(c)||i(f)||i(h)||i(l))||i(/\bokhttp\b/i)},windows:{phone:i(d),tablet:i(p),device:i(d)||i(p)},other:{blackberry:i(v),blackberry10:i(y),opera:i(m),firefox:i(x),chrome:i(g),device:i(v)||i(y)||i(m)||i(x)||i(g)},any:!1,phone:!1,tablet:!1};return b.any=b.apple.device||b.android.device||b.windows.device||b.other.device,b.phone=b.apple.phone||b.android.phone||b.windows.phone,b.tablet=b.apple.tablet||b.android.tablet||b.windows.tablet,b}(globalThis.navigator);var w={ADAPTER:i,MIPMAP_TEXTURES:r.WB.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:r.G5.NONE,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(b.tablet||b.phone){if(b.apple.device){var n=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(n)parseInt(n[1],10)<11&&(e=!1)}if(b.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);if(r)parseInt(r[1],10)<7&&(e=!1)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},GC_MODE:r.UN.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:r.Nt.CLAMP,SCALE_MODE:r.aH.LINEAR,PRECISION_VERTEX:r.cB.HIGH,PRECISION_FRAGMENT:b.apple.device?r.cB.HIGH:r.cB.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!b.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1}},6397:function(t,e,n){"use strict";n.d(e,{vB:function(){return u},uF:function(){return a}});var r=n(1025);r.Xd.TARGET_FPMS=.06;var i=n(5671),s=n(3144),a=function(t){return t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t}(a||{}),o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,i.Z)(this,t),this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=n,this.priority=r,this.once=s}return(0,s.Z)(t,[{key:"match",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.fn===t&&this.context===e}},{key:"emit",value:function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}},{key:"connect",value:function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e}}]),t}(),u=function(){function t(){var e=this;(0,i.Z)(this,t),this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new o(null,null,1/0),this.deltaMS=1/r.Xd.TARGET_FPMS,this.elapsedMS=1/r.Xd.TARGET_FPMS,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return(0,s.Z)(t,[{key:"_requestIfNeeded",value:function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}},{key:"_cancelIfNeeded",value:function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}},{key:"_startIfPossible",value:function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}},{key:"add",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.NORMAL;return this._addListener(new o(t,e,n))}},{key:"addOnce",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.NORMAL;return this._addListener(new o(t,e,n,!0))}},{key:"_addListener",value:function(t){var e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this}},{key:"remove",value:function(t,e){for(var n=this._head.next;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this}},{key:"count",get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t}},{key:"start",value:function(){this.started||(this.started=!0,this._requestIfNeeded())}},{key:"stop",value:function(){this.started&&(this.started=!1,this._cancelIfNeeded())}},{key:"destroy",value:function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}},{key:"update",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now();if(e>this.lastTime){if((t=this.elapsedMS=e-this.lastTime)>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*r.Xd.TARGET_FPMS;for(var i=this._head,s=i.next;s;)s=s.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}},{key:"FPS",get:function(){return 1e3/this.elapsedMS}},{key:"minFPS",get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,r.Xd.TARGET_FPMS);this._maxElapsedMS=1/n}},{key:"maxFPS",get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}}],[{key:"shared",get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared}},{key:"system",get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system}}]),t}(),h=n(4734),l=function(){function t(){(0,i.Z)(this,t)}return(0,s.Z)(t,null,[{key:"init",value:function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,a.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?u.shared:new u,t.autoStart&&this.start()}},{key:"destroy",value:function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}}}]),t}();l.extension=h.n.Application,h.R.add(l)},3873:function(t,e,n){n(5743),t.exports=function(){"use strict";for(var t=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),t<e?e:t>n?n:t},e=t,n=function(t){t._clipped=!1,t._unclipped=t.slice(0);for(var n=0;n<=3;n++)n<3?((t[n]<0||t[n]>255)&&(t._clipped=!0),t[n]=e(t[n],0,255)):3===n&&(t[n]=e(t[n],0,1));return t},r={},i=0,s=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];i<s.length;i+=1){var a=s[i];r["[object "+a+"]"]=a.toLowerCase()}var o=function(t){return r[Object.prototype.toString.call(t)]||"object"},u=o,h=function(t,e){return void 0===e&&(e=null),t.length>=3?Array.prototype.slice.call(t):"object"==u(t[0])&&e?e.split("").filter((function(e){return void 0!==t[0][e]})).map((function(e){return t[0][e]})):t[0]},l=o,c=function(t){if(t.length<2)return null;var e=t.length-1;return"string"==l(t[e])?t[e].toLowerCase():null},f=Math.PI,d={clip_rgb:n,limit:t,type:o,unpack:h,last:c,PI:f,TWOPI:2*f,PITHIRD:f/3,DEG2RAD:f/180,RAD2DEG:180/f},p={format:{},autodetect:[]},v=d.last,y=d.clip_rgb,m=d.type,g=p,x=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=this;if("object"===m(t[0])&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];var r=v(t),i=!1;if(!r){i=!0,g.sorted||(g.autodetect=g.autodetect.sort((function(t,e){return e.p-t.p})),g.sorted=!0);for(var s=0,a=g.autodetect;s<a.length;s+=1){var o=a[s];if(r=o.test.apply(o,t))break}}if(!g.format[r])throw new Error("unknown format: "+t);var u=g.format[r].apply(null,i?t:t.slice(0,-1));n._rgb=y(u),3===n._rgb.length&&n._rgb.push(1)};x.prototype.toString=function(){return"function"==m(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var _=x,b=function t(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return new(Function.prototype.bind.apply(t.Color,[null].concat(e)))};b.Color=_,b.version="2.4.2";var w=b,E=d.unpack,T=Math.max,k=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=E(t,"rgb"),r=n[0],i=n[1],s=n[2],a=1-T(r/=255,T(i/=255,s/=255)),o=a<1?1/(1-a):0;return[(1-r-a)*o,(1-i-a)*o,(1-s-a)*o,a]},A=k,R=d.unpack,S=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=R(t,"cmyk"))[0],r=t[1],i=t[2],s=t[3],a=t.length>4?t[4]:1;return 1===s?[0,0,0,a]:[n>=1?0:255*(1-n)*(1-s),r>=1?0:255*(1-r)*(1-s),i>=1?0:255*(1-i)*(1-s),a]},I=S,P=w,M=_,C=p,O=d.unpack,D=d.type,B=A;M.prototype.cmyk=function(){return B(this._rgb)},P.cmyk=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(M,[null].concat(t,["cmyk"])))},C.format.cmyk=I,C.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=O(t,"cmyk"),"array"===D(t)&&4===t.length)return"cmyk"}});var N=d.unpack,L=d.last,Z=function(t){return Math.round(100*t)/100},F=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=N(t,"hsla"),r=L(t)||"lsa";return n[0]=Z(n[0]||0),n[1]=Z(100*n[1])+"%",n[2]=Z(100*n[2])+"%","hsla"===r||n.length>3&&n[3]<1?(n[3]=n.length>3?n[3]:1,r="hsla"):n.length=3,r+"("+n.join(",")+")"},U=F,G=d.unpack,H=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=G(t,"rgba"))[0],r=t[1],i=t[2];n/=255,r/=255,i/=255;var s,a,o=Math.min(n,r,i),u=Math.max(n,r,i),h=(u+o)/2;return u===o?(s=0,a=Number.NaN):s=h<.5?(u-o)/(u+o):(u-o)/(2-u-o),n==u?a=(r-i)/(u-o):r==u?a=2+(i-n)/(u-o):i==u&&(a=4+(n-r)/(u-o)),(a*=60)<0&&(a+=360),t.length>3&&void 0!==t[3]?[a,s,h,t[3]]:[a,s,h]},X=H,W=d.unpack,j=d.last,z=U,V=X,Y=Math.round,K=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=W(t,"rgba"),r=j(t)||"rgb";return"hsl"==r.substr(0,3)?z(V(n),r):(n[0]=Y(n[0]),n[1]=Y(n[1]),n[2]=Y(n[2]),("rgba"===r||n.length>3&&n[3]<1)&&(n[3]=n.length>3?n[3]:1,r="rgba"),r+"("+n.slice(0,"rgb"===r?3:4).join(",")+")")},q=K,$=d.unpack,Q=Math.round,J=function(){for(var t,e=[],n=arguments.length;n--;)e[n]=arguments[n];var r,i,s,a=(e=$(e,"hsl"))[0],o=e[1],u=e[2];if(0===o)r=i=s=255*u;else{var h=[0,0,0],l=[0,0,0],c=u<.5?u*(1+o):u+o-u*o,f=2*u-c,d=a/360;h[0]=d+1/3,h[1]=d,h[2]=d-1/3;for(var p=0;p<3;p++)h[p]<0&&(h[p]+=1),h[p]>1&&(h[p]-=1),6*h[p]<1?l[p]=f+6*(c-f)*h[p]:2*h[p]<1?l[p]=c:3*h[p]<2?l[p]=f+(c-f)*(2/3-h[p])*6:l[p]=f;r=(t=[Q(255*l[0]),Q(255*l[1]),Q(255*l[2])])[0],i=t[1],s=t[2]}return e.length>3?[r,i,s,e[3]]:[r,i,s,1]},tt=J,et=tt,nt=p,rt=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,it=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,st=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,at=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,ot=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ut=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,ht=Math.round,lt=function(t){var e;if(t=t.toLowerCase().trim(),nt.format.named)try{return nt.format.named(t)}catch(p){}if(e=t.match(rt)){for(var n=e.slice(1,4),r=0;r<3;r++)n[r]=+n[r];return n[3]=1,n}if(e=t.match(it)){for(var i=e.slice(1,5),s=0;s<4;s++)i[s]=+i[s];return i}if(e=t.match(st)){for(var a=e.slice(1,4),o=0;o<3;o++)a[o]=ht(2.55*a[o]);return a[3]=1,a}if(e=t.match(at)){for(var u=e.slice(1,5),h=0;h<3;h++)u[h]=ht(2.55*u[h]);return u[3]=+u[3],u}if(e=t.match(ot)){var l=e.slice(1,4);l[1]*=.01,l[2]*=.01;var c=et(l);return c[3]=1,c}if(e=t.match(ut)){var f=e.slice(1,4);f[1]*=.01,f[2]*=.01;var d=et(f);return d[3]=+e[4],d}};lt.test=function(t){return rt.test(t)||it.test(t)||st.test(t)||at.test(t)||ot.test(t)||ut.test(t)};var ct=lt,ft=w,dt=_,pt=p,vt=d.type,yt=q,mt=ct;dt.prototype.css=function(t){return yt(this._rgb,t)},ft.css=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(dt,[null].concat(t,["css"])))},pt.format.css=mt,pt.autodetect.push({p:5,test:function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(!e.length&&"string"===vt(t)&&mt.test(t))return"css"}});var gt=_,xt=w,_t=p,bt=d.unpack;_t.format.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=bt(t,"rgba");return n[0]*=255,n[1]*=255,n[2]*=255,n},xt.gl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(gt,[null].concat(t,["gl"])))},gt.prototype.gl=function(){var t=this._rgb;return[t[0]/255,t[1]/255,t[2]/255,t[3]]};var wt=d.unpack,Et=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r=wt(t,"rgb"),i=r[0],s=r[1],a=r[2],o=Math.min(i,s,a),u=Math.max(i,s,a),h=u-o,l=100*h/255,c=o/(255-h)*100;return 0===h?n=Number.NaN:(i===u&&(n=(s-a)/h),s===u&&(n=2+(a-i)/h),a===u&&(n=4+(i-s)/h),(n*=60)<0&&(n+=360)),[n,l,c]},Tt=Et,kt=d.unpack,At=Math.floor,Rt=function(){for(var t,e,n,r,i,s,a=[],o=arguments.length;o--;)a[o]=arguments[o];var u,h,l,c=(a=kt(a,"hcg"))[0],f=a[1],d=a[2];d*=255;var p=255*f;if(0===f)u=h=l=d;else{360===c&&(c=0),c>360&&(c-=360),c<0&&(c+=360);var v=At(c/=60),y=c-v,m=d*(1-f),g=m+p*(1-y),x=m+p*y,_=m+p;switch(v){case 0:u=(t=[_,x,m])[0],h=t[1],l=t[2];break;case 1:u=(e=[g,_,m])[0],h=e[1],l=e[2];break;case 2:u=(n=[m,_,x])[0],h=n[1],l=n[2];break;case 3:u=(r=[m,g,_])[0],h=r[1],l=r[2];break;case 4:u=(i=[x,m,_])[0],h=i[1],l=i[2];break;case 5:u=(s=[_,m,g])[0],h=s[1],l=s[2]}}return[u,h,l,a.length>3?a[3]:1]},St=Rt,It=d.unpack,Pt=d.type,Mt=w,Ct=_,Ot=p,Dt=Tt;Ct.prototype.hcg=function(){return Dt(this._rgb)},Mt.hcg=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Ct,[null].concat(t,["hcg"])))},Ot.format.hcg=St,Ot.autodetect.push({p:1,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=It(t,"hcg"),"array"===Pt(t)&&3===t.length)return"hcg"}});var Bt=d.unpack,Nt=d.last,Lt=Math.round,Zt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=Bt(t,"rgba"),r=n[0],i=n[1],s=n[2],a=n[3],o=Nt(t)||"auto";void 0===a&&(a=1),"auto"===o&&(o=a<1?"rgba":"rgb");var u="000000"+((r=Lt(r))<<16|(i=Lt(i))<<8|(s=Lt(s))).toString(16);u=u.substr(u.length-6);var h="0"+Lt(255*a).toString(16);switch(h=h.substr(h.length-2),o.toLowerCase()){case"rgba":return"#"+u+h;case"argb":return"#"+h+u;default:return"#"+u}},Ft=Zt,Ut=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Gt=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Ht=function(t){if(t.match(Ut)){4!==t.length&&7!==t.length||(t=t.substr(1)),3===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var e=parseInt(t,16);return[e>>16,e>>8&255,255&e,1]}if(t.match(Gt)){5!==t.length&&9!==t.length||(t=t.substr(1)),4===t.length&&(t=(t=t.split(""))[0]+t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);var n=parseInt(t,16);return[n>>24&255,n>>16&255,n>>8&255,Math.round((255&n)/255*100)/100]}throw new Error("unknown hex color: "+t)},Xt=w,Wt=_,jt=d.type,zt=p,Vt=Ft;Wt.prototype.hex=function(t){return Vt(this._rgb,t)},Xt.hex=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Wt,[null].concat(t,["hex"])))},zt.format.hex=Ht,zt.autodetect.push({p:4,test:function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(!e.length&&"string"===jt(t)&&[3,4,5,6,7,8,9].indexOf(t.length)>=0)return"hex"}});var Yt=d.unpack,Kt=d.TWOPI,qt=Math.min,$t=Math.sqrt,Qt=Math.acos,Jt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r=Yt(t,"rgb"),i=r[0],s=r[1],a=r[2],o=qt(i/=255,s/=255,a/=255),u=(i+s+a)/3,h=u>0?1-o/u:0;return 0===h?n=NaN:(n=(i-s+(i-a))/2,n/=$t((i-s)*(i-s)+(i-a)*(s-a)),n=Qt(n),a>s&&(n=Kt-n),n/=Kt),[360*n,h,u]},te=Jt,ee=d.unpack,ne=d.limit,re=d.TWOPI,ie=d.PITHIRD,se=Math.cos,ae=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r,i,s=(t=ee(t,"hsi"))[0],a=t[1],o=t[2];return isNaN(s)&&(s=0),isNaN(a)&&(a=0),s>360&&(s-=360),s<0&&(s+=360),(s/=360)<1/3?r=1-((i=(1-a)/3)+(n=(1+a*se(re*s)/se(ie-re*s))/3)):s<2/3?i=1-((n=(1-a)/3)+(r=(1+a*se(re*(s-=1/3))/se(ie-re*s))/3)):n=1-((r=(1-a)/3)+(i=(1+a*se(re*(s-=2/3))/se(ie-re*s))/3)),[255*(n=ne(o*n*3)),255*(r=ne(o*r*3)),255*(i=ne(o*i*3)),t.length>3?t[3]:1]},oe=ae,ue=d.unpack,he=d.type,le=w,ce=_,fe=p,de=te;ce.prototype.hsi=function(){return de(this._rgb)},le.hsi=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(ce,[null].concat(t,["hsi"])))},fe.format.hsi=oe,fe.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=ue(t,"hsi"),"array"===he(t)&&3===t.length)return"hsi"}});var pe=d.unpack,ve=d.type,ye=w,me=_,ge=p,xe=X;me.prototype.hsl=function(){return xe(this._rgb)},ye.hsl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(me,[null].concat(t,["hsl"])))},ge.format.hsl=tt,ge.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=pe(t,"hsl"),"array"===ve(t)&&3===t.length)return"hsl"}});var _e=d.unpack,be=Math.min,we=Math.max,Ee=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r,i,s=(t=_e(t,"rgb"))[0],a=t[1],o=t[2],u=be(s,a,o),h=we(s,a,o),l=h-u;return i=h/255,0===h?(n=Number.NaN,r=0):(r=l/h,s===h&&(n=(a-o)/l),a===h&&(n=2+(o-s)/l),o===h&&(n=4+(s-a)/l),(n*=60)<0&&(n+=360)),[n,r,i]},Te=Ee,ke=d.unpack,Ae=Math.floor,Re=function(){for(var t,e,n,r,i,s,a=[],o=arguments.length;o--;)a[o]=arguments[o];var u,h,l,c=(a=ke(a,"hsv"))[0],f=a[1],d=a[2];if(d*=255,0===f)u=h=l=d;else{360===c&&(c=0),c>360&&(c-=360),c<0&&(c+=360);var p=Ae(c/=60),v=c-p,y=d*(1-f),m=d*(1-f*v),g=d*(1-f*(1-v));switch(p){case 0:u=(t=[d,g,y])[0],h=t[1],l=t[2];break;case 1:u=(e=[m,d,y])[0],h=e[1],l=e[2];break;case 2:u=(n=[y,d,g])[0],h=n[1],l=n[2];break;case 3:u=(r=[y,m,d])[0],h=r[1],l=r[2];break;case 4:u=(i=[g,y,d])[0],h=i[1],l=i[2];break;case 5:u=(s=[d,y,m])[0],h=s[1],l=s[2]}}return[u,h,l,a.length>3?a[3]:1]},Se=Re,Ie=d.unpack,Pe=d.type,Me=w,Ce=_,Oe=p,De=Te;Ce.prototype.hsv=function(){return De(this._rgb)},Me.hsv=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Ce,[null].concat(t,["hsv"])))},Oe.format.hsv=Se,Oe.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Ie(t,"hsv"),"array"===Pe(t)&&3===t.length)return"hsv"}});var Be={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Ne=Be,Le=d.unpack,Ze=Math.pow,Fe=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=Le(t,"rgb"),r=n[0],i=n[1],s=n[2],a=He(r,i,s),o=a[0],u=a[1],h=116*u-16;return[h<0?0:h,500*(o-u),200*(u-a[2])]},Ue=function(t){return(t/=255)<=.04045?t/12.92:Ze((t+.055)/1.055,2.4)},Ge=function(t){return t>Ne.t3?Ze(t,1/3):t/Ne.t2+Ne.t0},He=function(t,e,n){return t=Ue(t),e=Ue(e),n=Ue(n),[Ge((.4124564*t+.3575761*e+.1804375*n)/Ne.Xn),Ge((.2126729*t+.7151522*e+.072175*n)/Ne.Yn),Ge((.0193339*t+.119192*e+.9503041*n)/Ne.Zn)]},Xe=Fe,We=Be,je=d.unpack,ze=Math.pow,Ve=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n,r,i,s=(t=je(t,"lab"))[0],a=t[1],o=t[2];return r=(s+16)/116,n=isNaN(a)?r:r+a/500,i=isNaN(o)?r:r-o/200,r=We.Yn*Ke(r),n=We.Xn*Ke(n),i=We.Zn*Ke(i),[Ye(3.2404542*n-1.5371385*r-.4985314*i),Ye(-.969266*n+1.8760108*r+.041556*i),Ye(.0556434*n-.2040259*r+1.0572252*i),t.length>3?t[3]:1]},Ye=function(t){return 255*(t<=.00304?12.92*t:1.055*ze(t,1/2.4)-.055)},Ke=function(t){return t>We.t1?t*t*t:We.t2*(t-We.t0)},qe=Ve,$e=d.unpack,Qe=d.type,Je=w,tn=_,en=p,nn=Xe;tn.prototype.lab=function(){return nn(this._rgb)},Je.lab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(tn,[null].concat(t,["lab"])))},en.format.lab=qe,en.autodetect.push({p:2,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=$e(t,"lab"),"array"===Qe(t)&&3===t.length)return"lab"}});var rn=d.unpack,sn=d.RAD2DEG,an=Math.sqrt,on=Math.atan2,un=Math.round,hn=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=rn(t,"lab"),r=n[0],i=n[1],s=n[2],a=an(i*i+s*s),o=(on(s,i)*sn+360)%360;return 0===un(1e4*a)&&(o=Number.NaN),[r,a,o]},ln=hn,cn=d.unpack,fn=Xe,dn=ln,pn=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=cn(t,"rgb"),r=n[0],i=n[1],s=n[2],a=fn(r,i,s),o=a[0],u=a[1],h=a[2];return dn(o,u,h)},vn=pn,yn=d.unpack,mn=d.DEG2RAD,gn=Math.sin,xn=Math.cos,_n=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=yn(t,"lch"),r=n[0],i=n[1],s=n[2];return isNaN(s)&&(s=0),[r,xn(s*=mn)*i,gn(s)*i]},bn=_n,wn=d.unpack,En=bn,Tn=qe,kn=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=wn(t,"lch"))[0],r=t[1],i=t[2],s=En(n,r,i),a=s[0],o=s[1],u=s[2],h=Tn(a,o,u);return[h[0],h[1],h[2],t.length>3?t[3]:1]},An=kn,Rn=d.unpack,Sn=An,In=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=Rn(t,"hcl").reverse();return Sn.apply(void 0,n)},Pn=In,Mn=d.unpack,Cn=d.type,On=w,Dn=_,Bn=p,Nn=vn;Dn.prototype.lch=function(){return Nn(this._rgb)},Dn.prototype.hcl=function(){return Nn(this._rgb).reverse()},On.lch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Dn,[null].concat(t,["lch"])))},On.hcl=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Dn,[null].concat(t,["hcl"])))},Bn.format.lch=An,Bn.format.hcl=Pn,["lch","hcl"].forEach((function(t){return Bn.autodetect.push({p:2,test:function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];if(e=Mn(e,t),"array"===Cn(e)&&3===e.length)return t}})}));var Ln={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Zn=_,Fn=p,Un=d.type,Gn=Ln,Hn=Ht,Xn=Ft;Zn.prototype.name=function(){for(var t=Xn(this._rgb,"rgb"),e=0,n=Object.keys(Gn);e<n.length;e+=1){var r=n[e];if(Gn[r]===t)return r.toLowerCase()}return t},Fn.format.named=function(t){if(t=t.toLowerCase(),Gn[t])return Hn(Gn[t]);throw new Error("unknown color name: "+t)},Fn.autodetect.push({p:5,test:function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(!e.length&&"string"===Un(t)&&Gn[t.toLowerCase()])return"named"}});var Wn=d.unpack,jn=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=Wn(t,"rgb");return(n[0]<<16)+(n[1]<<8)+n[2]},zn=jn,Vn=d.type,Yn=function(t){if("number"==Vn(t)&&t>=0&&t<=16777215)return[t>>16,t>>8&255,255&t,1];throw new Error("unknown num color: "+t)},Kn=w,qn=_,$n=p,Qn=d.type,Jn=zn;qn.prototype.num=function(){return Jn(this._rgb)},Kn.num=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(qn,[null].concat(t,["num"])))},$n.format.num=Yn,$n.autodetect.push({p:5,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(1===t.length&&"number"===Qn(t[0])&&t[0]>=0&&t[0]<=16777215)return"num"}});var tr=w,er=_,nr=p,rr=d.unpack,ir=d.type,sr=Math.round;er.prototype.rgb=function(t){return void 0===t&&(t=!0),!1===t?this._rgb.slice(0,3):this._rgb.slice(0,3).map(sr)},er.prototype.rgba=function(t){return void 0===t&&(t=!0),this._rgb.slice(0,4).map((function(e,n){return n<3?!1===t?e:sr(e):e}))},tr.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(er,[null].concat(t,["rgb"])))},nr.format.rgb=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=rr(t,"rgba");return void 0===n[3]&&(n[3]=1),n},nr.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=rr(t,"rgba"),"array"===ir(t)&&(3===t.length||4===t.length&&"number"==ir(t[3])&&t[3]>=0&&t[3]<=1))return"rgb"}});var ar=Math.log,or=function(t){var e,n,r,i=t/100;return i<66?(e=255,n=i<6?0:-155.25485562709179-.44596950469579133*(n=i-2)+104.49216199393888*ar(n),r=i<20?0:.8274096064007395*(r=i-10)-254.76935184120902+115.67994401066147*ar(r)):(e=351.97690566805693+.114206453784165*(e=i-55)-40.25366309332127*ar(e),n=325.4494125711974+.07943456536662342*(n=i-50)-28.0852963507957*ar(n),r=255),[e,n,r,1]},ur=or,hr=d.unpack,lr=Math.round,cr=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n,r=hr(t,"rgb"),i=r[0],s=r[2],a=1e3,o=4e4,u=.4;o-a>u;){var h=ur(n=.5*(o+a));h[2]/h[0]>=s/i?o=n:a=n}return lr(n)},fr=w,dr=_,pr=p,vr=cr;dr.prototype.temp=dr.prototype.kelvin=dr.prototype.temperature=function(){return vr(this._rgb)},fr.temp=fr.kelvin=fr.temperature=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(dr,[null].concat(t,["temp"])))},pr.format.temp=pr.format.kelvin=pr.format.temperature=or;var yr=d.unpack,mr=Math.cbrt,gr=Math.pow,xr=Math.sign,_r=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=yr(t,"rgb"),r=n[0],i=n[1],s=n[2],a=[wr(r/255),wr(i/255),wr(s/255)],o=a[0],u=a[1],h=a[2],l=mr(.4122214708*o+.5363325363*u+.0514459929*h),c=mr(.2119034982*o+.6806995451*u+.1073969566*h),f=mr(.0883024619*o+.2817188376*u+.6299787005*h);return[.2104542553*l+.793617785*c-.0040720468*f,1.9779984951*l-2.428592205*c+.4505937099*f,.0259040371*l+.7827717662*c-.808675766*f]},br=_r;function wr(t){var e=Math.abs(t);return e<.04045?t/12.92:(xr(t)||1)*gr((e+.055)/1.055,2.4)}var Er=d.unpack,Tr=Math.pow,kr=Math.sign,Ar=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=Er(t,"lab"))[0],r=t[1],i=t[2],s=Tr(n+.3963377774*r+.2158037573*i,3),a=Tr(n-.1055613458*r-.0638541728*i,3),o=Tr(n-.0894841775*r-1.291485548*i,3);return[255*Sr(4.0767416621*s-3.3077115913*a+.2309699292*o),255*Sr(-1.2684380046*s+2.6097574011*a-.3413193965*o),255*Sr(-.0041960863*s-.7034186147*a+1.707614701*o),t.length>3?t[3]:1]},Rr=Ar;function Sr(t){var e=Math.abs(t);return e>.0031308?(kr(t)||1)*(1.055*Tr(e,1/2.4)-.055):12.92*t}var Ir=d.unpack,Pr=d.type,Mr=w,Cr=_,Or=p,Dr=br;Cr.prototype.oklab=function(){return Dr(this._rgb)},Mr.oklab=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Cr,[null].concat(t,["oklab"])))},Or.format.oklab=Rr,Or.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=Ir(t,"oklab"),"array"===Pr(t)&&3===t.length)return"oklab"}});var Br=d.unpack,Nr=br,Lr=ln,Zr=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=Br(t,"rgb"),r=n[0],i=n[1],s=n[2],a=Nr(r,i,s),o=a[0],u=a[1],h=a[2];return Lr(o,u,h)},Fr=Zr,Ur=d.unpack,Gr=bn,Hr=Rr,Xr=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=(t=Ur(t,"lch"))[0],r=t[1],i=t[2],s=Gr(n,r,i),a=s[0],o=s[1],u=s[2],h=Hr(a,o,u);return[h[0],h[1],h[2],t.length>3?t[3]:1]},Wr=Xr,jr=d.unpack,zr=d.type,Vr=w,Yr=_,Kr=p,qr=Fr;Yr.prototype.oklch=function(){return qr(this._rgb)},Vr.oklch=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return new(Function.prototype.bind.apply(Yr,[null].concat(t,["oklch"])))},Kr.format.oklch=Wr,Kr.autodetect.push({p:3,test:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(t=jr(t,"oklch"),"array"===zr(t)&&3===t.length)return"oklch"}});var $r=_,Qr=d.type;$r.prototype.alpha=function(t,e){return void 0===e&&(e=!1),void 0!==t&&"number"===Qr(t)?e?(this._rgb[3]=t,this):new $r([this._rgb[0],this._rgb[1],this._rgb[2],t],"rgb"):this._rgb[3]},_.prototype.clipped=function(){return this._rgb._clipped||!1};var Jr=_,ti=Be;Jr.prototype.darken=function(t){void 0===t&&(t=1);var e=this,n=e.lab();return n[0]-=ti.Kn*t,new Jr(n,"lab").alpha(e.alpha(),!0)},Jr.prototype.brighten=function(t){return void 0===t&&(t=1),this.darken(-t)},Jr.prototype.darker=Jr.prototype.darken,Jr.prototype.brighter=Jr.prototype.brighten,_.prototype.get=function(t){var e=t.split("."),n=e[0],r=e[1],i=this[n]();if(r){var s=n.indexOf(r)-("ok"===n.substr(0,2)?2:0);if(s>-1)return i[s];throw new Error("unknown channel "+r+" in mode "+n)}return i};var ei=_,ni=d.type,ri=Math.pow,ii=1e-7,si=20;ei.prototype.luminance=function(t){if(void 0!==t&&"number"===ni(t)){if(0===t)return new ei([0,0,0,this._rgb[3]],"rgb");if(1===t)return new ei([255,255,255,this._rgb[3]],"rgb");var e=this.luminance(),n="rgb",r=si,i=function e(i,s){var a=i.interpolate(s,.5,n),o=a.luminance();return Math.abs(t-o)<ii||!r--?a:o>t?e(i,a):e(a,s)},s=(e>t?i(new ei([0,0,0]),this):i(this,new ei([255,255,255]))).rgb();return new ei(s.concat([this._rgb[3]]))}return ai.apply(void 0,this._rgb.slice(0,3))};var ai=function(t,e,n){return.2126*(t=oi(t))+.7152*(e=oi(e))+.0722*(n=oi(n))},oi=function(t){return(t/=255)<=.03928?t/12.92:ri((t+.055)/1.055,2.4)},ui={},hi=_,li=d.type,ci=ui,fi=function(t,e,n){void 0===n&&(n=.5);for(var r=[],i=arguments.length-3;i-- >0;)r[i]=arguments[i+3];var s=r[0]||"lrgb";if(ci[s]||r.length||(s=Object.keys(ci)[0]),!ci[s])throw new Error("interpolation mode "+s+" is not defined");return"object"!==li(t)&&(t=new hi(t)),"object"!==li(e)&&(e=new hi(e)),ci[s](t,e,n).alpha(t.alpha()+n*(e.alpha()-t.alpha()))},di=_,pi=fi;di.prototype.mix=di.prototype.interpolate=function(t,e){void 0===e&&(e=.5);for(var n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];return pi.apply(void 0,[this,t,e].concat(n))};var vi=_;vi.prototype.premultiply=function(t){void 0===t&&(t=!1);var e=this._rgb,n=e[3];return t?(this._rgb=[e[0]*n,e[1]*n,e[2]*n,n],this):new vi([e[0]*n,e[1]*n,e[2]*n,n],"rgb")};var yi=_,mi=Be;yi.prototype.saturate=function(t){void 0===t&&(t=1);var e=this,n=e.lch();return n[1]+=mi.Kn*t,n[1]<0&&(n[1]=0),new yi(n,"lch").alpha(e.alpha(),!0)},yi.prototype.desaturate=function(t){return void 0===t&&(t=1),this.saturate(-t)};var gi=_,xi=d.type;gi.prototype.set=function(t,e,n){void 0===n&&(n=!1);var r=t.split("."),i=r[0],s=r[1],a=this[i]();if(s){var o=i.indexOf(s)-("ok"===i.substr(0,2)?2:0);if(o>-1){if("string"==xi(e))switch(e.charAt(0)){case"+":case"-":a[o]+=+e;break;case"*":a[o]*=+e.substr(1);break;case"/":a[o]/=+e.substr(1);break;default:a[o]=+e}else{if("number"!==xi(e))throw new Error("unsupported value for Color.set");a[o]=e}var u=new gi(a,i);return n?(this._rgb=u._rgb,this):u}throw new Error("unknown channel "+s+" in mode "+i)}return a};var _i=_,bi=function(t,e,n){var r=t._rgb,i=e._rgb;return new _i(r[0]+n*(i[0]-r[0]),r[1]+n*(i[1]-r[1]),r[2]+n*(i[2]-r[2]),"rgb")};ui.rgb=bi;var wi=_,Ei=Math.sqrt,Ti=Math.pow,ki=function(t,e,n){var r=t._rgb,i=r[0],s=r[1],a=r[2],o=e._rgb,u=o[0],h=o[1],l=o[2];return new wi(Ei(Ti(i,2)*(1-n)+Ti(u,2)*n),Ei(Ti(s,2)*(1-n)+Ti(h,2)*n),Ei(Ti(a,2)*(1-n)+Ti(l,2)*n),"rgb")};ui.lrgb=ki;var Ai=_,Ri=function(t,e,n){var r=t.lab(),i=e.lab();return new Ai(r[0]+n*(i[0]-r[0]),r[1]+n*(i[1]-r[1]),r[2]+n*(i[2]-r[2]),"lab")};ui.lab=Ri;var Si=_,Ii=function(t,e,n,r){var i,s,a,o,u,h,l,c,f,d,p,v,y;return"hsl"===r?(a=t.hsl(),o=e.hsl()):"hsv"===r?(a=t.hsv(),o=e.hsv()):"hcg"===r?(a=t.hcg(),o=e.hcg()):"hsi"===r?(a=t.hsi(),o=e.hsi()):"lch"===r||"hcl"===r?(r="hcl",a=t.hcl(),o=e.hcl()):"oklch"===r&&(a=t.oklch().reverse(),o=e.oklch().reverse()),"h"!==r.substr(0,1)&&"oklch"!==r||(u=(i=a)[0],l=i[1],f=i[2],h=(s=o)[0],c=s[1],d=s[2]),isNaN(u)||isNaN(h)?isNaN(u)?isNaN(h)?v=Number.NaN:(v=h,1!=f&&0!=f||"hsv"==r||(p=c)):(v=u,1!=d&&0!=d||"hsv"==r||(p=l)):v=u+n*(h>u&&h-u>180?h-(u+360):h<u&&u-h>180?h+360-u:h-u),void 0===p&&(p=l+n*(c-l)),y=f+n*(d-f),new Si("oklch"===r?[y,p,v]:[v,p,y],r)},Pi=Ii,Mi=function(t,e,n){return Pi(t,e,n,"lch")};ui.lch=Mi,ui.hcl=Mi;var Ci=_,Oi=function(t,e,n){var r=t.num(),i=e.num();return new Ci(r+n*(i-r),"num")};ui.num=Oi;var Di=Ii,Bi=function(t,e,n){return Di(t,e,n,"hcg")};ui.hcg=Bi;var Ni=Ii,Li=function(t,e,n){return Ni(t,e,n,"hsi")};ui.hsi=Li;var Zi=Ii,Fi=function(t,e,n){return Zi(t,e,n,"hsl")};ui.hsl=Fi;var Ui=Ii,Gi=function(t,e,n){return Ui(t,e,n,"hsv")};ui.hsv=Gi;var Hi=_,Xi=function(t,e,n){var r=t.oklab(),i=e.oklab();return new Hi(r[0]+n*(i[0]-r[0]),r[1]+n*(i[1]-r[1]),r[2]+n*(i[2]-r[2]),"oklab")};ui.oklab=Xi;var Wi=Ii,ji=function(t,e,n){return Wi(t,e,n,"oklch")};ui.oklch=ji;var zi=_,Vi=d.clip_rgb,Yi=Math.pow,Ki=Math.sqrt,qi=Math.PI,$i=Math.cos,Qi=Math.sin,Ji=Math.atan2,ts=function(t,e,n){void 0===e&&(e="lrgb"),void 0===n&&(n=null);var r=t.length;n||(n=Array.from(new Array(r)).map((function(){return 1})));var i=r/n.reduce((function(t,e){return t+e}));if(n.forEach((function(t,e){n[e]*=i})),t=t.map((function(t){return new zi(t)})),"lrgb"===e)return es(t,n);for(var s=t.shift(),a=s.get(e),o=[],u=0,h=0,l=0;l<a.length;l++)if(a[l]=(a[l]||0)*n[0],o.push(isNaN(a[l])?0:n[0]),"h"===e.charAt(l)&&!isNaN(a[l])){var c=a[l]/180*qi;u+=$i(c)*n[0],h+=Qi(c)*n[0]}var f=s.alpha()*n[0];t.forEach((function(t,r){var i=t.get(e);f+=t.alpha()*n[r+1];for(var s=0;s<a.length;s++)if(!isNaN(i[s]))if(o[s]+=n[r+1],"h"===e.charAt(s)){var l=i[s]/180*qi;u+=$i(l)*n[r+1],h+=Qi(l)*n[r+1]}else a[s]+=i[s]*n[r+1]}));for(var d=0;d<a.length;d++)if("h"===e.charAt(d)){for(var p=Ji(h/o[d],u/o[d])/qi*180;p<0;)p+=360;for(;p>=360;)p-=360;a[d]=p}else a[d]=a[d]/o[d];return f/=r,new zi(a,e).alpha(f>.99999?1:f,!0)},es=function(t,e){for(var n=t.length,r=[0,0,0,0],i=0;i<t.length;i++){var s=t[i],a=e[i]/n,o=s._rgb;r[0]+=Yi(o[0],2)*a,r[1]+=Yi(o[1],2)*a,r[2]+=Yi(o[2],2)*a,r[3]+=o[3]*a}return r[0]=Ki(r[0]),r[1]=Ki(r[1]),r[2]=Ki(r[2]),r[3]>.9999999&&(r[3]=1),new zi(Vi(r))},ns=w,rs=d.type,is=Math.pow,ss=function(t){var e="rgb",n=ns("#ccc"),r=0,i=[0,1],s=[],a=[0,0],o=!1,u=[],h=!1,l=0,c=1,f=!1,d={},p=!0,v=1,y=function(t){if((t=t||["#fff","#000"])&&"string"===rs(t)&&ns.brewer&&ns.brewer[t.toLowerCase()]&&(t=ns.brewer[t.toLowerCase()]),"array"===rs(t)){1===t.length&&(t=[t[0],t[0]]),t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=ns(t[e]);s.length=0;for(var n=0;n<t.length;n++)s.push(n/(t.length-1))}return b(),u=t},m=function(t){if(null!=o){for(var e=o.length-1,n=0;n<e&&t>=o[n];)n++;return n-1}return 0},g=function(t){return t},x=function(t){return t},_=function(t,r){var i,h;if(null==r&&(r=!1),isNaN(t)||null===t)return n;h=r?t:o&&o.length>2?m(t)/(o.length-2):c!==l?(t-l)/(c-l):1,h=x(h),r||(h=g(h)),1!==v&&(h=is(h,v)),h=a[0]+h*(1-a[0]-a[1]),h=Math.min(1,Math.max(0,h));var f=Math.floor(1e4*h);if(p&&d[f])i=d[f];else{if("array"===rs(u))for(var y=0;y<s.length;y++){var _=s[y];if(h<=_){i=u[y];break}if(h>=_&&y===s.length-1){i=u[y];break}if(h>_&&h<s[y+1]){h=(h-_)/(s[y+1]-_),i=ns.interpolate(u[y],u[y+1],h,e);break}}else"function"===rs(u)&&(i=u(h));p&&(d[f]=i)}return i},b=function(){return d={}};y(t);var w=function(t){var e=ns(_(t));return h&&e[h]?e[h]():e};return w.classes=function(t){if(null!=t){if("array"===rs(t))o=t,i=[t[0],t[t.length-1]];else{var e=ns.analyze(i);o=0===t?[e.min,e.max]:ns.limits(e,"e",t)}return w}return o},w.domain=function(t){if(!arguments.length)return i;l=t[0],c=t[t.length-1],s=[];var e=u.length;if(t.length===e&&l!==c)for(var n=0,r=Array.from(t);n<r.length;n+=1){var a=r[n];s.push((a-l)/(c-l))}else{for(var o=0;o<e;o++)s.push(o/(e-1));if(t.length>2){var h=t.map((function(e,n){return n/(t.length-1)})),f=t.map((function(t){return(t-l)/(c-l)}));f.every((function(t,e){return h[e]===t}))||(x=function(t){if(t<=0||t>=1)return t;for(var e=0;t>=f[e+1];)e++;var n=(t-f[e])/(f[e+1]-f[e]);return h[e]+n*(h[e+1]-h[e])})}}return i=[l,c],w},w.mode=function(t){return arguments.length?(e=t,b(),w):e},w.range=function(t,e){return y(t),w},w.out=function(t){return h=t,w},w.spread=function(t){return arguments.length?(r=t,w):r},w.correctLightness=function(t){return null==t&&(t=!0),f=t,b(),g=f?function(t){for(var e=_(0,!0).lab()[0],n=_(1,!0).lab()[0],r=e>n,i=_(t,!0).lab()[0],s=e+(n-e)*t,a=i-s,o=0,u=1,h=20;Math.abs(a)>.01&&h-- >0;)r&&(a*=-1),a<0?(o=t,t+=.5*(u-t)):(u=t,t+=.5*(o-t)),i=_(t,!0).lab()[0],a=i-s;return t}:function(t){return t},w},w.padding=function(t){return null!=t?("number"===rs(t)&&(t=[t,t]),a=t,w):a},w.colors=function(e,n){arguments.length<2&&(n="hex");var r=[];if(0===arguments.length)r=u.slice(0);else if(1===e)r=[w(.5)];else if(e>1){var s=i[0],a=i[1]-s;r=as(0,e,!1).map((function(t){return w(s+t/(e-1)*a)}))}else{t=[];var h=[];if(o&&o.length>2)for(var l=1,c=o.length,f=1<=c;f?l<c:l>c;f?l++:l--)h.push(.5*(o[l-1]+o[l]));else h=i;r=h.map((function(t){return w(t)}))}return ns[n]&&(r=r.map((function(t){return t[n]()}))),r},w.cache=function(t){return null!=t?(p=t,w):p},w.gamma=function(t){return null!=t?(v=t,w):v},w.nodata=function(t){return null!=t?(n=ns(t),w):n},w};function as(t,e,n){for(var r=[],i=t<e,s=n?i?e+1:e-1:e,a=t;i?a<s:a>s;i?a++:a--)r.push(a);return r}var os=_,us=ss,hs=function(t){for(var e=[1,1],n=1;n<t;n++){for(var r=[1],i=1;i<=e.length;i++)r[i]=(e[i]||0)+e[i-1];e=r}return e},ls=function(t){var e,n,r,i,s,a,o;if(2===(t=t.map((function(t){return new os(t)}))).length)e=t.map((function(t){return t.lab()})),s=e[0],a=e[1],i=function(t){var e=[0,1,2].map((function(e){return s[e]+t*(a[e]-s[e])}));return new os(e,"lab")};else if(3===t.length)n=t.map((function(t){return t.lab()})),s=n[0],a=n[1],o=n[2],i=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*s[e]+2*(1-t)*t*a[e]+t*t*o[e]}));return new os(e,"lab")};else if(4===t.length){var u;r=t.map((function(t){return t.lab()})),s=r[0],a=r[1],o=r[2],u=r[3],i=function(t){var e=[0,1,2].map((function(e){return(1-t)*(1-t)*(1-t)*s[e]+3*(1-t)*(1-t)*t*a[e]+3*(1-t)*t*t*o[e]+t*t*t*u[e]}));return new os(e,"lab")}}else{if(!(t.length>=5))throw new RangeError("No point in running bezier with only one color.");var h,l,c;h=t.map((function(t){return t.lab()})),c=t.length-1,l=hs(c),i=function(t){var e=1-t,n=[0,1,2].map((function(n){return h.reduce((function(r,i,s){return r+l[s]*Math.pow(e,c-s)*Math.pow(t,s)*i[n]}),0)}));return new os(n,"lab")}}return i},cs=function(t){var e=ls(t);return e.scale=function(){return us(e)},e},fs=w,ds=function t(e,n,r){if(!t[r])throw new Error("unknown blend mode "+r);return t[r](e,n)},ps=function(t){return function(e,n){var r=fs(n).rgb(),i=fs(e).rgb();return fs.rgb(t(r,i))}},vs=function(t){return function(e,n){var r=[];return r[0]=t(e[0],n[0]),r[1]=t(e[1],n[1]),r[2]=t(e[2],n[2]),r}},ys=function(t){return t},ms=function(t,e){return t*e/255},gs=function(t,e){return t>e?e:t},xs=function(t,e){return t>e?t:e},_s=function(t,e){return 255*(1-(1-t/255)*(1-e/255))},bs=function(t,e){return e<128?2*t*e/255:255*(1-2*(1-t/255)*(1-e/255))},ws=function(t,e){return 255*(1-(1-e/255)/(t/255))},Es=function(t,e){return 255===t||(t=e/255*255/(1-t/255))>255?255:t};ds.normal=ps(vs(ys)),ds.multiply=ps(vs(ms)),ds.screen=ps(vs(_s)),ds.overlay=ps(vs(bs)),ds.darken=ps(vs(gs)),ds.lighten=ps(vs(xs)),ds.dodge=ps(vs(Es)),ds.burn=ps(vs(ws));for(var Ts=ds,ks=d.type,As=d.clip_rgb,Rs=d.TWOPI,Ss=Math.pow,Is=Math.sin,Ps=Math.cos,Ms=w,Cs=function(t,e,n,r,i){void 0===t&&(t=300),void 0===e&&(e=-1.5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=[0,1]);var s,a=0;"array"===ks(i)?s=i[1]-i[0]:(s=0,i=[i,i]);var o=function(o){var u=Rs*((t+120)/360+e*o),h=Ss(i[0]+s*o,r),l=(0!==a?n[0]+o*a:n)*h*(1-h)/2,c=Ps(u),f=Is(u);return Ms(As([255*(h+l*(-.14861*c+1.78277*f)),255*(h+l*(-.29227*c-.90649*f)),255*(h+l*(1.97294*c)),1]))};return o.start=function(e){return null==e?t:(t=e,o)},o.rotations=function(t){return null==t?e:(e=t,o)},o.gamma=function(t){return null==t?r:(r=t,o)},o.hue=function(t){return null==t?n:("array"===ks(n=t)?0==(a=n[1]-n[0])&&(n=n[1]):a=0,o)},o.lightness=function(t){return null==t?i:("array"===ks(t)?(i=t,s=t[1]-t[0]):(i=[t,t],s=0),o)},o.scale=function(){return Ms.scale(o)},o.hue(n),o},Os=_,Ds="0123456789abcdef",Bs=Math.floor,Ns=Math.random,Ls=function(){for(var t="#",e=0;e<6;e++)t+=Ds.charAt(Bs(16*Ns()));return new Os(t,"hex")},Zs=o,Fs=Math.log,Us=Math.pow,Gs=Math.floor,Hs=Math.abs,Xs=function(t,e){void 0===e&&(e=null);var n={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===Zs(t)&&(t=Object.values(t)),t.forEach((function(t){e&&"object"===Zs(t)&&(t=t[e]),null==t||isNaN(t)||(n.values.push(t),n.sum+=t,t<n.min&&(n.min=t),t>n.max&&(n.max=t),n.count+=1)})),n.domain=[n.min,n.max],n.limits=function(t,e){return Ws(n,t,e)},n},Ws=function(t,e,n){void 0===e&&(e="equal"),void 0===n&&(n=7),"array"==Zs(t)&&(t=Xs(t));var r=t.min,i=t.max,s=t.values.sort((function(t,e){return t-e}));if(1===n)return[r,i];var a=[];if("c"===e.substr(0,1)&&(a.push(r),a.push(i)),"e"===e.substr(0,1)){a.push(r);for(var o=1;o<n;o++)a.push(r+o/n*(i-r));a.push(i)}else if("l"===e.substr(0,1)){if(r<=0)throw new Error("Logarithmic scales are only possible for values > 0");var u=Math.LOG10E*Fs(r),h=Math.LOG10E*Fs(i);a.push(r);for(var l=1;l<n;l++)a.push(Us(10,u+l/n*(h-u)));a.push(i)}else if("q"===e.substr(0,1)){a.push(r);for(var c=1;c<n;c++){var f=(s.length-1)*c/n,d=Gs(f);if(d===f)a.push(s[d]);else{var p=f-d;a.push(s[d]*(1-p)+s[d+1]*p)}}a.push(i)}else if("k"===e.substr(0,1)){var v,y=s.length,m=new Array(y),g=new Array(n),x=!0,_=0,b=null;(b=[]).push(r);for(var w=1;w<n;w++)b.push(r+w/n*(i-r));for(b.push(i);x;){for(var E=0;E<n;E++)g[E]=0;for(var T=0;T<y;T++)for(var k=s[T],A=Number.MAX_VALUE,R=void 0,S=0;S<n;S++){var I=Hs(b[S]-k);I<A&&(A=I,R=S),g[R]++,m[T]=R}for(var P=new Array(n),M=0;M<n;M++)P[M]=null;for(var C=0;C<y;C++)null===P[v=m[C]]?P[v]=s[C]:P[v]+=s[C];for(var O=0;O<n;O++)P[O]*=1/g[O];x=!1;for(var D=0;D<n;D++)if(P[D]!==b[D]){x=!0;break}b=P,++_>200&&(x=!1)}for(var B={},N=0;N<n;N++)B[N]=[];for(var L=0;L<y;L++)B[v=m[L]].push(s[L]);for(var Z=[],F=0;F<n;F++)Z.push(B[F][0]),Z.push(B[F][B[F].length-1]);Z=Z.sort((function(t,e){return t-e})),a.push(Z[0]);for(var U=1;U<Z.length;U+=2){var G=Z[U];isNaN(G)||-1!==a.indexOf(G)||a.push(G)}}return a},js={analyze:Xs,limits:Ws},zs=_,Vs=function(t,e){t=new zs(t),e=new zs(e);var n=t.luminance(),r=e.luminance();return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)},Ys=_,Ks=Math.sqrt,qs=Math.pow,$s=Math.min,Qs=Math.max,Js=Math.atan2,ta=Math.abs,ea=Math.cos,na=Math.sin,ra=Math.exp,ia=Math.PI,sa=function(t,e,n,r,i){void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1);var s=function(t){return 360*t/(2*ia)},a=function(t){return 2*ia*t/360};t=new Ys(t),e=new Ys(e);var o=Array.from(t.lab()),u=o[0],h=o[1],l=o[2],c=Array.from(e.lab()),f=c[0],d=c[1],p=c[2],v=(u+f)/2,y=(Ks(qs(h,2)+qs(l,2))+Ks(qs(d,2)+qs(p,2)))/2,m=.5*(1-Ks(qs(y,7)/(qs(y,7)+qs(25,7)))),g=h*(1+m),x=d*(1+m),_=Ks(qs(g,2)+qs(l,2)),b=Ks(qs(x,2)+qs(p,2)),w=(_+b)/2,E=s(Js(l,g)),T=s(Js(p,x)),k=E>=0?E:E+360,A=T>=0?T:T+360,R=ta(k-A)>180?(k+A+360)/2:(k+A)/2,S=1-.17*ea(a(R-30))+.24*ea(a(2*R))+.32*ea(a(3*R+6))-.2*ea(a(4*R-63)),I=A-k;I=ta(I)<=180?I:A<=k?I+360:I-360,I=2*Ks(_*b)*na(a(I)/2);var P=f-u,M=b-_,C=1+.015*qs(v-50,2)/Ks(20+qs(v-50,2)),O=1+.045*w,D=1+.015*w*S,B=30*ra(-qs((R-275)/25,2)),N=-2*Ks(qs(w,7)/(qs(w,7)+qs(25,7)))*na(2*a(B)),L=Ks(qs(P/(n*C),2)+qs(M/(r*O),2)+qs(I/(i*D),2)+N*(M/(r*O))*(I/(i*D)));return Qs(0,$s(100,L))},aa=_,oa=function(t,e,n){void 0===n&&(n="lab"),t=new aa(t),e=new aa(e);var r=t.get(n),i=e.get(n),s=0;for(var a in r){var o=(r[a]||0)-(i[a]||0);s+=o*o}return Math.sqrt(s)},ua=_,ha=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];try{return new(Function.prototype.bind.apply(ua,[null].concat(t))),!0}catch(n){return!1}},la=w,ca=ss,fa={cool:function(){return ca([la.hsl(180,1,.9),la.hsl(250,.7,.4)])},hot:function(){return ca(["#000","#f00","#ff0","#fff"]).mode("rgb")}},da={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},pa=0,va=Object.keys(da);pa<va.length;pa+=1){var ya=va[pa];da[ya.toLowerCase()]=da[ya]}var ma=da,ga=w;return ga.average=ts,ga.bezier=cs,ga.blend=Ts,ga.cubehelix=Cs,ga.mix=ga.interpolate=fi,ga.random=Ls,ga.scale=ss,ga.analyze=js.analyze,ga.contrast=Vs,ga.deltaE=sa,ga.distance=oa,ga.limits=js.limits,ga.valid=ha,ga.scales=fa,ga.colors=Ln,ga.brewer=ma,ga}()},7478:function(t){"use strict";function e(t,e,r){r=r||2;var s,a,o,u,c,f,p,v=e&&e.length,y=v?e[0]*r:t.length,m=n(t,0,y,r,!0),g=[];if(!m||m.next===m.prev)return g;if(v&&(m=function(t,e,r,i){var s,a,o,u=[];for(s=0,a=e.length;s<a;s++)(o=n(t,e[s]*i,s<a-1?e[s+1]*i:t.length,i,!1))===o.next&&(o.steiner=!0),u.push(d(o));for(u.sort(h),s=0;s<u.length;s++)r=l(u[s],r);return r}(t,e,m,r)),t.length>80*r){s=o=t[0],a=u=t[1];for(var x=r;x<y;x+=r)(c=t[x])<s&&(s=c),(f=t[x+1])<a&&(a=f),c>o&&(o=c),f>u&&(u=f);p=0!==(p=Math.max(o-s,u-a))?32767/p:0}return i(m,g,r,s,a,p,0),g}function n(t,e,n,r,i){var s,a;if(i===A(t,e,n,r)>0)for(s=e;s<n;s+=r)a=E(s,t[s],t[s+1],a);else for(s=n-r;s>=e;s-=r)a=E(s,t[s],t[s+1],a);return a&&m(a,a.next)&&(T(a),a=a.next),a}function r(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==y(r.prev,r,r.next))r=r.next;else{if(T(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,h,l,c,d){if(t){!d&&c&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=f(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,s,a,o,u,h=1;do{for(n=t,t=null,s=null,a=0;n;){for(a++,r=n,o=0,e=0;e<h&&(o++,r=r.nextZ);e++);for(u=h;o>0||u>0&&r;)0!==o&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,u--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,h*=2}while(a>1)}(i)}(t,h,l,c);for(var p,v,y=t;t.prev!==t.next;)if(p=t.prev,v=t.next,c?a(t,h,l,c):s(t))e.push(p.i/n|0),e.push(t.i/n|0),e.push(v.i/n|0),T(t),t=v.next,y=v.next;else if((t=v)===y){d?1===d?i(t=o(r(t),e,n),e,n,h,l,c,2):2===d&&u(t,e,n,h,l,c):i(r(t),e,n,h,l,c,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(y(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,a=r.x,o=e.y,u=n.y,h=r.y,l=i<s?i<a?i:a:s<a?s:a,c=o<u?o<h?o:h:u<h?u:h,f=i>s?i>a?i:a:s>a?s:a,d=o>u?o>h?o:h:u>h?u:h,v=r.next;v!==e;){if(v.x>=l&&v.x<=f&&v.y>=c&&v.y<=d&&p(i,o,s,u,a,h,v.x,v.y)&&y(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function a(t,e,n,r){var i=t.prev,s=t,a=t.next;if(y(i,s,a)>=0)return!1;for(var o=i.x,u=s.x,h=a.x,l=i.y,c=s.y,d=a.y,v=o<u?o<h?o:h:u<h?u:h,m=l<c?l<d?l:d:c<d?c:d,g=o>u?o>h?o:h:u>h?u:h,x=l>c?l>d?l:d:c>d?c:d,_=f(v,m,e,n,r),b=f(g,x,e,n,r),w=t.prevZ,E=t.nextZ;w&&w.z>=_&&E&&E.z<=b;){if(w.x>=v&&w.x<=g&&w.y>=m&&w.y<=x&&w!==i&&w!==a&&p(o,l,u,c,h,d,w.x,w.y)&&y(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,E.x>=v&&E.x<=g&&E.y>=m&&E.y<=x&&E!==i&&E!==a&&p(o,l,u,c,h,d,E.x,E.y)&&y(E.prev,E,E.next)>=0)return!1;E=E.nextZ}for(;w&&w.z>=_;){if(w.x>=v&&w.x<=g&&w.y>=m&&w.y<=x&&w!==i&&w!==a&&p(o,l,u,c,h,d,w.x,w.y)&&y(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;E&&E.z<=b;){if(E.x>=v&&E.x<=g&&E.y>=m&&E.y<=x&&E!==i&&E!==a&&p(o,l,u,c,h,d,E.x,E.y)&&y(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function o(t,e,n){var i=t;do{var s=i.prev,a=i.next.next;!m(s,a)&&g(s,i,i.next,a)&&b(s,a)&&b(a,s)&&(e.push(s.i/n|0),e.push(i.i/n|0),e.push(a.i/n|0),T(i),T(i.next),i=t=a),i=i.next}while(i!==t);return r(i)}function u(t,e,n,s,a,o){var u=t;do{for(var h=u.next.next;h!==u.prev;){if(u.i!==h.i&&v(u,h)){var l=w(u,h);return u=r(u,u.next),l=r(l,l.next),i(u,e,n,s,a,o,0),void i(l,e,n,s,a,o,0)}h=h.next}u=u.next}while(u!==t)}function h(t,e){return t.x-e.x}function l(t,e){var n=function(t,e){var n,r=e,i=t.x,s=t.y,a=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var o=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=i&&o>a&&(a=o,n=r.x<r.next.x?r:r.next,o===i))return n}r=r.next}while(r!==e);if(!n)return null;var u,h=n,l=n.x,f=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&p(s<f?i:a,s,l,f,s<f?a:i,s,r.x,r.y)&&(u=Math.abs(s-r.y)/(i-r.x),b(r,t)&&(u<d||u===d&&(r.x>n.x||r.x===n.x&&c(n,r)))&&(n=r,d=u)),r=r.next}while(r!==h);return n}(t,e);if(!n)return e;var i=w(n,t);return r(i,i.next),r(n,n.next)}function c(t,e){return y(t.prev,t,e.prev)<0&&y(e.next,t,t.next)<0}function f(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,r,i,s,a,o){return(i-a)*(e-o)>=(t-a)*(s-o)&&(t-a)*(r-o)>=(n-a)*(e-o)&&(n-a)*(s-o)>=(i-a)*(r-o)}function v(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&g(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(b(t,e)&&b(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(y(t.prev,t,e.prev)||y(t,e.prev,e))||m(t,e)&&y(t.prev,t,t.next)>0&&y(e.prev,e,e.next)>0)}function y(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function m(t,e){return t.x===e.x&&t.y===e.y}function g(t,e,n,r){var i=_(y(t,e,n)),s=_(y(t,e,r)),a=_(y(n,r,t)),o=_(y(n,r,e));return i!==s&&a!==o||(!(0!==i||!x(t,n,e))||(!(0!==s||!x(t,r,e))||(!(0!==a||!x(n,t,r))||!(0!==o||!x(n,e,r)))))}function x(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function _(t){return t>0?1:t<0?-1:0}function b(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function w(t,e){var n=new k(t.i,t.x,t.y),r=new k(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function E(t,e,n,r){var i=new k(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function T(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function k(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(t,e,n,r){for(var i=0,s=e,a=n-r;s<n;s+=r)i+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return i}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,a=Math.abs(A(t,0,s,n));if(i)for(var o=0,u=e.length;o<u;o++){var h=e[o]*n,l=o<u-1?e[o+1]*n:t.length;a-=Math.abs(A(t,h,l,n))}var c=0;for(o=0;o<r.length;o+=3){var f=r[o]*n,d=r[o+1]*n,p=r[o+2]*n;c+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var a=0;a<e;a++)n.vertices.push(t[i][s][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},2221:function(t){t.exports=function(t){var e=Math.cos(t*Math.PI*.5);return Math.abs(e)<1e-14?1:1-e}},5839:function(t){t.exports=function(t){return Math.sin(t*Math.PI/2)}},5556:function(t){"use strict";var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,r,s,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new i(r,s||t,a),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],o]:t._events[u].push(o):(t._events[u]=o,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),o.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},o.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,a=new Array(s);i<s;i++)a[i]=r[i].fn;return a},o.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},o.prototype.emit=function(t,e,r,i,s,a){var o=n?n+t:t;if(!this._events[o])return!1;var u,h,l=this._events[o],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,i),!0;case 5:return l.fn.call(l.context,e,r,i,s),!0;case 6:return l.fn.call(l.context,e,r,i,s,a),!0}for(h=1,u=new Array(c-1);h<c;h++)u[h-1]=arguments[h];l.fn.apply(l.context,u)}else{var f,d=l.length;for(h=0;h<d;h++)switch(l[h].once&&this.removeListener(t,l[h].fn,void 0,!0),c){case 1:l[h].fn.call(l[h].context);break;case 2:l[h].fn.call(l[h].context,e);break;case 3:l[h].fn.call(l[h].context,e,r);break;case 4:l[h].fn.call(l[h].context,e,r,i);break;default:if(!u)for(f=1,u=new Array(c-1);f<c;f++)u[f-1]=arguments[f];l[h].fn.apply(l[h].context,u)}}return!0},o.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},o.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},o.prototype.removeListener=function(t,e,r,i){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||i&&!o.once||r&&o.context!==r||a(this,s);else{for(var u=0,h=[],l=o.length;u<l;u++)(o[u].fn!==e||i&&!o[u].once||r&&o[u].context!==r)&&h.push(o[u]);h.length?this._events[s]=1===h.length?h[0]:h:a(this,s)}return this},o.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o},1381:function(t,e,n){"use strict";n.d(e,{MxU:function(){return Y},T$b:function(){return u.T$},Xz2:function(){return oi},W20:function(){return A.W2},TCu:function(){return Mn},ZTM:function(){return Yn},AB0:function(){return u.AB},TYe:function(){return qn},E9j:function(){return u.E9},jyi:function(){return P},xvT:function(){return fr},oO3:function(){return Br},P6Y:function(){return u.P6}});var r=n(5671),i=n(3144),s=n(136),a=n(2963),o=n(1120),u=n(4662),h="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n";function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}u.wn;function c(t,e){var n,r=Math.ceil(t/2),i="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";n=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var a=0;a<t;a++){var o=n.replace("%index%",a.toString());s+=o=o.replace("%sampleIndex%","".concat(a-(r-1),".0")),s+="\n"}return i=(i=i.replace("%blur%",s)).replace("%size%",t.toString())}var f={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},d=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");function p(t){for(var e,n=f[t],r=n.length,i=d,s="",a=0;a<t;a++){var o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",a.toString());e=a,a>=r&&(e=t-a-1),s+=o=o.replace("%value%",n[e].toString()),s+="\n"}return i=(i=i.replace("%blur%",s)).replace("%size%",t.toString())}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var y=function(t){(0,s.Z)(n,t);var e=v(n);function n(t){var i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.Xd.FILTER_RESOLUTION,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5;(0,r.Z)(this,n);var l=c(h,t),f=p(h);return(i=e.call(this,l,f)).horizontal=t,i.resolution=o,i._quality=0,i.quality=a,i.blur=s,i}return(0,i.Z)(n,[{key:"apply",value:function(t,e,n,r){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,r);else{var i=t.getFilterTexture(),s=t.renderer,a=e,o=i;this.state.blend=!1,t.applyFilter(this,a,o,u.yl.CLEAR);for(var h=1;h<this.passes-1;h++){t.bindAndClear(a,u.yl.BLIT),this.uniforms.uSampler=o;var l=o;o=a,a=l,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,o,n,r),t.returnFilterTexture(i)}}},{key:"blur",get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t}},{key:"quality",get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t}}]),n}(u.wn);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}u.wn;function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var x=function(t){(0,s.Z)(n,t);var e=g(n);function n(){var t;(0,r.Z)(this,n);var i={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(t=e.call(this,u.Y9,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",i)).alpha=1,t}return(0,i.Z)(n,[{key:"_loadMatrix",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n}},{key:"_multiply",value:function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t}},{key:"_colorMatrix",value:function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}},{key:"brightness",value:function(t,e){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}},{key:"tint",value:function(t,e){var n=[(t>>16&255)/255,0,0,0,0,0,(t>>8&255)/255,0,0,0,0,0,(255&t)/255,0,0,0,0,0,1,0];this._loadMatrix(n,e)}},{key:"greyscale",value:function(t,e){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}},{key:"blackAndWhite",value:function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)}},{key:"hue",value:function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),r=Math.sin(t),i=1/3,s=(0,Math.sqrt)(i),a=[n+(1-n)*i,i*(1-n)-s*r,i*(1-n)+s*r,0,0,i*(1-n)+s*r,n+i*(1-n),i*(1-n)-s*r,0,0,i*(1-n)-s*r,i*(1-n)+s*r,n+i*(1-n),0,0,0,0,0,1,0];this._loadMatrix(a,e)}},{key:"contrast",value:function(t,e){var n=(t||0)+1,r=-.5*(n-1),i=[n,0,0,0,r,0,n,0,0,r,0,0,n,0,r,0,0,0,1,0];this._loadMatrix(i,e)}},{key:"saturate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,n=2*t/3+1,r=-.5*(n-1),i=[n,r,r,0,0,r,n,r,0,0,r,r,n,0,0,0,0,0,1,0];this._loadMatrix(i,e)}},{key:"desaturate",value:function(){this.saturate(-1)}},{key:"negative",value:function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)}},{key:"sepia",value:function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)}},{key:"technicolor",value:function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)}},{key:"polaroid",value:function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)}},{key:"toBGR",value:function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)}},{key:"kodachrome",value:function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)}},{key:"browni",value:function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)}},{key:"vintage",value:function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)}},{key:"colorTone",value:function(t,e,n,r,i){var s=((n=n||16770432)>>16&255)/255,a=(n>>8&255)/255,o=(255&n)/255,u=((r=r||3375104)>>16&255)/255,h=(r>>8&255)/255,l=(255&r)/255,c=[.3,.59,.11,0,0,s,a,o,t=t||.2,0,u,h,l,e=e||.15,0,s-u,a-h,o-l,0,0];this._loadMatrix(c,i)}},{key:"night",value:function(t,e){var n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}},{key:"predator",value:function(t,e){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)}},{key:"lsd",value:function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)}},{key:"reset",value:function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}},{key:"matrix",get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t}},{key:"alpha",get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t}}]),n}(u.wn);x.prototype.grayscale=x.prototype.greyscale;function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}u.wn;function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}u.wn;var w="precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n";function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}u.wn;var T=n(7326),k=n(1752),A=n(6260);function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var S=new u.E9,I=new Uint16Array([0,1,2,0,2,3]),P=function(t){(0,s.Z)(n,t);var e=R(n);function n(t){var i;return(0,r.Z)(this,n),(i=e.call(this))._anchor=new u.AB(i._onAnchorUpdate,(0,T.Z)(i),t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),i._texture=null,i._width=0,i._height=0,i._tint=null,i._tintRGB=null,i.tint=16777215,i.blendMode=u.T$.NORMAL,i._cachedTint=16777215,i.uvs=null,i.texture=t||u.xE.EMPTY,i.vertexData=new Float32Array(8),i.vertexTrimmedData=null,i._transformID=-1,i._textureID=-1,i._transformTrimmedID=-1,i._textureTrimmedID=-1,i.indices=I,i.pluginName="batch",i.isSprite=!0,i._roundPixels=u.Xd.ROUND_PIXELS,i}return(0,i.Z)(n,[{key:"_onTextureUpdate",value:function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=u.P6.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=u.P6.sign(this.scale.y)*this._height/this._texture.orig.height)}},{key:"_onAnchorUpdate",value:function(){this._transformID=-1,this._transformTrimmedID=-1}},{key:"calculateVertices",value:function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,s=e.d,a=e.tx,o=e.ty,h=this.vertexData,l=t.trim,c=t.orig,f=this._anchor,d=0,p=0,v=0,y=0;if(l?(d=(p=l.x-f._x*c.width)+l.width,v=(y=l.y-f._y*c.height)+l.height):(d=(p=-f._x*c.width)+c.width,v=(y=-f._y*c.height)+c.height),h[0]=n*p+i*y+a,h[1]=s*y+r*p+o,h[2]=n*d+i*y+a,h[3]=s*y+r*d+o,h[4]=n*d+i*v+a,h[5]=s*v+r*d+o,h[6]=n*p+i*v+a,h[7]=s*v+r*p+o,this._roundPixels)for(var m=u.Xd.RESOLUTION,g=0;g<h.length;++g)h[g]=Math.round(h[g]*m)/m}}},{key:"calculateTrimmedVertices",value:function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,n=t.orig,r=this._anchor,i=this.transform.worldTransform,s=i.a,a=i.b,o=i.c,u=i.d,h=i.tx,l=i.ty,c=-r._x*n.width,f=c+n.width,d=-r._y*n.height,p=d+n.height;e[0]=s*c+o*d+h,e[1]=u*d+a*c+l,e[2]=s*f+o*d+h,e[3]=u*d+a*f+l,e[4]=s*f+o*p+h,e[5]=u*p+a*f+l,e[6]=s*c+o*p+h,e[7]=u*p+a*c+l}},{key:"_render",value:function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}},{key:"_calculateBounds",value:function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}},{key:"getLocalBounds",value:function(t){return 0===this.children.length?(this._localBounds||(this._localBounds=new A.YZ),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new u.Ae),t=this._localBoundsRect),this._localBounds.getRectangle(t)):(0,k.Z)((0,o.Z)(n.prototype),"getLocalBounds",this).call(this,t)}},{key:"containsPoint",value:function(t){this.worldTransform.applyInverse(t,S);var e=this._texture.orig.width,n=this._texture.orig.height,r=-e*this.anchor.x,i=0;return S.x>=r&&S.x<r+e&&(i=-n*this.anchor.y,S.y>=i&&S.y<i+n)}},{key:"destroy",value:function(t){if((0,k.Z)((0,o.Z)(n.prototype),"destroy",this).call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:null==t?void 0:t.texture){var e="boolean"==typeof t?t:null==t?void 0:t.baseTexture;this._texture.destroy(!!e)}this._texture=null}},{key:"roundPixels",get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}},{key:"width",get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=u.P6.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=u.P6.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"anchor",get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||u.xE.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}],[{key:"from",value:function(t,e){return new n(t instanceof u.xE?t:u.xE.from(t,e))}}]),n}(A.W2),M=new u.y3;A.s$.prototype._cacheAsBitmap=!1,A.s$.prototype._cacheData=null,A.s$.prototype._cacheAsBitmapResolution=null,A.s$.prototype._cacheAsBitmapMultisample=null;var C=(0,i.Z)((function t(){(0,r.Z)(this,t),this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}));Object.defineProperties(A.s$.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new C),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),A.s$.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},A.s$.prototype._initCachedDisplayObject=function(t){var e,n,r;if(null===(e=this._cacheData)||void 0===e||!e.sprite){var i=this.alpha;this.alpha=1,t.batch.flush();var s=this.getLocalBounds(null,!0).clone();if(null!==(n=this.filters)&&void 0!==n&&n.length){var a=this.filters[0].padding;s.pad(a)}s.ceil(u.Xd.RESOLUTION);var o=t.renderTexture.current,h=t.renderTexture.sourceFrame.clone(),l=t.renderTexture.destinationFrame.clone(),c=t.projection.transform,f=u.TI.create({width:s.width,height:s.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:null!==(r=this.cacheAsBitmapMultisample)&&void 0!==r?r:t.multisample}),d="cacheAsBitmap_".concat(u.P6.uid());this._cacheData.textureCacheId=d,u.VL.addToCache(f.baseTexture,d),u.xE.addToCache(f,d);var p=this.transform.localTransform.copyTo(M).invert().translate(-s.x,-s.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:f,clear:!0,transform:p,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=c,t.renderTexture.bind(o,h,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=i;var v=new P(f);v.transform.worldTransform=this.transform.worldTransform,v.anchor.x=-s.x/s.width,v.anchor.y=-s.y/s.height,v.alpha=i,v._bounds=this._bounds,this._cacheData.sprite=v,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=v.containsPoint.bind(v)}},A.s$.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},A.s$.prototype._initCachedDisplayObjectCanvas=function(t){var e;if(null===(e=this._cacheData)||void 0===e||!e.sprite){var n=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;var i=t.canvasContext.activeContext,s=t._projTransform;n.ceil(u.Xd.RESOLUTION);var a=u.TI.create({width:n.width,height:n.height}),o="cacheAsBitmap_".concat(u.P6.uid());this._cacheData.textureCacheId=o,u.VL.addToCache(a.baseTexture,o),u.xE.addToCache(a,o);var h=M;this.transform.localTransform.copyTo(h),h.invert(),h.tx-=n.x,h.ty-=n.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:h,skipUpdateTransform:!1}),t.canvasContext.activeContext=i,t._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;var l=new P(a);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-n.x/n.width,l.anchor.y=-n.y/n.height,l.alpha=r,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},A.s$.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},A.s$.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},A.s$.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,u.VL.removeFromCache(this._cacheData.textureCacheId),u.xE.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},A.s$.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},A.s$.prototype.name=null,A.W2.prototype.getChildByName=function(t,e){for(var n=0,r=this.children.length;n<r;n++)if(this.children[n].name===t)return this.children[n];if(e)for(var i=0,s=this.children.length;i<s;i++){var a=this.children[i];if(a.getChildByName){var o=a.getChildByName(t,!0);if(o)return o}}return null},A.s$.prototype.getGlobalPosition=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new u.E9,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};n(5743);var O=function(){function t(e){(0,r.Z)(this,t),this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=t.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new u.E9,this.page=new u.E9,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=e}return(0,i.Z)(t,[{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"data",get:function(){return this}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"initEvent",value:function(t,e,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}},{key:"initUIEvent",value:function(t,e,n,r,i){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),t}();function D(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var B=function(t){(0,s.Z)(n,t);var e=D(n);function n(){var t;return(0,r.Z)(this,n),(t=e.apply(this,arguments)).client=new u.E9,t.movement=new u.E9,t.offset=new u.E9,t.global=new u.E9,t.screen=new u.E9,t}return(0,i.Z)(n,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"x",get:function(){return this.clientX}},{key:"y",get:function(){return this.clientY}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(t,e,n,r,i,s,a,o,u,h,l,c,f,d,p){throw new Error("Method not implemented.")}}]),n}(O);function N(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var L=function(t){(0,s.Z)(n,t);var e=N(n);function n(){var t;return(0,r.Z)(this,n),(t=e.apply(this,arguments)).width=0,t.height=0,t.isPrimary=!1,t}return(0,i.Z)(n,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}}]),n}(B);function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var F=function(t){(0,s.Z)(n,t);var e=Z(n);function n(){var t;return(0,r.Z)(this,n),(t=e.apply(this,arguments)).DOM_DELTA_LINE=0,t.DOM_DELTA_PAGE=1,t.DOM_DELTA_PIXEL=2,t}return(0,i.Z)(n)}(B),U=new u.E9,G=new u.E9,H=function(){function t(e){(0,r.Z)(this,t),this.dispatch=new u.P6.EventEmitter,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}return(0,i.Z)(t,[{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))}},{key:"dispatchEvent",value:function(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventBoundary]: Event mapping not defined for ".concat(t.type))}}},{key:"hitTest",value:function(t,e){var n=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,U.set(t,e),this.hitTestFn,this.hitPruneFn);return n&&n[0]}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=0,i=n.length-1;r<i;r++)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(var s=n.length-2;s>=0;s--)if(t.currentTarget=n[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"all",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rootTarget;t.eventPhase=t.BUBBLING_PHASE;var r=n.children;if(r)for(var i=0;i<r.length;i++)this.all(t,e,r[i]);t.currentTarget=n,this.notifyTarget(t,e)}},{key:"propagationPath",value:function(t){for(var e=[t],n=0;n<2048&&t!==this.rootTarget;n++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}},{key:"hitTestRecursive",value:function(t,e,n,r,i){if(!t||!t.visible)return null;if(i(t,n))return null;if(t.interactiveChildren&&t.children)for(var s=t.children,a=s.length-1;a>=0;a--){var o=s[a],u=this.hitTestRecursive(o,e||o.interactive,n,r,i);if(u){if(u.length>0&&!u[u.length-1].parent)continue;return(u.length>0||t.interactive)&&u.push(t),u}}return e&&r(t,n)?t.interactive?[t]:[]:null}},{key:"hitPruneFn",value:function(t,e){if(t.hitArea&&(t.worldTransform.applyInverse(e,G),!t.hitArea.contains(G.x,G.y)))return!0;if(t._mask){var n,r=t._mask.isMaskData?t._mask.maskObject:t._mask;if(r&&(null===(n=r.containsPoint)||void 0===n||!n.call(r,e)))return!0}return!1}},{key:"hitTestFn",value:function(t,e){return!!t.hitArea||!!t.containsPoint&&t.containsPoint(e)}},{key:"notifyTarget",value:function(t,e){var n;e=null!==(n=e)&&void 0!==n?n:t.type;var r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}},{key:"mapPointerDown",value:function(t){if(t instanceof L){var e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)this.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;this.dispatchEvent(e,n?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerMove",value:function(t){if(t instanceof L){var e=this.createPointerEvent(t),n="mouse"===e.pointerType||"pen"===e.pointerType,r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.overTargets);if(r.overTargets&&i!==e.target){var s="mousemove"===t.type?"mouseout":"pointerout",a=this.createPointerEvent(t,s,i);if(this.dispatchEvent(a,"pointerout"),n&&this.dispatchEvent(a,"mouseout"),!e.composedPath().includes(i)){var o=this.createPointerEvent(t,"pointerleave",i);for(o.eventPhase=o.AT_TARGET;o.target&&!e.composedPath().includes(o.target);)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;this.freeEvent(o)}this.freeEvent(a)}if(i!==e.target){var u="mousemove"===t.type?"mouseover":"pointerover",h=this.clonePointerEvent(e,u);this.dispatchEvent(h,"pointerover"),n&&this.dispatchEvent(h,"mouseover");for(var l=null==i?void 0:i.parent;l&&l!==this.rootTarget.parent&&l!==e.target;)l=l.parent;if(!l||l===this.rootTarget.parent){var c=this.clonePointerEvent(e,"pointerenter");for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==i&&c.target!==this.rootTarget.parent;)c.currentTarget=c.target,this.notifyTarget(c),n&&this.notifyTarget(c,"mouseenter"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(h)}var f,d=this.moveOnAll?"all":"dispatchEvent";if(this[d](e,"pointermove"),"touch"===e.pointerType&&this[d](e,"touchmove"),n)this[d](e,"mousemove"),this.cursor=null===(f=e.target)||void 0===f?void 0:f.cursor;r.overTargets=e.composedPath(),this.freeEvent(e)}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerOver",value:function(t){var e;if(t instanceof L){var n=this.trackingData(t.pointerId),r=this.createPointerEvent(t),i="mouse"===r.pointerType||"pen"===r.pointerType;this.dispatchEvent(r,"pointerover"),i&&this.dispatchEvent(r,"mouseover"),"mouse"===r.pointerType&&(this.cursor=null===(e=r.target)||void 0===e?void 0:e.cursor);var s=this.clonePointerEvent(r,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;n.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(s)}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerOut",value:function(t){if(t instanceof L){var e=this.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,r=this.findMountedTarget(e.overTargets),i=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(i),n&&this.dispatchEvent(i,"mouseout");var s=this.createPointerEvent(t,"pointerleave",r);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;e.overTargets=null,this.freeEvent(i),this.freeEvent(s)}this.cursor=null}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerUp",value:function(t){if(t instanceof L){var e=performance.now(),n=this.createPointerEvent(t);if(this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)this.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var r=2===n.button;this.dispatchEvent(n,r?"rightup":"mouseup")}var i=this.trackingData(t.pointerId),s=this.findMountedTarget(i.pressTargetsByButton[t.button]),a=s;if(s&&!n.composedPath().includes(s)){for(var o=s;o&&!n.composedPath().includes(o);){if(n.currentTarget=o,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)this.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var u=2===n.button;this.notifyTarget(n,u?"rightupoutside":"mouseupoutside")}o=o.parent}delete i.pressTargetsByButton[t.button],a=o}if(a){var h=this.clonePointerEvent(n,"click");h.target=a,h.path=null,i.clicksByButton[t.button]||(i.clicksByButton[t.button]={clickCount:0,target:h.target,timeStamp:e});var l=i.clicksByButton[t.button];l.target===h.target&&e-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=h.target,l.timeStamp=e,h.detail=l.clickCount,"mouse"===h.pointerType?this.dispatchEvent(h,"click"):"touch"===h.pointerType&&this.dispatchEvent(h,"tap"),this.dispatchEvent(h,"pointertap"),this.freeEvent(h)}this.freeEvent(n)}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapPointerUpOutside",value:function(t){if(t instanceof L){var e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(n){for(var i=n;i;)r.currentTarget=i,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType?this.notifyTarget(r,"touchendoutside"):"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),i=i.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(r)}else console.warn("EventBoundary cannot map a non-pointer event as a pointer event")}},{key:"mapWheel",value:function(t){if(t instanceof F){var e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}else console.warn("EventBoundary cannot map a non-wheel event as a wheel event")}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[0],n=1;n<t.length&&t[n].parent===e;n++)e=t[n];return e}},{key:"createPointerEvent",value:function(t,e,n){var r=this.allocateEvent(L);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=null!=n?n:this.hitTest(r.global.x,r.global.y),"string"==typeof e&&(r.type=e),r}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(F);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(L);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyPointerData",value:function(t,e){t instanceof L&&e instanceof L&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}},{key:"copyMouseData",value:function(t,e){t instanceof B&&e instanceof B&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global))}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget._events[e];if(n)if("fn"in n)n.fn.call(n.context,t);else for(var r=0,i=n.length;r<i&&!t.propagationImmediatelyStopped;r++)n[r].fn.call(n[r].context,t)}}]),t}(),X={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},W=function(){function t(e){(0,r.Z)(this,t),this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new H(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new L(null),this.rootWheelEvent=new F(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}return(0,i.Z)(t,[{key:"init",value:function(){var t=this.renderer,e=t.view,n=t.resolution;this.setTargetElement(e),this.resolution=n}},{key:"destroy",value:function(){this.setTargetElement(null),this.renderer=null}},{key:"setCursor",value:function(t){t=t||"default";var e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor!==t){this.currentCursor=t;var n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.domElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.domElement.style,n)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}}},{key:"onPointerDown",value:function(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=0,r=e.length;n<r;n++){var i=e[n],s=this.bootstrapEvent(this.rootPointerEvent,i);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}}},{key:"onPointerMove",value:function(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,!this.supportsTouchEvents||"touch"!==t.pointerType){for(var e=this.normalizeToPointerData(t),n=0,r=e.length;n<r;n++){var i=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}}},{key:"onPointerUp",value:function(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,!this.supportsTouchEvents||"touch"!==t.pointerType){var e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);for(var n=e!==this.domElement?"outside":"",r=this.normalizeToPointerData(t),i=0,s=r.length;i<s;i++){var a=this.bootstrapEvent(this.rootPointerEvent,r[i]);a.type+=n,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}}},{key:"onPointerOverOut",value:function(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,!this.supportsTouchEvents||"touch"!==t.pointerType){for(var e=this.normalizeToPointerData(t),n=0,r=e.length;n<r;n++){var i=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}}},{key:"onWheel",value:function(t){var e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}},{key:"setTargetElement",value:function(t){this.removeEvents(),this.domElement=t,this.addEvents()}},{key:"addEvents",value:function(){if(!this.eventsAdded&&this.domElement){var t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}}},{key:"removeEvents",value:function(){if(this.eventsAdded&&this.domElement){var t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}}},{key:"mapPositionToPoint",value:function(t,e,n){var r;r=this.domElement.parentElement?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};var i=1/this.resolution;t.x=(e-r.left)*(this.domElement.width/r.width)*i,t.y=(n-r.top)*(this.domElement.height/r.height)*i}},{key:"normalizeToPointerData",value:function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var n=0,r=t.changedTouches.length;n<r;n++){var i=t.changedTouches[n];void 0===i.button&&(i.button=0),void 0===i.buttons&&(i.buttons=1),void 0===i.isPrimary&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=t.type,e.push(i)}else if(globalThis.MouseEvent&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof globalThis.PointerEvent))e.push(t);else{var s=t;void 0===s.isPrimary&&(s.isPrimary=!0),void 0===s.width&&(s.width=1),void 0===s.height&&(s.height=1),void 0===s.tiltX&&(s.tiltX=0),void 0===s.tiltY&&(s.tiltY=0),void 0===s.pointerType&&(s.pointerType="mouse"),void 0===s.pointerId&&(s.pointerId=1),void 0===s.pressure&&(s.pressure=.5),void 0===s.twist&&(s.twist=0),void 0===s.tangentialPressure&&(s.tangentialPressure=0),s.isNormalized=!0,e.push(s)}return e}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}},{key:"bootstrapEvent",value:function(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=X[t.type]||t.type),t}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}}]),t}();W.extension={name:"events",type:[u.nw.RendererSystem,u.nw.CanvasRendererSystem]},u.Rw.add(W);var j={interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener:function(t,e,n){var r="function"==typeof e?void 0:e;t="boolean"==typeof n&&n||"object"==typeof n&&n.capture?"".concat(t,"capture"):t,e="function"==typeof e?e:e.handleEvent,this.on(t,e,r)},removeEventListener:function(t,e,n){var r="function"==typeof e?void 0:e;t="boolean"==typeof n&&n||"object"==typeof n&&n.capture?"".concat(t,"capture"):t,e="function"==typeof e?e:e.handleEvent,this.off(t,e,r)},dispatchEvent:function(t){if(!(t instanceof O))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}};A.s$.mixin(j),A.s$.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var z=100,V=function(){function t(e){(0,r.Z)(this,t),this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(u.P6.isMobile.tablet||u.P6.isMobile.phone)&&this.createTouchHook();var n=document.createElement("div");n.style.width="".concat(z,"px"),n.style.height="".concat(z,"px"),n.style.position="absolute",n.style.top="".concat(0,"px"),n.style.left="".concat(0,"px"),n.style.zIndex=2..toString(),this.div=n,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return(0,i.Z)(t,[{key:"isActive",get:function(){return this._isActive}},{key:"isMobileAccessibility",get:function(){return this._isMobileAccessibility}},{key:"createTouchHook",value:function(){var t=this,e=document.createElement("button");e.style.width="".concat(1,"px"),e.style.height="".concat(1,"px"),e.style.position="absolute",e.style.top="".concat(-1e3,"px"),e.style.left="".concat(-1e3,"px"),e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",(function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e}},{key:"destroyTouchHook",value:function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}},{key:"activate",value:function(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(t=this.renderer.view.parentNode)||void 0===t||t.appendChild(this.div))}},{key:"deactivate",value:function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(t=this.div.parentNode)||void 0===t||t.removeChild(this.div))}},{key:"updateAccessibleObjects",value:function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var e=t.children;if(e)for(var n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}}},{key:"update",value:function(){var t=performance.now();if(!(u.P6.isMobile.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=e.x,r=e.y,i=e.width,s=e.height,a=this.renderer,o=a.width,h=a.height,l=a.resolution,c=i/o*l,f=s/h*l,d=this.div;d.style.left="".concat(n,"px"),d.style.top="".concat(r,"px"),d.style.width="".concat(o,"px"),d.style.height="".concat(h,"px");for(var p=0;p<this.children.length;p++){var v=this.children[p];if(v.renderId!==this.renderId)v._accessibleActive=!1,u.P6.removeItems(this.children,p,1),this.div.removeChild(v._accessibleDiv),this.pool.push(v._accessibleDiv),v._accessibleDiv=null,p--;else{d=v._accessibleDiv;var y=v.hitArea,m=v.worldTransform;v.hitArea?(d.style.left="".concat((m.tx+y.x*m.a)*c,"px"),d.style.top="".concat((m.ty+y.y*m.d)*f,"px"),d.style.width="".concat(y.width*m.a*c,"px"),d.style.height="".concat(y.height*m.d*f,"px")):(y=v.getBounds(),this.capHitArea(y),d.style.left="".concat(y.x*c,"px"),d.style.top="".concat(y.y*f,"px"),d.style.width="".concat(y.width*c,"px"),d.style.height="".concat(y.height*f,"px"),d.title!==v.accessibleTitle&&null!==v.accessibleTitle&&(d.title=v.accessibleTitle),d.getAttribute("aria-label")!==v.accessibleHint&&null!==v.accessibleHint&&d.setAttribute("aria-label",v.accessibleHint)),v.accessibleTitle===d.title&&v.tabIndex===d.tabIndex||(d.title=v.accessibleTitle,d.tabIndex=v.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}}},{key:"updateDebugHTML",value:function(t){t.innerHTML="type: ".concat(t.type,"</br> title : ").concat(t.title,"</br> tabIndex: ").concat(t.tabIndex)}},{key:"capHitArea",value:function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,n=e.width,r=e.height;t.x+t.width>n&&(t.width=n-t.x),t.y+t.height>r&&(t.height=r-t.y)}},{key:"addChild",value:function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="".concat(z,"px"),e.style.height="".concat(z,"px"),e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject ".concat(t.tabIndex)),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}},{key:"_dispatchEvent",value:function(t,e){var n=t.target.displayObject,r=this.renderer.events.rootBoundary,i=Object.assign(new O(r),{target:n});r.rootTarget=this.renderer.lastObjectRendered,e.forEach((function(t){return r.dispatchEvent(i,t)}))}},{key:"_onClick",value:function(t){this._dispatchEvent(t,["click","pointertap","tap"])}},{key:"_onFocus",value:function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}},{key:"_onFocusOut",value:function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}},{key:"_onKeyDown",value:function(t){9===t.keyCode&&this.activate()}},{key:"_onMouseMove",value:function(t){0===t.movementX&&0===t.movementY||this.deactivate()}},{key:"destroy",value:function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}]),t}();V.extension={name:"accessibility",type:[u.nw.RendererPlugin,u.nw.CanvasRendererPlugin]},u.Rw.add(V);var Y=function(){function t(e){var n=this;(0,r.Z)(this,t),this.stage=new A.W2,e=Object.assign({forceCanvas:!1},e),this.renderer=(0,u.e6)(e),t._plugins.forEach((function(t){t.init.call(n,e)}))}return(0,i.Z)(t,[{key:"render",value:function(){this.renderer.render(this.stage)}},{key:"view",get:function(){return this.renderer.view}},{key:"screen",get:function(){return this.renderer.screen}},{key:"destroy",value:function(e,n){var r=this,i=t._plugins.slice(0);i.reverse(),i.forEach((function(t){t.destroy.call(r)})),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null}}]),t}();Y._plugins=[],u.Rw.handleByList(u.nw.Application,Y._plugins);var K=function(){function t(){(0,r.Z)(this,t)}return(0,i.Z)(t,null,[{key:"init",value:function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame((function(){return e.resize()})))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var t,n;if(e.cancelResize(),e._resizeTo===globalThis.window)t=globalThis.innerWidth,n=globalThis.innerHeight;else{var r=e._resizeTo;t=r.clientWidth,n=r.clientHeight}e.renderer.resize(t,n),e.render()}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}},{key:"destroy",value:function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}]),t}();K.extension=u.nw.Application,u.Rw.add(K);var q=n(2982),$=n(5861),Q=n(4687),J=n.n(Q),tt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,r.Z)(this,t),this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=n}var e;return(0,i.Z)(t,[{key:"add",value:function(t){var e=this;t.forEach((function(t){e._assetList.push(t)})),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}},{key:"_next",value:(e=(0,$.Z)(J().mark((function t(){var e,n,r;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._assetList.length||!this._isActive){t.next=9;break}for(this._isLoading=!0,e=[],n=Math.min(this._assetList.length,this._maxConcurrent),r=0;r<n;r++)e.push(this._assetList.pop());return t.next=7,this._loader.load(e);case 7:this._isLoading=!1,this._next();case 9:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"active",get:function(){return this._isActive},set:function(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}]),t}(),et=function(t,e){return Array.isArray(t)||(t=[t]),e?t.map((function(t){return"string"==typeof t?e(t):t})):t},nt=new(function(){function t(){(0,r.Z)(this,t),this._parsers=[],this._cache=new Map,this._cacheMap=new Map}return(0,i.Z)(t,[{key:"reset",value:function(){this._cacheMap.clear(),this._cache.clear()}},{key:"has",value:function(t){return this._cache.has(t)}},{key:"get",value:function(t){var e=this._cache.get(t);return e}},{key:"set",value:function(t,e){for(var n,r=this,i=et(t),s=0;s<this.parsers.length;s++){var a=this.parsers[s];if(a.test(e)){n=a.getCacheableAssets(i,e);break}}n||(n={},i.forEach((function(t){n[t]=e})));var o=Object.keys(n),h={cacheKeys:o,keys:i};if(i.forEach((function(t){r._cacheMap.set(t,h)})),o.forEach((function(t){r._cache.has(t)&&r._cache.get(t),r._cache.set(t,n[t])})),e instanceof u.xE){var l=e;i.forEach((function(t){l.baseTexture!==u.xE.EMPTY.baseTexture&&u.VL.addToCache(l.baseTexture,t),u.xE.addToCache(l,t)}))}}},{key:"remove",value:function(t){var e=this;if(this._cacheMap.get(t),this._cacheMap.has(t)){var n=this._cacheMap.get(t);n.cacheKeys.forEach((function(t){e._cache.delete(t)})),n.keys.forEach((function(t){e._cacheMap.delete(t)}))}}},{key:"parsers",get:function(){return this._parsers}}]),t}()),rt=function(t){return!Array.isArray(t)},it=function(){function t(){(0,r.Z)(this,t),this._parsers=[],this.promiseCache={}}var e,n;return(0,i.Z)(t,[{key:"reset",value:function(){this.promiseCache={}}},{key:"_getLoadPromiseAndParser",value:function(t,e){var n=this,r={promise:null,parser:null};return r.promise=(0,$.Z)(J().mark((function i(){var s,a,o,u,h,l,c;return J().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:s=null,a=0;case 2:if(!(a<n.parsers.length)){i.next=13;break}if(!(u=n.parsers[a]).load||null===(o=u.test)||void 0===o||!o.call(u,t,e,n)){i.next=10;break}return i.next=7,u.load(t,e,n);case 7:return s=i.sent,r.parser=u,i.abrupt("break",13);case 10:a++,i.next=2;break;case 13:if(r.parser){i.next=15;break}return i.abrupt("return",null);case 15:h=0;case 16:if(!(h<n.parsers.length)){i.next=35;break}if(!(l=n.parsers[h]).parse){i.next=32;break}if(i.t0=l.parse,!i.t0){i.next=24;break}return i.next=23,null===(c=l.testParse)||void 0===c?void 0:c.call(l,s,e,n);case 23:i.t0=i.sent;case 24:if(!i.t0){i.next=32;break}return i.next=27,l.parse(s,e,n);case 27:if(i.t1=i.sent,i.t1){i.next=30;break}i.t1=s;case 30:s=i.t1,r.parser=l;case 32:h++,i.next=16;break;case 35:return i.abrupt("return",s);case 36:case"end":return i.stop()}}),i)})))(),r}},{key:"load",value:(n=(0,$.Z)(J().mark((function t(e,n){var r,i,s,a,o,h,l=this;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=0,i={},s=rt(e),a=et(e,(function(t){return{src:t}})),o=a.length,h=a.map(function(){var t=(0,$.Z)(J().mark((function t(e){var s;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=u.P6.path.toAbsolute(e.src),i[e.src]){t.next=15;break}return t.prev=2,l.promiseCache[s]||(l.promiseCache[s]=l._getLoadPromiseAndParser(s,e)),t.next=6,l.promiseCache[s].promise;case 6:i[e.src]=t.sent,n&&n(++r/o),t.next=15;break;case 10:throw t.prev=10,t.t0=t.catch(2),delete l.promiseCache[s],delete i[e.src],new Error("[Loader.load] Failed to load ".concat(s,".\n").concat(t.t0));case 15:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}()),t.next=8,Promise.all(h);case 8:return t.abrupt("return",s?i[a[0].src]:i);case 9:case"end":return t.stop()}}),t)}))),function(t,e){return n.apply(this,arguments)})},{key:"unload",value:(e=(0,$.Z)(J().mark((function t(e){var n,r,i=this;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=et(e,(function(t){return{src:t}})),r=n.map(function(){var t=(0,$.Z)(J().mark((function t(e){var n,r,s,a,o;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=u.P6.path.toAbsolute(e.src),!(r=i.promiseCache[n])){t.next=8;break}return t.next=5,r.promise;case 5:o=t.sent,null===(s=r.parser)||void 0===s||null===(a=s.unload)||void 0===a||a.call(s,o,e,i),delete i.promiseCache[n];case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=4,Promise.all(r);case 4:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"parsers",get:function(){return this._parsers}}]),t}();function st(t,e,n,r,i){for(var s=e[n],a=0;a<s.length;a++){var o=s[a];n<e.length-1?st(t.replace(r[n],o),e,n+1,r,i):i.push(t.replace(r[n],o))}}function at(t){var e=t.match(/\{(.*?)\}/g),n=[];if(e){var r=[];e.forEach((function(t){var e=t.substring(1,t.length-1).split(",");r.push(e)})),st(t,r,0,e,n)}else n.push(t);return n}var ot=function(){function t(){(0,r.Z)(this,t),this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}return(0,i.Z)(t,[{key:"prefer",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){t._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))})),this._resolverHash={}}},{key:"basePath",get:function(){return this._basePath},set:function(t){this._basePath=t}},{key:"rootPath",get:function(){return this._rootPath},set:function(t){this._rootPath=t}},{key:"parsers",get:function(){return this._parsers}},{key:"reset",value:function(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}},{key:"addManifest",value:function(t){var e=this;this._manifest,this._manifest=t,t.bundles.forEach((function(t){e.addBundle(t.name,t.assets)}))}},{key:"addBundle",value:function(t,e){var n=this,r=[];Array.isArray(e)?e.forEach((function(t){"string"==typeof t.name?r.push(t.name):r.push.apply(r,(0,q.Z)(t.name)),n.add(t.name,t.srcs)})):Object.keys(e).forEach((function(t){r.push(t),n.add(t,e[t])})),this._bundles[t]=r}},{key:"add",value:function(t,e,n){var r=this,i=et(t);i.forEach((function(t){r._assetMap[t]})),Array.isArray(e)||(e="string"==typeof e?at(e):[e]);var s=e.map((function(t){var e,s=t;if("string"==typeof t){for(var a=!1,o=0;o<r._parsers.length;o++){var h=r._parsers[o];if(h.test(t)){s=h.parse(t),a=!0;break}}a||(s={src:t})}return s.format||(s.format=s.src.split(".").pop()),s.alias||(s.alias=i),(r._basePath||r._rootPath)&&(s.src=u.P6.path.toAbsolute(s.src,r._basePath,r._rootPath)),s.data=null!==(e=s.data)&&void 0!==e?e:n,s}));i.forEach((function(t){r._assetMap[t]=s}))}},{key:"resolveBundle",value:function(t){var e=this,n=rt(t);t=et(t);var r={};return t.forEach((function(t){var n=e._bundles[t];n&&(r[t]=e.resolve(n))})),n?r[t[0]]:r}},{key:"resolveUrl",value:function(t){var e=this.resolve(t);if("string"!=typeof t){var n={};for(var r in e)n[r]=e[r].src;return n}return e.src}},{key:"resolve",value:function(t){var e=this,n=rt(t);t=et(t);var r={};return t.forEach((function(t){if(!e._resolverHash[t])if(e._assetMap[t]){var n,i=e._assetMap[t],s=e._getPreferredOrder(i),a=i[0];null==s||s.priority.forEach((function(t){s.params[t].forEach((function(e){var n=i.filter((function(n){return!!n[t]&&n[t]===e}));n.length&&(i=n)}))})),e._resolverHash[t]=null!==(n=i[0])&&void 0!==n?n:a}else{var o=t;(e._basePath||e._rootPath)&&(o=u.P6.path.toAbsolute(o,e._basePath,e._rootPath)),e._resolverHash[t]={src:o}}r[t]=e._resolverHash[t]})),n?r[t[0]]:r}},{key:"_getPreferredOrder",value:function(t){for(var e=this,n=function(n){var r=t[0],i=e._preferredOrder.find((function(t){return t.params.format.includes(r.format)}));if(i)return{v:i}},r=0;r<t.length;r++){var i=n();if("object"==typeof i)return i.v}return this._preferredOrder[0]}}]),t}();function ut(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ht(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ht(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var lt=function(){function t(){(0,r.Z)(this,t),this._detections=[],this._initialized=!1,this.resolver=new ot,this.loader=new it,this.cache=nt,this._backgroundLoader=new tt(this.loader),this._backgroundLoader.active=!0,this.reset()}var e,n,s,a,o,u,h,l,c;return(0,i.Z)(t,[{key:"init",value:(c=(0,$.Z)(J().mark((function t(){var e,n,r,i,s,a,o,u,h,l,c,f,d,p,v,y,m=arguments;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=m.length>0&&void 0!==m[0]?m[0]:{},!this._initialized){t.next=3;break}return t.abrupt("return");case 3:if(this._initialized=!0,i.basePath&&(this.resolver.basePath=i.basePath),!i.manifest){t.next=12;break}if("string"!=typeof(s=i.manifest)){t.next=11;break}return t.next=10,this.load(s);case 10:s=t.sent;case 11:this.resolver.addManifest(s);case 12:if(a=null!==(e=null===(n=i.texturePreference)||void 0===n?void 0:n.resolution)&&void 0!==e?e:1,o="number"==typeof a?[a]:a,u=[],null===(r=i.texturePreference)||void 0===r||!r.format){t.next=41;break}l=null===(h=i.texturePreference)||void 0===h?void 0:h.format,u="string"==typeof l?[l]:l,c=ut(this._detections),t.prev=19,c.s();case 21:if((f=c.n()).done){t.next=31;break}return d=f.value,t.next=25,d.test();case 25:if(t.sent){t.next=29;break}return t.next=28,d.remove(u);case 28:u=t.sent;case 29:t.next=21;break;case 31:t.next=36;break;case 33:t.prev=33,t.t0=t.catch(19),c.e(t.t0);case 36:return t.prev=36,c.f(),t.finish(36);case 39:t.next=62;break;case 41:p=ut(this._detections),t.prev=42,p.s();case 44:if((v=p.n()).done){t.next=54;break}return y=v.value,t.next=48,y.test();case 48:if(!t.sent){t.next=52;break}return t.next=51,y.add(u);case 51:u=t.sent;case 52:t.next=44;break;case 54:t.next=59;break;case 56:t.prev=56,t.t1=t.catch(42),p.e(t.t1);case 59:return t.prev=59,p.f(),t.finish(59);case 62:this.resolver.prefer({params:{format:u,resolution:o}});case 63:case"end":return t.stop()}}),t,this,[[19,33,36,39],[42,56,59,62]])}))),function(){return c.apply(this,arguments)})},{key:"add",value:function(t,e,n){this.resolver.add(t,e,n)}},{key:"load",value:(l=(0,$.Z)(J().mark((function t(e,n){var r,i,s,a,o=this;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._initialized){t.next=3;break}return t.next=3,this.init();case 3:return r=rt(e),i=et(e).map((function(t){return"string"!=typeof t?(o.resolver.add(t.src,t),t.src):t})),s=this.resolver.resolve(i),t.next=8,this._mapLoadToResolve(s,n);case 8:return a=t.sent,t.abrupt("return",r?a[i[0]]:a);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"addBundle",value:function(t,e){this.resolver.addBundle(t,e)}},{key:"loadBundle",value:(h=(0,$.Z)(J().mark((function t(e,n){var r,i,s,a,o,u,h,l,c=this;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._initialized){t.next=3;break}return t.next=3,this.init();case 3:return r=!1,"string"==typeof e&&(r=!0,e=[e]),i=this.resolver.resolveBundle(e),s={},a=Object.keys(i),o=0,u=0,h=function(){null==n||n(++o/u)},l=a.map((function(t){var e=i[t];return u+=Object.keys(e).length,c._mapLoadToResolve(e,h).then((function(e){s[t]=e}))})),t.next=14,Promise.all(l);case 14:return t.abrupt("return",r?s[e[0]]:s);case 15:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)})},{key:"backgroundLoad",value:(u=(0,$.Z)(J().mark((function t(e){var n;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._initialized){t.next=3;break}return t.next=3,this.init();case 3:"string"==typeof e&&(e=[e]),n=this.resolver.resolve(e),this._backgroundLoader.add(Object.values(n));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"backgroundLoadBundle",value:(o=(0,$.Z)(J().mark((function t(e){var n,r=this;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._initialized){t.next=3;break}return t.next=3,this.init();case 3:"string"==typeof e&&(e=[e]),n=this.resolver.resolveBundle(e),Object.values(n).forEach((function(t){r._backgroundLoader.add(Object.values(t))}));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"reset",value:function(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}},{key:"get",value:function(t){if("string"==typeof t)return nt.get(t);for(var e={},n=0;n<t.length;n++)e[n]=nt.get(t[n]);return e}},{key:"_mapLoadToResolve",value:(a=(0,$.Z)(J().mark((function t(e,n){var r,i,s,a;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object.values(e),i=Object.keys(e),this._backgroundLoader.active=!1,t.next=5,this.loader.load(r,n);case 5:return s=t.sent,this._backgroundLoader.active=!0,a={},r.forEach((function(t,e){var n=s[t.src],r=[t.src];t.alias&&r.push.apply(r,(0,q.Z)(t.alias)),a[i[e]]=n,nt.set(r,n)})),t.abrupt("return",a);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"unload",value:(s=(0,$.Z)(J().mark((function t(e){var n,r;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._initialized){t.next=3;break}return t.next=3,this.init();case 3:return n=et(e).map((function(t){return"string"!=typeof t?t.src:t})),r=this.resolver.resolve(n),t.next=7,this._unloadFromResolved(r);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"unloadBundle",value:(n=(0,$.Z)(J().mark((function t(e){var n,r,i=this;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._initialized){t.next=3;break}return t.next=3,this.init();case 3:return e=et(e),n=this.resolver.resolveBundle(e),r=Object.keys(n).map((function(t){return i._unloadFromResolved(n[t])})),t.next=8,Promise.all(r);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"_unloadFromResolved",value:(e=(0,$.Z)(J().mark((function t(e){var n;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=Object.values(e)).forEach((function(t){nt.remove(t.src)})),t.next=4,this.loader.unload(n);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"detections",get:function(){return this._detections}}]),t}(),ct=new lt;u.Rw.handleByList(u.nw.LoadParser,ct.loader.parsers).handleByList(u.nw.ResolveParser,ct.resolver.parsers).handleByList(u.nw.CacheParser,ct.cache.parsers).handleByList(u.nw.DetectionParser,ct.detections);var ft=n(885),dt={loader:u.nw.LoadParser,resolver:u.nw.ResolveParser,cache:u.nw.CacheParser,detection:u.nw.DetectionParser};u.Rw.handle(u.nw.Asset,(function(t){var e=t.ref;Object.entries(dt).filter((function(t){var n=(0,ft.Z)(t,1)[0];return!!e[n]})).forEach((function(t){var n,r=(0,ft.Z)(t,2),i=r[0],s=r[1];return u.Rw.add(Object.assign(e[i],{extension:null!==(n=e[i].extension)&&void 0!==n?n:s}))}))}),(function(t){var e=t.ref;Object.keys(dt).filter((function(t){return!!e[t]})).forEach((function(t){return u.Rw.remove(e[t])}))}));var pt={extension:u.nw.CacheParser,test:function(t){return Array.isArray(t)&&t.every((function(t){return t instanceof u.xE}))},getCacheableAssets:function(t,e){var n={};return t.forEach((function(t){e.forEach((function(e,r){n[t+(0===r?"":r+1)]=e}))})),n}};u.Rw.add(pt);var vt=function(t){return t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t}(vt||{}),yt={extension:{type:u.nw.LoadParser,priority:vt.Low},test:function(t){return u.P6.path.extname(t).includes(".json")},load:function(t){return(0,$.Z)(J().mark((function e(){var n,r;return J().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Xd.ADAPTER.fetch(t);case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))()}};u.Rw.add(yt);var mt={extension:{type:u.nw.LoadParser,priority:vt.Low},test:function(t){return u.P6.path.extname(t).includes(".txt")},load:function(t){return(0,$.Z)(J().mark((function e(){var n,r;return J().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Xd.ADAPTER.fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))()}};u.Rw.add(mt);var gt=n(4942);function xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(n),!0).forEach((function(e){(0,gt.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var bt=["normal","bold","100","200","300","400","500","600","700","800","900"],wt=["woff","woff2","ttf","otf"];function Et(t){var e=u.P6.path.extname(t);return u.P6.path.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})).join(" ")}var Tt={extension:{type:u.nw.LoadParser,priority:vt.Low},test:function(t){var e=t.split("?")[0].split(".").pop();return wt.includes(e)},load:function(t,e){return(0,$.Z)(J().mark((function n(){var r,i,s,a,o,h,l,c,f,d,p,v,y,m;return J().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(globalThis.navigator.onLine){n.next=2;break}throw new Error("[loadWebFont] Cannot load font - navigator is offline");case 2:if(!(r=u.Xd.ADAPTER.getFontFaceSet())){n.next=20;break}c=[],f=null!==(i=null===(s=e.data)||void 0===s?void 0:s.family)&&void 0!==i?i:Et(t),d=null!==(a=null===(o=e.data)||void 0===o||null===(h=o.weights)||void 0===h?void 0:h.filter((function(t){return bt.includes(t)})))&&void 0!==a?a:["normal"],p=null!==(l=e.data)&&void 0!==l?l:{},v=0;case 9:if(!(v<d.length)){n.next=19;break}return y=d[v],m=new FontFace(f,"url(".concat(t,")"),_t(_t({},p),{},{weight:y})),n.next=14,m.load();case 14:r.add(m),c.push(m);case 16:v++,n.next=9;break;case 19:return n.abrupt("return",1===c.length?c[0]:c);case 20:return n.abrupt("return",null);case 21:case"end":return n.stop()}}),n)})))()},unload:function(t){(Array.isArray(t)?t:[t]).forEach((function(t){return u.Xd.ADAPTER.getFontFaceSet().delete(t)}))}};u.Rw.add(Tt);var kt,At,Rt=0,St={id:"checkImageBitmap",code:"\n    async function checkImageBitmap()\n    {\n        try\n        {\n            if (typeof createImageBitmap !== 'function') return false;\n\n            const response = await fetch('".concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=","');\n            const imageBlob =  await response.blob();\n            const imageBitmap = await createImageBitmap(imageBlob);\n\n            return imageBitmap.width === 1 && imageBitmap.height === 1;\n        }\n        catch (e)\n        {\n            return false;\n        }\n    }\n    checkImageBitmap().then((result) => { self.postMessage(result); });\n    ")},It="\n    async function loadImageBitmap(url)\n    {\n        const response = await fetch(url);\n\n        if (!response.ok)\n        {\n            throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: `\n                + `${response.status} ${response.statusText}`);\n        }\n\n        const imageBlob =  await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n\n        return imageBitmap;\n    }\n    self.onmessage = async (event) =>\n    {\n        try\n        {\n            const imageBitmap = await loadImageBitmap(event.data.data[0]);\n\n            self.postMessage({\n                data: imageBitmap,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            }, [imageBitmap]);\n        }\n        catch(e)\n        {\n            self.postMessage({\n                error: e,\n                uuid: event.data.uuid,\n                id: event.data.id,\n            });\n        }\n    };",Pt=function(){function t(){(0,r.Z)(this,t),this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}var e,n;return(0,i.Z)(t,[{key:"isImageBitmapSupported",value:function(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise((function(t){var e=URL.createObjectURL(new Blob([St.code],{type:"application/javascript"})),n=new Worker(e);n.addEventListener("message",(function(r){n.terminate(),URL.revokeObjectURL(e),t(r.data)}))}))),this._isImageBitmapSupported}},{key:"loadImageBitmap",value:function(t){return this._run("loadImageBitmap",[t])}},{key:"_initWorkers",value:(n=(0,$.Z)(J().mark((function t(){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._initialized){t.next=2;break}return t.abrupt("return");case 2:this._initialized=!0;case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"getWorker",value:function(){var t=this;void 0===kt&&(kt=navigator.hardwareConcurrency||4);var e=this.workerPool.pop();return!e&&this._createdWorkers<kt&&(At||(At=URL.createObjectURL(new Blob([It],{type:"application/javascript"}))),this._createdWorkers++,(e=new Worker(At)).addEventListener("message",(function(e){t.complete(e.data),t.returnWorker(e.target),t.next()}))),e}},{key:"returnWorker",value:function(t){this.workerPool.push(t)}},{key:"complete",value:function(t){void 0!==t.error?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}},{key:"_run",value:(e=(0,$.Z)(J().mark((function t(e,n){var r,i=this;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._initWorkers();case 2:return r=new Promise((function(t,r){i.queue.push({id:e,arguments:n,resolve:t,reject:r})})),this.next(),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"next",value:function(){if(this.queue.length){var t=this.getWorker();if(t){var e=this.queue.pop(),n=e.id;this.resolveHash[Rt]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Rt++,id:n})}}}}]),t}(),Mt=new Pt;function Ct(t,e){var n=t.split("?")[0],r=u.P6.path.extname(n).toLowerCase();return Array.isArray(e)?e.includes(r.toLowerCase()):r.toLowerCase()===e}function Ot(t,e,n){var r=new u.xE(t);return r.baseTexture.on("dispose",(function(){delete e.promiseCache[n]})),r}function Dt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Bt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Dt(Object(n),!0).forEach((function(e){(0,gt.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Nt=[".jpg",".png",".jpeg",".avif",".webp"];function Lt(t){return Zt.apply(this,arguments)}function Zt(){return(Zt=(0,$.Z)(J().mark((function t(e){var n,r,i;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.Xd.ADAPTER.fetch(e);case 2:if((n=t.sent).ok){t.next=5;break}throw new Error("[loadImageBitmap] Failed to fetch ".concat(e,": ").concat(n.status," ").concat(n.statusText));case 5:return t.next=7,n.blob();case 7:return r=t.sent,t.next=10,createImageBitmap(r);case 10:return i=t.sent,t.abrupt("return",i);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ft={extension:{type:u.nw.LoadParser,priority:vt.High},config:{preferWorkers:!0},test:function(t){for(var e=!1,n=0;n<Nt.length;n++)if(t.startsWith("data:image/".concat(Nt[n].slice(1)))){e=!0;break}return e||Ct(t,Nt)},load:function(t,e,n){var r=this;return(0,$.Z)(J().mark((function i(){var s,a;return J().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(s=null,!globalThis.createImageBitmap){i.next=18;break}if(i.t0=r.config.preferWorkers,!i.t0){i.next=7;break}return i.next=6,Mt.isImageBitmapSupported();case 6:i.t0=i.sent;case 7:if(!i.t0){i.next=13;break}return i.next=10,Mt.loadImageBitmap(t);case 10:s=i.sent,i.next=16;break;case 13:return i.next=15,Lt(t);case 15:s=i.sent;case 16:i.next=21;break;case 18:return i.next=20,new Promise((function(e){(s=new Image).crossOrigin="anonymous",s.src=t,s.complete?e(s):s.onload=function(){e(s)}}));case 20:s=i.sent;case 21:return(a=new u.VL(s,Bt({resolution:u.P6.getResolutionOfUrl(t)},e.data))).resource.src=t,i.abrupt("return",Ot(a,n,t));case 24:case"end":return i.stop()}}),i)})))()},unload:function(t){t.destroy(!0)}};u.Rw.add(Ft);u.nw.LoadParser,vt.High;var Ut={extension:u.nw.ResolveParser,test:Ft.test,parse:function(t){var e,n;return{resolution:parseFloat(null!==(e=null===(n=u.Xd.RETINA_PREFIX.exec(t))||void 0===n?void 0:n[1])&&void 0!==e?e:"1"),format:t.split(".").pop(),src:t}}};u.Rw.add(Ut);var Gt,Ht,Xt,Wt={extension:{type:u.nw.DetectionParser,priority:1},test:(Xt=(0,$.Z)(J().mark((function t(){var e;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(globalThis.createImageBitmap){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=5,u.Xd.ADAPTER.fetch("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=").then((function(t){return t.blob()}));case 5:return e=t.sent,t.abrupt("return",createImageBitmap(e).then((function(){return!0}),(function(){return!1})));case 7:case"end":return t.stop()}}),t)}))),function(){return Xt.apply(this,arguments)}),add:(Ht=(0,$.Z)(J().mark((function t(e){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[].concat((0,q.Z)(e),["avif"]));case 1:case"end":return t.stop()}}),t)}))),function(t){return Ht.apply(this,arguments)}),remove:(Gt=(0,$.Z)(J().mark((function t(e){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.filter((function(t){return"avif"!==t})));case 1:case"end":return t.stop()}}),t)}))),function(t){return Gt.apply(this,arguments)})};u.Rw.add(Wt);var jt={extension:{type:u.nw.DetectionParser,priority:0},test:function(){var t=(0,$.Z)(J().mark((function t(){var e;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(globalThis.createImageBitmap){t.next=2;break}return t.abrupt("return",!1);case 2:return"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t.next=5,u.Xd.ADAPTER.fetch("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=").then((function(t){return t.blob()}));case 5:return e=t.sent,t.abrupt("return",createImageBitmap(e).then((function(){return!0}),(function(){return!1})));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),add:function(){var t=(0,$.Z)(J().mark((function t(e){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[].concat((0,q.Z)(e),["webp"]));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),remove:function(){var t=(0,$.Z)(J().mark((function t(e){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.filter((function(t){return"webp"!==t})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};u.Rw.add(jt);var zt,Vt=["png","jpg","jpeg"],Yt={extension:{type:u.nw.DetectionParser,priority:-1},test:function(){return Promise.resolve(!0)},add:function(){var t=(0,$.Z)(J().mark((function t(e){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[].concat((0,q.Z)(e),Vt));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),remove:function(){var t=(0,$.Z)(J().mark((function t(e){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.filter((function(t){return!Vt.includes(t)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};u.Rw.add(Yt);var Kt=function(t){return t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t}(Kt||{}),qt=(zt={},(0,gt.Z)(zt,33776,.5),(0,gt.Z)(zt,33777,.5),(0,gt.Z)(zt,33778,1),(0,gt.Z)(zt,33779,1),(0,gt.Z)(zt,35916,.5),(0,gt.Z)(zt,35917,.5),(0,gt.Z)(zt,35918,1),(0,gt.Z)(zt,35919,1),(0,gt.Z)(zt,37488,.5),(0,gt.Z)(zt,37489,.5),(0,gt.Z)(zt,37490,1),(0,gt.Z)(zt,37491,1),(0,gt.Z)(zt,37492,.5),(0,gt.Z)(zt,37496,1),(0,gt.Z)(zt,37493,.5),(0,gt.Z)(zt,37497,1),(0,gt.Z)(zt,37494,.5),(0,gt.Z)(zt,37495,.5),(0,gt.Z)(zt,35840,.5),(0,gt.Z)(zt,35842,.5),(0,gt.Z)(zt,35841,.25),(0,gt.Z)(zt,35843,.25),(0,gt.Z)(zt,36196,.5),(0,gt.Z)(zt,35986,.5),(0,gt.Z)(zt,35986,1),(0,gt.Z)(zt,34798,1),(0,gt.Z)(zt,37808,1),zt);function $t(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var Qt=function(t){(0,s.Z)(a,t);var e,n=$t(a);function a(t){var e,i,s,o,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:1,height:1,autoLoad:!0};return(0,r.Z)(this,a),"string"==typeof t?(s=t,o=new Uint8Array):(s=null,o=t),(i=n.call(this,o,h)).origin=s,i.buffer=o?new u.Rv(o):null,i.origin&&!1!==h.autoLoad&&i.load(),null!==(e=o)&&void 0!==e&&e.length&&(i.loaded=!0,i.onBlobLoaded(i.buffer.rawBinaryData)),i}return(0,i.Z)(a,[{key:"onBlobLoaded",value:function(t){}},{key:"load",value:(e=(0,$.Z)(J().mark((function t(){var e,n,r;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(this.origin);case 2:return e=t.sent,t.next=5,e.blob();case 5:return n=t.sent,t.next=8,n.arrayBuffer();case 8:return r=t.sent,this.data=new Uint32Array(r),this.buffer=new u.Rv(r),this.loaded=!0,this.onBlobLoaded(r),this.update(),t.abrupt("return",this);case 15:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),a}(u.qm);function Jt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var te,ee,ne=function(t){(0,s.Z)(n,t);var e=Jt(n);function n(t,i){var s;return(0,r.Z)(this,n),(s=e.call(this,t,i)).format=i.format,s.levels=i.levels||1,s._width=i.width,s._height=i.height,s._extension=n._formatToExtension(s.format),(i.levelBuffers||s.buffer)&&(s._levelBuffers=i.levelBuffers||n._createLevelBuffers(t instanceof Uint8Array?t:s.buffer.uint8View,s.format,s.levels,4,4,s.width,s.height)),s}return(0,i.Z)(n,[{key:"upload",value:function(t,e,n){var r=t.gl;if(!t.context.extensions[this._extension])throw new Error("".concat(this._extension," textures are not supported on the current machine"));if(!this._levelBuffers)return!1;for(var i=0,s=this.levels;i<s;i++){var a=this._levelBuffers[i],o=a.levelID,u=a.levelWidth,h=a.levelHeight,l=a.levelBuffer;r.compressedTexImage2D(r.TEXTURE_2D,o,this.format,u,h,0,l)}return!0}},{key:"onBlobLoaded",value:function(){this._levelBuffers=n._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}}],[{key:"_formatToExtension",value:function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}},{key:"_createLevelBuffers",value:function(t,e,n,r,i,s,a){for(var o=new Array(n),u=t.byteOffset,h=s,l=a,c=h+r-1&~(r-1),f=l+i-1&~(i-1),d=c*f*qt[e],p=0;p<n;p++)o[p]={levelID:p,levelWidth:n>1?h:c,levelHeight:n>1?l:f,levelBuffer:new Uint8Array(t.buffer,u,d)},u+=d,d=(c=(h=h>>1||1)+r-1&~(r-1))*(f=(l=l>>1||1)+i-1&~(i-1))*qt[e];return o}}]),n}(Qt);function re(){ee={s3tc:te.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:te.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:te.getExtension("WEBGL_compressed_texture_etc"),etc1:te.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:te.getExtension("WEBGL_compressed_texture_pvrtc")||te.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:te.getExtension("WEBGL_compressed_texture_atc"),astc:te.getExtension("WEBGL_compressed_texture_astc")}}var ie,se,ae={extension:{type:u.nw.DetectionParser,priority:2},test:function(){var t=(0,$.Z)(J().mark((function t(){var e,n;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=u.Xd.ADAPTER.createCanvas(),n=e.getContext("webgl")){t.next=4;break}return t.abrupt("return",!1);case 4:return te=n,t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),add:function(){var t=(0,$.Z)(J().mark((function t(e){var n,r;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:ee||re(),n=[],t.t0=J().keys(ee);case 3:if((t.t1=t.t0()).done){t.next=11;break}if(r=t.t1.value,ee[r]){t.next=8;break}return t.abrupt("continue",3);case 8:n.push(r),t.next=3;break;case 11:return t.abrupt("return",[].concat(n,(0,q.Z)(e)));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),remove:function(){var t=(0,$.Z)(J().mark((function t(e){return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ee||re(),t.abrupt("return",e.filter((function(t){return!(t in ee)})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};u.Rw.add(ae);var oe,ue,he,le=124,ce=3,fe=4,de=7,pe=19,ve=2,ye=0,me=1,ge=2,xe=3,_e=(ie={},(0,gt.Z)(ie,827611204,Kt.COMPRESSED_RGBA_S3TC_DXT1_EXT),(0,gt.Z)(ie,861165636,Kt.COMPRESSED_RGBA_S3TC_DXT3_EXT),(0,gt.Z)(ie,894720068,Kt.COMPRESSED_RGBA_S3TC_DXT5_EXT),ie),be=(se={},(0,gt.Z)(se,70,Kt.COMPRESSED_RGBA_S3TC_DXT1_EXT),(0,gt.Z)(se,71,Kt.COMPRESSED_RGBA_S3TC_DXT1_EXT),(0,gt.Z)(se,73,Kt.COMPRESSED_RGBA_S3TC_DXT3_EXT),(0,gt.Z)(se,74,Kt.COMPRESSED_RGBA_S3TC_DXT3_EXT),(0,gt.Z)(se,76,Kt.COMPRESSED_RGBA_S3TC_DXT5_EXT),(0,gt.Z)(se,77,Kt.COMPRESSED_RGBA_S3TC_DXT5_EXT),(0,gt.Z)(se,72,Kt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT),(0,gt.Z)(se,75,Kt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT),(0,gt.Z)(se,78,Kt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),se);function we(t){var e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");var n=new Uint32Array(t,0,le/Uint32Array.BYTES_PER_ELEMENT),r=n[ce],i=n[fe],s=n[de],a=new Uint32Array(t,pe*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),o=a[1];if(4&o){var u=a[ve];if(808540228!==u){var h=_e[u],l=new Uint8Array(t,128);return[new ne(l,{format:h,width:i,height:r,levels:s})]}var c=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),f=c[ye],d=c[me],p=c[ge],v=c[xe],y=be[f];if(void 0===y)throw new Error("DDSParser cannot parse texture data with DXGI format ".concat(f));if(4===p)throw new Error("DDSParser does not support cubemap textures");if(6===d)throw new Error("DDSParser does not supported 3D texture data");var m=new Array;if(1===v)m.push(new Uint8Array(t,148));else{for(var g=qt[y],x=0,_=i,b=r,w=0;w<s;w++){x+=Math.max(1,_+3&-4)*Math.max(1,b+3&-4)*g,_>>>=1,b>>>=1}for(var E=148,T=0;T<v;T++)m.push(new Uint8Array(t,E,x)),E+=x}return m.map((function(t){return new ne(t,{format:y,width:i,height:r,levels:s})}))}if(64&o)throw new Error("DDSParser does not support uncompressed texture data.");if(512&o)throw new Error("DDSParser does not supported YUV uncompressed texture data.");if(131072&o)throw new Error("DDSParser does not support single-channel (lumninance) texture data!");if(2&o)throw new Error("DDSParser does not support single-channel (alpha) texture data!");throw new Error("DDSParser failed to load a texture file due to an unknown reason!")}var Ee=[171,75,84,88,32,49,49,187,13,10,26,10],Te=67305985,ke=12,Ae=16,Re=24,Se=28,Ie=36,Pe=40,Me=44,Ce=48,Oe=52,De=56,Be=60,Ne=(oe={},(0,gt.Z)(oe,u.vK.UNSIGNED_BYTE,1),(0,gt.Z)(oe,u.vK.UNSIGNED_SHORT,2),(0,gt.Z)(oe,u.vK.INT,4),(0,gt.Z)(oe,u.vK.UNSIGNED_INT,4),(0,gt.Z)(oe,u.vK.FLOAT,4),(0,gt.Z)(oe,u.vK.HALF_FLOAT,8),oe),Le=(ue={},(0,gt.Z)(ue,u.I2.RGBA,4),(0,gt.Z)(ue,u.I2.RGB,3),(0,gt.Z)(ue,u.I2.RG,2),(0,gt.Z)(ue,u.I2.RED,1),(0,gt.Z)(ue,u.I2.LUMINANCE,1),(0,gt.Z)(ue,u.I2.LUMINANCE_ALPHA,2),(0,gt.Z)(ue,u.I2.ALPHA,1),ue),Ze=(he={},(0,gt.Z)(he,u.vK.UNSIGNED_SHORT_4_4_4_4,2),(0,gt.Z)(he,u.vK.UNSIGNED_SHORT_5_5_5_1,2),(0,gt.Z)(he,u.vK.UNSIGNED_SHORT_5_6_5,2),he);function Fe(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new DataView(e);if(!Ue(t,r))return null;var i=r.getUint32(ke,!0)===Te,s=r.getUint32(Ae,i),a=r.getUint32(Re,i),o=r.getUint32(Se,i),h=r.getUint32(Ie,i),l=r.getUint32(Pe,i)||1,c=r.getUint32(Me,i)||1,f=r.getUint32(Ce,i)||1,d=r.getUint32(Oe,i),p=r.getUint32(De,i),v=r.getUint32(Be,i);if(0===l||1!==c)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==f)throw new Error("WebGL does not support array textures");var y,m=4,g=4,x=h+3&-4,_=l+3&-4,b=new Array(f),w=h*l;if(0===s&&(w=x*_),void 0===(y=0!==s?Ne[s]?Ne[s]*Le[a]:Ze[s]:qt[o]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var E=n?He(r,v,i):null,T=w*y,k=T,A=h,R=l,S=x,I=_,P=64+v,M=0;M<p;M++){for(var C=r.getUint32(P,i),O=P+4,D=0;D<f;D++){var B=b[D];B||(B=b[D]=new Array(p)),B[M]={levelID:M,levelWidth:p>1||0!==s?A:S,levelHeight:p>1||0!==s?R:I,levelBuffer:new Uint8Array(e,O,k)},O+=k}P=(P+=C+4)%4!=0?P+4-P%4:P,k=(S=(A=A>>1||1)+m-1&~(m-1))*(I=(R=R>>1||1)+g-1&~(g-1))*y}return 0!==s?{uncompressed:b.map((function(t){var e=t[0].levelBuffer,n=!1;return s===u.vK.FLOAT?e=new Float32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4):s===u.vK.UNSIGNED_INT?(n=!0,e=new Uint32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)):s===u.vK.INT&&(n=!0,e=new Int32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)),{resource:new u.qm(e,{width:t[0].levelWidth,height:t[0].levelHeight}),type:s,format:n?Ge(a):a}})),kvData:E}:{compressed:b.map((function(t){return new ne(null,{format:o,width:h,height:l,levels:p,levelBuffers:t})})),kvData:E}}function Ue(t,e){for(var n=0;n<Ee.length;n++)if(e.getUint8(n)!==Ee[n])return!1;return!0}function Ge(t){switch(t){case u.I2.RGBA:return u.I2.RGBA_INTEGER;case u.I2.RGB:return u.I2.RGB_INTEGER;case u.I2.RG:return u.I2.RG_INTEGER;case u.I2.RED:return u.I2.RED_INTEGER;default:return t}}function He(t,e,n){for(var r=new Map,i=0;i<e;){var s=t.getUint32(64+i,n),a=64+i+4,o=3-(s+3)%4;if(0===s||s>e-i){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}for(var u=0;u<s&&0!==t.getUint8(a+u);u++);if(-1===u){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}var h=(new TextDecoder).decode(new Uint8Array(t.buffer,a,u)),l=new DataView(t.buffer,a+u+1,s-u-1);r.set(h,l),i+=4+s+o}return r}function Xe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function We(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xe(Object(n),!0).forEach((function(e){(0,gt.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var je={extension:{type:u.nw.LoadParser,priority:vt.High},test:function(t){return Ct(t,".dds")},load:function(t,e,n){return(0,$.Z)(J().mark((function r(){var i,s,a,o;return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.Xd.ADAPTER.fetch(t);case 2:return i=r.sent,r.next=5,i.arrayBuffer();case 5:return s=r.sent,a=we(s),o=a.map((function(r){return Ot(new u.VL(r,We({mipmap:u.KI.OFF,alphaMode:u.iw.NO_PREMULTIPLIED_ALPHA,resolution:u.P6.getResolutionOfUrl(t)},e.data)),n,t)})),r.abrupt("return",1===o.length?o[0]:o);case 9:case"end":return r.stop()}}),r)})))()},unload:function(t){Array.isArray(t)?t.forEach((function(t){return t.destroy(!0)})):t.destroy(!0)}};function ze(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ve(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ze(Object(n),!0).forEach((function(e){(0,gt.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}u.Rw.add(je);var Ye={extension:{type:u.nw.LoadParser,priority:vt.High},test:function(t){return Ct(t,".ktx")},load:function(t,e,n){return(0,$.Z)(J().mark((function r(){var i,s,a,o,h,l,c,f,d;return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.Xd.ADAPTER.fetch(t);case 2:return i=r.sent,r.next=5,i.arrayBuffer();case 5:return s=r.sent,a=Fe(t,s),o=a.compressed,h=a.uncompressed,l=a.kvData,c=null!=o?o:h,f=Ve({mipmap:u.KI.OFF,alphaMode:u.iw.NO_PREMULTIPLIED_ALPHA,resolution:u.P6.getResolutionOfUrl(t)},e.data),d=c.map((function(e){c===h&&Object.assign(f,{type:e.type,format:e.format});var r=new u.VL(e,f);return r.ktxKeyValueData=l,Ot(r,n,t)})),r.abrupt("return",1===d.length?d[0]:d);case 11:case"end":return r.stop()}}),r)})))()},unload:function(t){Array.isArray(t)?t.forEach((function(t){return t.destroy(!0)})):t.destroy(!0)}};u.Rw.add(Ye);n(4378);var Ke={extension:u.nw.ResolveParser,test:function(t){var e=t.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:function(t){var e,n;if("ktx"===t.split("?")[0].split(".").pop()){var r,i,s=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(s.some((function(e){return t.endsWith(e)})))return{resolution:parseFloat(null!==(r=null===(i=u.Xd.RETINA_PREFIX.exec(t))||void 0===i?void 0:i[1])&&void 0!==r?r:"1"),format:s.find((function(e){return t.endsWith(e)})),src:t}}return{resolution:parseFloat(null!==(e=null===(n=u.Xd.RETINA_PREFIX.exec(t))||void 0===n?void 0:n[1])&&void 0!==e?e:"1"),format:t.split(".").pop(),src:t}}};u.Rw.add(Ke);var qe=new u.Ae,$e=function(){function t(e){(0,r.Z)(this,t),this.renderer=e}var e,n;return(0,i.Z)(t,[{key:"image",value:(n=(0,$.Z)(J().mark((function t(e,n,r){var i;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=new Image,t.next=3,this.base64(e,n,r);case 3:return i.src=t.sent,t.abrupt("return",i);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return n.apply(this,arguments)})},{key:"base64",value:(e=(0,$.Z)(J().mark((function t(e,n,r){var i,s;return J().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(i=this.canvas(e)).toDataURL){t.next=3;break}return t.abrupt("return",i.toDataURL(n,r));case 3:if(void 0===i.convertToBlob){t.next=10;break}return t.next=6,i.convertToBlob({type:n,quality:r});case 6:return s=t.sent,t.next=9,new Promise((function(t){var e=new FileReader;e.onload=function(){return t(e.result)},e.readAsDataURL(s)}));case 9:return t.abrupt("return",t.sent);case 10:throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented");case 11:case"end":return t.stop()}}),t,this)}))),function(t,n,r){return e.apply(this,arguments)})},{key:"canvas",value:function(e,n){var r,i,s,a=this.renderer,o=!1,h=!1;(e&&(e instanceof u.TI?i=e:(i=this.renderer.generateTexture(e),h=!0)),i)?(r=i.baseTexture.resolution,n=null!==(s=n)&&void 0!==s?s:i.frame,o=!1,a.renderTexture.bind(i)):(r=a.resolution,n||((n=qe).width=a.width,n.height=a.height),o=!0,a.renderTexture.bind(null));var l=Math.round(n.width*r),c=Math.round(n.height*r),f=new u.P6.CanvasRenderTarget(l,c,1),d=new Uint8Array(4*l*c),p=a.gl;p.readPixels(Math.round(n.x*r),Math.round(n.y*r),l,c,p.RGBA,p.UNSIGNED_BYTE,d);var v=f.context.getImageData(0,0,l,c);if(t.arrayPostDivide(d,v.data),f.context.putImageData(v,0,0),o){var y=new u.P6.CanvasRenderTarget(f.width,f.height,1);y.context.scale(1,-1),y.context.drawImage(f.canvas,0,-c),f.destroy(),f=y}return h&&i.destroy(!0),f.canvas}},{key:"pixels",value:function(e,n){var r,i,s,a=this.renderer,o=!1;(e&&(e instanceof u.TI?i=e:(i=this.renderer.generateTexture(e),o=!0)),i)?(r=i.baseTexture.resolution,n=null!==(s=n)&&void 0!==s?s:i.frame,a.renderTexture.bind(i)):(r=a.resolution,n||((n=qe).width=a.width,n.height=a.height),a.renderTexture.bind(null));var h=Math.round(n.width*r),l=Math.round(n.height*r),c=new Uint8Array(4*h*l),f=a.gl;return f.readPixels(Math.round(n.x*r),Math.round(n.y*r),h,l,f.RGBA,f.UNSIGNED_BYTE,c),o&&i.destroy(!0),t.arrayPostDivide(c,c),c}},{key:"destroy",value:function(){this.renderer=null}}],[{key:"arrayPostDivide",value:function(t,e){for(var n=0;n<t.length;n+=4){var r=e[n+3]=t[n+3];0!==r?(e[n]=Math.round(Math.min(255*t[n]/r,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/r,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/r,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}}}]),t}(),Qe=$e;Qe.extension={name:"extract",type:u.nw.RendererSystem},u.Rw.add(Qe);var Je=function(t){return t.MITER="miter",t.BEVEL="bevel",t.ROUND="round",t}(Je||{}),tn=function(t){return t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t}(tn||{}),en={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(!this.adaptive||!t||isNaN(t))return e;var n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},nn=function(){function t(){(0,r.Z)(this,t),this.color=16777215,this.alpha=1,this.texture=u.xE.WHITE,this.matrix=null,this.visible=!1,this.reset()}return(0,i.Z)(t,[{key:"clone",value:function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}},{key:"reset",value:function(){this.color=16777215,this.alpha=1,this.texture=u.xE.WHITE,this.matrix=null,this.visible=!1}},{key:"destroy",value:function(){this.texture=null,this.matrix=null}}]),t}();function rn(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.length;if(!(n<6)){for(var r=0,i=0,s=t[n-2],a=t[n-1];i<n;i+=2){var o=t[i],u=t[i+1];r+=(o-s)*(u+a),s=o,a=u}if(!e&&r>0||e&&r<=0)for(var h=n/2,l=h+h%2;l<n;l+=2){var c=n-l-2,f=n-l-1,d=l,p=l+1,v=[t[d],t[c]];t[c]=v[0],t[d]=v[1];var y=[t[p],t[f]];t[f]=y[0],t[p]=y[1]}}}var sn={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var n=t.points,r=t.holes,i=e.points,s=e.indices;if(n.length>=6){rn(n,!1);for(var a=[],o=0;o<r.length;o++){var h=r[o];rn(h.points,!0),a.push(n.length/2),n=n.concat(h.points)}var l=u.P6.earcut(n,a,2);if(!l)return;for(var c=i.length/2,f=0;f<l.length;f+=3)s.push(l[f]+c),s.push(l[f+1]+c),s.push(l[f+2]+c);for(var d=0;d<n.length;d++)i.push(n[d])}}},an={build:function(t){var e,n,r,i,s,a,o=t.points;if(t.type===u.HS.CIRC){var h=t.shape;e=h.x,n=h.y,s=a=h.radius,r=i=0}else if(t.type===u.HS.ELIP){var l=t.shape;e=l.x,n=l.y,s=l.width,a=l.height,r=i=0}else{var c=t.shape,f=c.width/2,d=c.height/2;e=c.x+f,n=c.y+d,r=f-(s=a=Math.max(0,Math.min(c.radius,Math.min(f,d)))),i=d-a}if(s>=0&&a>=0&&r>=0&&i>=0){var p=Math.ceil(2.3*Math.sqrt(s+a)),v=8*p+(r?4:0)+(i?4:0);if(o.length=v,0!==v){if(0===p)return o.length=8,o[0]=o[6]=e+r,o[1]=o[3]=n+i,o[2]=o[4]=e-r,void(o[5]=o[7]=n-i);var y=0,m=4*p+(r?2:0)+2,g=m,x=v,_=r+s,b=i,w=e+_,E=e-_,T=n+b;if(o[y++]=w,o[y++]=T,o[--m]=T,o[--m]=E,i){var k=n-b;o[g++]=E,o[g++]=k,o[--x]=k,o[--x]=w}for(var A=1;A<p;A++){var R=Math.PI/2*(A/p),S=r+Math.cos(R)*s,I=i+Math.sin(R)*a,P=e+S,M=e-S,C=n+I,O=n-I;o[y++]=P,o[y++]=C,o[--m]=C,o[--m]=M,o[g++]=M,o[g++]=O,o[--x]=O,o[--x]=P}var D=i+a,B=e+r,N=e-r,L=n+D,Z=n-D;o[y++]=B,o[y++]=L,o[--x]=Z,o[--x]=B,r&&(o[y++]=N,o[y++]=L,o[--x]=Z,o[--x]=N)}}else o.length=0},triangulate:function(t,e){var n=t.points,r=e.points,i=e.indices;if(0!==n.length){var s,a,o=r.length/2,h=o;if(t.type!==u.HS.RREC){var l=t.shape;s=l.x,a=l.y}else{var c=t.shape;s=c.x+c.width/2,a=c.y+c.height/2}var f=t.matrix;r.push(t.matrix?f.a*s+f.c*a+f.tx:s,t.matrix?f.b*s+f.d*a+f.ty:a),o++,r.push(n[0],n[1]);for(var d=2;d<n.length;d+=2)r.push(n[d],n[d+1]),i.push(o++,h,o);i.push(h+1,h,o)}}},on={build:function(t){var e=t.shape,n=e.x,r=e.y,i=e.width,s=e.height,a=t.points;a.length=0,i>=0&&s>=0&&a.push(n,r,n+i,r,n+i,r+s,n,r+s)},triangulate:function(t,e){var n=t.points,r=e.points;if(0!==n.length){var i=r.length/2;r.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(i,i+1,i+2,i+1,i+2,i+3)}}},un={build:function(t){an.build(t)},triangulate:function(t,e){an.triangulate(t,e)}};function hn(t,e,n,r,i,s,a,o){var u,h;a?(u=r,h=-n):(u=-r,h=n);var l=t-n*i+u,c=e-r*i+h,f=t+n*s+u,d=e+r*s+h;return o.push(l,c),o.push(f,d),2}function ln(t,e,n,r,i,s,a,o){var u=n-t,h=r-e,l=Math.atan2(u,h),c=Math.atan2(i-t,s-e);o&&l<c?l+=2*Math.PI:!o&&l>c&&(c+=2*Math.PI);var f=l,d=c-l,p=Math.abs(d),v=Math.sqrt(u*u+h*h),y=1+(15*p*Math.sqrt(v)/Math.PI>>0),m=d/y;if(f+=m,o){a.push(t,e),a.push(n,r);for(var g=1,x=f;g<y;g++,x+=m)a.push(t,e),a.push(t+Math.sin(x)*v,e+Math.cos(x)*v);a.push(t,e),a.push(i,s)}else{a.push(n,r),a.push(t,e);for(var _=1,b=f;_<y;_++,b+=m)a.push(t+Math.sin(b)*v,e+Math.cos(b)*v),a.push(t,e);a.push(i,s),a.push(t,e)}return 2*y}function cn(t,e){t.lineStyle.native?function(t,e){var n=0,r=t.shape,i=t.points||r.points,s=r.type!==u.HS.POLY||r.closeStroke;if(0!==i.length){var a=e.points,o=e.indices,h=i.length/2,l=a.length/2,c=l;for(a.push(i[0],i[1]),n=1;n<h;n++)a.push(i[2*n],i[2*n+1]),o.push(c,c+1),c++;s&&o.push(c,l)}}(t,e):function(t,e){var n=t.shape,r=t.points||n.points.slice(),i=e.closePointEps;if(0!==r.length){var s=t.lineStyle,a=new u.E9(r[0],r[1]),o=new u.E9(r[r.length-2],r[r.length-1]),h=n.type!==u.HS.POLY||n.closeStroke,l=Math.abs(a.x-o.x)<i&&Math.abs(a.y-o.y)<i;if(h){r=r.slice(),l&&(r.pop(),r.pop(),o.set(r[r.length-2],r[r.length-1]));var c=.5*(a.x+o.x),f=.5*(o.y+a.y);r.unshift(c,f),r.push(c,f)}var d=e.points,p=r.length/2,v=r.length,y=d.length/2,m=s.width/2,g=m*m,x=s.miterLimit*s.miterLimit,_=r[0],b=r[1],w=r[2],E=r[3],T=0,k=0,A=-(b-E),R=_-w,S=0,I=0,P=Math.sqrt(A*A+R*R);A/=P,R/=P,A*=m,R*=m;var M=s.alignment,C=2*(1-M),O=2*M;h||(s.cap===tn.ROUND?v+=ln(_-A*(C-O)*.5,b-R*(C-O)*.5,_-A*C,b-R*C,_+A*O,b+R*O,d,!0)+2:s.cap===tn.SQUARE&&(v+=hn(_,b,A,R,C,O,!0,d))),d.push(_-A*C,b-R*C),d.push(_+A*O,b+R*O);for(var D=1;D<p-1;++D){_=r[2*(D-1)],b=r[2*(D-1)+1],w=r[2*D],E=r[2*D+1],T=r[2*(D+1)],k=r[2*(D+1)+1],A=-(b-E),R=_-w,A/=P=Math.sqrt(A*A+R*R),R/=P,A*=m,R*=m,S=-(E-k),I=w-T,S/=P=Math.sqrt(S*S+I*I),I/=P,S*=m,I*=m;var B=w-_,N=b-E,L=w-T,Z=k-E,F=B*L+N*Z,U=N*L-Z*B,G=U<0;if(Math.abs(U)<.001*Math.abs(F))d.push(w-A*C,E-R*C),d.push(w+A*O,E+R*O),F>=0&&(s.join===Je.ROUND?v+=ln(w,E,w-A*C,E-R*C,w-S*C,E-I*C,d,!1)+4:v+=2,d.push(w-S*O,E-I*O),d.push(w+S*C,E+I*C));else{var H=(-A+_)*(-R+E)-(-A+w)*(-R+b),X=(-S+T)*(-I+E)-(-S+w)*(-I+k),W=(B*X-L*H)/U,j=(Z*H-N*X)/U,z=(W-w)*(W-w)+(j-E)*(j-E),V=w+(W-w)*C,Y=E+(j-E)*C,K=w-(W-w)*O,q=E-(j-E)*O,$=G?C:O;z<=Math.min(B*B+N*N,L*L+Z*Z)+$*$*g?s.join===Je.BEVEL||z/g>x?(G?(d.push(V,Y),d.push(w+A*O,E+R*O),d.push(V,Y),d.push(w+S*O,E+I*O)):(d.push(w-A*C,E-R*C),d.push(K,q),d.push(w-S*C,E-I*C),d.push(K,q)),v+=2):s.join===Je.ROUND?G?(d.push(V,Y),d.push(w+A*O,E+R*O),v+=ln(w,E,w+A*O,E+R*O,w+S*O,E+I*O,d,!0)+4,d.push(V,Y),d.push(w+S*O,E+I*O)):(d.push(w-A*C,E-R*C),d.push(K,q),v+=ln(w,E,w-A*C,E-R*C,w-S*C,E-I*C,d,!1)+4,d.push(w-S*C,E-I*C),d.push(K,q)):(d.push(V,Y),d.push(K,q)):(d.push(w-A*C,E-R*C),d.push(w+A*O,E+R*O),s.join===Je.ROUND?v+=G?ln(w,E,w+A*O,E+R*O,w+S*O,E+I*O,d,!0)+2:ln(w,E,w-A*C,E-R*C,w-S*C,E-I*C,d,!1)+2:s.join===Je.MITER&&z/g<=x&&(G?(d.push(K,q),d.push(K,q)):(d.push(V,Y),d.push(V,Y)),v+=2),d.push(w-S*C,E-I*C),d.push(w+S*O,E+I*O),v+=2)}}_=r[2*(p-2)],b=r[2*(p-2)+1],w=r[2*(p-1)],A=-(b-(E=r[2*(p-1)+1])),R=_-w,A/=P=Math.sqrt(A*A+R*R),R/=P,A*=m,R*=m,d.push(w-A*C,E-R*C),d.push(w+A*O,E+R*O),h||(s.cap===tn.ROUND?v+=ln(w-A*(C-O)*.5,E-R*(C-O)*.5,w-A*C,E-R*C,w+A*O,E+R*O,d,!1)+2:s.cap===tn.SQUARE&&(v+=hn(w,E,A,R,C,O,!1,d)));for(var Q=e.indices,J=en.epsilon*en.epsilon,tt=y;tt<v+y-2;++tt)_=d[2*tt],b=d[2*tt+1],w=d[2*(tt+1)],E=d[2*(tt+1)+1],T=d[2*(tt+2)],k=d[2*(tt+2)+1],Math.abs(_*(E-k)+w*(k-b)+T*(b-E))<J||Q.push(tt,tt+1,tt+2)}}(t,e)}var fn,dn=function(){function t(){(0,r.Z)(this,t)}return(0,i.Z)(t,null,[{key:"curveTo",value:function(t,e,n,r,i,s){var a=s[s.length-2],o=s[s.length-1]-e,u=a-t,h=r-e,l=n-t,c=Math.abs(o*l-u*h);if(c<1e-8||0===i)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var f=o*o+u*u,d=h*h+l*l,p=o*h+u*l,v=i*Math.sqrt(f)/c,y=i*Math.sqrt(d)/c,m=v*p/f,g=y*p/d,x=v*l+y*u,_=v*h+y*o,b=u*(y+m),w=o*(y+m),E=l*(v+g),T=h*(v+g);return{cx:x+t,cy:_+e,radius:i,startAngle:Math.atan2(w-_,b-x),endAngle:Math.atan2(T-_,E-x),anticlockwise:u*h>l*o}}},{key:"arc",value:function(t,e,n,r,i,s,a,o,h){for(var l=a-s,c=en._segmentsCount(Math.abs(l)*i,40*Math.ceil(Math.abs(l)/u._b)),f=l/(2*c),d=2*f,p=Math.cos(f),v=Math.sin(f),y=c-1,m=y%1/y,g=0;g<=y;++g){var x=f+s+d*(g+m*g),_=Math.cos(x),b=-Math.sin(x);h.push((p*_+v*b)*i+n,(p*-b+v*_)*i+r)}}}]),t}(),pn=function(){function t(){(0,r.Z)(this,t)}return(0,i.Z)(t,null,[{key:"curveLength",value:function(t,e,n,r,i,s,a,o){for(var u=0,h=0,l=0,c=0,f=0,d=0,p=0,v=0,y=0,m=0,g=0,x=t,_=e,b=1;b<=10;++b)m=x-(v=(p=(d=(f=1-(h=b/10))*f)*f)*t+3*d*h*n+3*f*(l=h*h)*i+(c=l*h)*a),g=_-(y=p*e+3*d*h*r+3*f*l*s+c*o),x=v,_=y,u+=Math.sqrt(m*m+g*g);return u}},{key:"curveTo",value:function(e,n,r,i,s,a,o){var u=o[o.length-2],h=o[o.length-1];o.length-=2;var l=en._segmentsCount(t.curveLength(u,h,e,n,r,i,s,a)),c=0,f=0,d=0,p=0,v=0;o.push(u,h);for(var y=1,m=0;y<=l;++y)d=(f=(c=1-(m=y/l))*c)*c,v=(p=m*m)*m,o.push(d*u+3*f*m*e+3*c*p*r+v*s,d*h+3*f*m*n+3*c*p*i+v*a)}}]),t}(),vn=function(){function t(){(0,r.Z)(this,t)}return(0,i.Z)(t,null,[{key:"curveLength",value:function(t,e,n,r,i,s){var a=t-2*n+i,o=e-2*r+s,u=2*n-2*t,h=2*r-2*e,l=4*(a*a+o*o),c=4*(a*u+o*h),f=u*u+h*h,d=2*Math.sqrt(l+c+f),p=Math.sqrt(l),v=2*l*p,y=2*Math.sqrt(f),m=c/p;return(v*d+p*c*(d-y)+(4*f*l-c*c)*Math.log((2*p+m+d)/(m+y)))/(4*v)}},{key:"curveTo",value:function(e,n,r,i,s){for(var a=s[s.length-2],o=s[s.length-1],u=en._segmentsCount(t.curveLength(a,o,e,n,r,i)),h=0,l=0,c=1;c<=u;++c){var f=c/u;h=a+(e-a)*f,l=o+(n-o)*f,s.push(h+(e+(r-e)*f-h)*f,l+(n+(i-n)*f-l)*f)}}}]),t}(),yn=(fn={},(0,gt.Z)(fn,u.HS.POLY,sn),(0,gt.Z)(fn,u.HS.CIRC,an),(0,gt.Z)(fn,u.HS.ELIP,an),(0,gt.Z)(fn,u.HS.RECT,on),(0,gt.Z)(fn,u.HS.RREC,un),fn),mn=[],gn=[],xn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,r.Z)(this,t),this.points=[],this.holes=[],this.shape=e,this.lineStyle=i,this.fillStyle=n,this.matrix=s,this.type=e.type}return(0,i.Z)(t,[{key:"clone",value:function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)}},{key:"destroy",value:function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}]),t}(),_n=function(){function t(){(0,r.Z)(this,t),this.reset()}return(0,i.Z)(t,[{key:"begin",value:function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n}},{key:"end",value:function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}},{key:"reset",value:function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}]),t}();function bn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var wn=new u.E9,En=function(t){(0,s.Z)(n,t);var e=bn(n);function n(){var t;return(0,r.Z)(this,n),(t=e.call(this)).closePointEps=1e-4,t.boundsPadding=0,t.uvsFloat32=null,t.indicesUint16=null,t.batchable=!1,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.drawCalls=[],t.batchDirty=-1,t.batches=[],t.dirty=0,t.cacheDirty=-1,t.clearDirty=0,t.shapeIndex=0,t._bounds=new A.YZ,t.boundsDirty=-1,t}return(0,i.Z)(n,[{key:"bounds",get:function(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}},{key:"invalidate",value:function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),gn.push(this.drawCalls[t]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var n=this.batches[e];n.reset(),mn.push(n)}this.batches.length=0}},{key:"clear",value:function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}},{key:"drawShape",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=new xn(t,e,n,r);return this.graphicsData.push(i),this.dirty++,this}},{key:"drawHole",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.graphicsData.length)return null;var n=new xn(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=r.lineStyle,r.holes.push(n),this.dirty++,this}},{key:"destroy",value:function(){(0,k.Z)((0,o.Z)(n.prototype),"destroy",this).call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}},{key:"containsPoint",value:function(t){for(var e=this.graphicsData,n=0;n<e.length;++n){var r=e[n];if(r.fillStyle.visible&&(r.shape&&(r.matrix?r.matrix.applyInverse(t,wn):wn.copyFrom(t),r.shape.contains(wn.x,wn.y)))){var i=!1;if(r.holes)for(var s=0;s<r.holes.length;s++){if(r.holes[s].shape.contains(wn.x,wn.y)){i=!0;break}}if(!i)return!0}}return!1}},{key:"updateBatches",value:function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,e=this.graphicsData,n=null,r=null;this.batches.length>0&&(r=(n=this.batches[this.batches.length-1]).style);for(var i=this.shapeIndex;i<e.length;i++){this.shapeIndex++;var s=e[i],a=s.fillStyle,o=s.lineStyle;yn[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix),(a.visible||o.visible)&&this.processHoles(s.holes);for(var h=0;h<2;h++){var l=0===h?a:o;if(l.visible){var c=l.texture.baseTexture,f=this.indices.length,d=this.points.length/2;c.wrapMode=u.Nt.REPEAT,0===h?this.processFill(s):this.processLine(s);var p=this.points.length/2-d;0!==p&&(n&&!this._compareStyles(r,l)&&(n.end(f,d),n=null),n||((n=mn.pop()||new _n).begin(l,f,d),this.batches.push(n),r=l),this.addUvs(this.points,t,l.texture,d,p,l.matrix))}}}var v=this.indices.length,y=this.points.length/2;if(n&&n.end(v,y),0!==this.batches.length){var m=y>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&m===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=m?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0}},{key:"_compareStyles",value:function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))}},{key:"validateBatching",value:function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var n=this.graphicsData[t],r=n.fillStyle,i=n.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(i&&!i.texture.baseTexture.valid)return!1}return!0}},{key:"packBatches",value:function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,n=t.length;e<n;e++)for(var r=t[e],i=0;i<r.size;i++){var s=r.start+i;this.indicesUint16[s]=this.indicesUint16[s]-r.attribStart}}},{key:"isBatchable",value:function(){if(this.points.length>131070)return!1;for(var t=this.batches,e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*n.BATCHABLE_SIZE}},{key:"buildDrawCalls",value:function(){for(var t=++u.VL._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),gn.push(this.drawCalls[e]);this.drawCalls.length=0;var n=this.colors,r=this.textureIds,i=gn.pop();i||((i=new u.a$).texArray=new u.Ie),i.texArray.count=0,i.start=0,i.size=0,i.type=u.lg.TRIANGLES;var s=0,a=null,o=0,h=!1,l=u.lg.TRIANGLES,c=0;this.drawCalls.push(i);for(var f=0;f<this.batches.length;f++){var d=this.batches[f],p=d.style,v=p.texture.baseTexture;h!==!!p.native&&(l=(h=!!p.native)?u.lg.LINES:u.lg.TRIANGLES,a=null,s=8,t++),a!==v&&(a=v,v._batchEnabled!==t&&(8===s&&(t++,s=0,i.size>0&&((i=gn.pop())||((i=new u.a$).texArray=new u.Ie),this.drawCalls.push(i)),i.start=c,i.size=0,i.texArray.count=0,i.type=l),v.touched=1,v._batchEnabled=t,v._batchLocation=s,v.wrapMode=u.Nt.REPEAT,i.texArray.elements[i.texArray.count++]=v,s++)),i.size+=d.size,c+=d.size,o=v._batchLocation,this.addColors(n,p.color,p.alpha,d.attribSize,d.attribStart),this.addTextureIds(r,o,d.attribSize,d.attribStart)}u.VL._globalBatch=t,this.packAttributes()}},{key:"packAttributes",value:function(){for(var t=this.points,e=this.uvs,n=this.colors,r=this.textureIds,i=new ArrayBuffer(3*t.length*4),s=new Float32Array(i),a=new Uint32Array(i),o=0,u=0;u<t.length/2;u++)s[o++]=t[2*u],s[o++]=t[2*u+1],s[o++]=e[2*u],s[o++]=e[2*u+1],a[o++]=n[u],s[o++]=r[u];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)}},{key:"processFill",value:function(t){t.holes.length?sn.triangulate(t,this):yn[t.type].triangulate(t,this)}},{key:"processLine",value:function(t){cn(t,this);for(var e=0;e<t.holes.length;e++)cn(t.holes[e],this)}},{key:"processHoles",value:function(t){for(var e=0;e<t.length;e++){var n=t[e];yn[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}}},{key:"calculateBounds",value:function(){var t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}},{key:"transformPoints",value:function(t,e){for(var n=0;n<t.length/2;n++){var r=t[2*n],i=t[2*n+1];t[2*n]=e.a*r+e.c*i+e.tx,t[2*n+1]=e.b*r+e.d*i+e.ty}}},{key:"addColors",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=(e>>16)+(65280&e)+((255&e)<<16),a=u.P6.premultiplyTint(s,n);t.length=Math.max(t.length,i+r);for(var o=0;o<r;o++)t[i+o]=a}},{key:"addTextureIds",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t.length=Math.max(t.length,r+n);for(var i=0;i<n;i++)t[r+i]=e}},{key:"addUvs",value:function(t,e,n,r,i){for(var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=0,o=e.length,u=n.frame;a<i;){var h=t[2*(r+a)],l=t[2*(r+a)+1];if(s){var c=s.a*h+s.c*l+s.tx;l=s.b*h+s.d*l+s.ty,h=c}a++,e.push(h/u.width,l/u.height)}var f=n.baseTexture;(u.width<f.width||u.height<f.height)&&this.adjustUvs(e,n,o,i)}},{key:"adjustUvs",value:function(t,e,n,r){for(var i=e.baseTexture,s=1e-6,a=n+2*r,o=e.frame,u=o.width/i.width,h=o.height/i.height,l=o.x/o.width,c=o.y/o.height,f=Math.floor(t[n]+s),d=Math.floor(t[n+1]+s),p=n+2;p<a;p+=2)f=Math.min(f,Math.floor(t[p]+s)),d=Math.min(d,Math.floor(t[p+1]+s));l-=f,c-=d;for(var v=n;v<a;v+=2)t[v]=(t[v]+l)*u,t[v+1]=(t[v+1]+c)*h}}]),n}(u.JZ),Tn=En;function kn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}Tn.BATCHABLE_SIZE=100;var An=function(t){(0,s.Z)(n,t);var e=kn(n);function n(){var t;return(0,r.Z)(this,n),(t=e.apply(this,arguments)).width=0,t.alignment=.5,t.native=!1,t.cap=tn.BUTT,t.join=Je.MITER,t.miterLimit=10,t}return(0,i.Z)(n,[{key:"clone",value:function(){var t=new n;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}},{key:"reset",value:function(){(0,k.Z)((0,o.Z)(n.prototype),"reset",this).call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}]),n}(nn);function Rn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var Sn=new Float32Array(3),In={},Pn=function(t){(0,s.Z)(n,t);var e=Rn(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(0,r.Z)(this,n),(t=e.call(this)).shader=null,t.pluginName="batch",t.currentPath=null,t.batches=[],t.batchTint=-1,t.batchDirty=-1,t.vertexData=null,t._fillStyle=new nn,t._lineStyle=new An,t._matrix=null,t._holeMode=!1,t.state=u.ZM.for2d(),t._geometry=i||new Tn,t._geometry.refCount++,t._transformID=-1,t.tint=16777215,t.blendMode=u.T$.NORMAL,t}return(0,i.Z)(n,[{key:"geometry",get:function(){return this._geometry}},{key:"clone",value:function(){return this.finishPoly(),new n(this._geometry)}},{key:"blendMode",get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t}},{key:"fill",get:function(){return this._fillStyle}},{key:"line",get:function(){return this._lineStyle}},{key:"lineStyle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return"number"==typeof t&&(t={width:t,color:e,alpha:n,alignment:r,native:i}),this.lineTextureStyle(t)}},{key:"lineTextureStyle",value:function(t){var e;t=Object.assign({width:0,texture:u.xE.WHITE,color:null!==(e=t)&&void 0!==e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:tn.BUTT,join:Je.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var n=t.width>0&&t.alpha>0;return n?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:n},t)):this._lineStyle.reset(),this}},{key:"startPoly",value:function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new u.mg,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new u.mg,this.currentPath.closeStroke=!1}},{key:"finishPoly",value:function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}},{key:"moveTo",value:function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}},{key:"lineTo",value:function(t,e){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,r=n[n.length-2],i=n[n.length-1];return r===t&&i===e||n.push(t,e),this}},{key:"_initCurve",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}},{key:"quadraticCurveTo",value:function(t,e,n,r){this._initCurve();var i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),vn.curveTo(t,e,n,r,i),this}},{key:"bezierCurveTo",value:function(t,e,n,r,i,s){return this._initCurve(),pn.curveTo(t,e,n,r,i,s,this.currentPath.points),this}},{key:"arcTo",value:function(t,e,n,r,i){this._initCurve(t,e);var s=this.currentPath.points,a=dn.curveTo(t,e,n,r,i,s);if(a){var o=a.cx,u=a.cy,h=a.radius,l=a.startAngle,c=a.endAngle,f=a.anticlockwise;this.arc(o,u,h,l,c,f)}return this}},{key:"arc",value:function(t,e,n,r,i){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(r===i)return this;!s&&i<=r?i+=u._b:s&&r<=i&&(r+=u._b);var a=i-r;if(0===a)return this;var o=t+Math.cos(r)*n,h=e+Math.sin(r)*n,l=this._geometry.closePointEps,c=this.currentPath?this.currentPath.points:null;if(c){var f=Math.abs(c[c.length-2]-o),d=Math.abs(c[c.length-1]-h);f<l&&d<l||c.push(o,h)}else this.moveTo(o,h),c=this.currentPath.points;return dn.arc(o,h,t,e,n,r,i,s,c),this}},{key:"beginFill",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.beginTextureFill({texture:u.xE.WHITE,color:t,alpha:e})}},{key:"beginTextureFill",value:function(t){t=Object.assign({texture:u.xE.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this}},{key:"endFill",value:function(){return this.finishPoly(),this._fillStyle.reset(),this}},{key:"drawRect",value:function(t,e,n,r){return this.drawShape(new u.Ae(t,e,n,r))}},{key:"drawRoundedRect",value:function(t,e,n,r,i){return this.drawShape(new u.c9(t,e,n,r,i))}},{key:"drawCircle",value:function(t,e,n){return this.drawShape(new u.Cd(t,e,n))}},{key:"drawEllipse",value:function(t,e,n,r){return this.drawShape(new u.Pj(t,e,n,r))}},{key:"drawPolygon",value:function(){for(var t,e=!0,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var s=r[0];s.points?(e=s.closeStroke,t=s.points):t=Array.isArray(r[0])?r[0]:r;var a=new u.mg(t);return a.closeStroke=e,this.drawShape(a),this}},{key:"drawShape",value:function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}},{key:"clear",value:function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}},{key:"isFastRect",value:function(){var t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==u.HS.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)}},{key:"_render",value:function(t){this.finishPoly();var e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}},{key:"_populateBatches",value:function(){var t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(var r=0;r<n;r++){var i=t.batches[r],s=i.style.color,a=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),o=new Float32Array(t.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),h={vertexData:a,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*i.start,i.size),uvs:o,_batchRGB:u.P6.hex2rgb(s),_tintRGB:s,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[r]=h}}},{key:"_renderBatched",value:function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,n=this.batches.length;e<n;e++){var r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}}},{key:"_renderDirect",value:function(t){var e=this._resolveDirectShader(t),n=this._geometry,r=this.tint,i=this.worldAlpha,s=e.uniforms,a=n.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(r>>16&255)/255*i,s.tint[1]=(r>>8&255)/255*i,s.tint[2]=(255&r)/255*i,s.tint[3]=i,t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(var o=0,u=a.length;o<u;o++)this._renderDrawCallDirect(t,n.drawCalls[o])}},{key:"_renderDrawCallDirect",value:function(t,e){for(var n=e.texArray,r=e.type,i=e.size,s=e.start,a=n.count,o=0;o<a;o++)t.texture.bind(n.elements[o],o);t.geometry.draw(r,i,s)}},{key:"_resolveDirectShader",value:function(t){var e=this.shader,n=this.pluginName;if(!e){if(!In[n]){for(var r=t.plugins[n].MAX_TEXTURES,i=new Int32Array(r),s=0;s<r;s++)i[s]=s;var a={tint:new Float32Array([1,1,1,1]),translationMatrix:new u.y3,default:u.oo.from({uSamplers:i},!0)},o=t.plugins[n]._shader.program;In[n]=new u.ex(o,a)}e=In[n]}return e}},{key:"_calculateBounds",value:function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,n=e.minX,r=e.minY,i=e.maxX,s=e.maxY;this._bounds.addFrame(this.transform,n,r,i,s)}}},{key:"containsPoint",value:function(t){return this.worldTransform.applyInverse(t,n._TEMP_POINT),this._geometry.containsPoint(n._TEMP_POINT)}},{key:"calculateTints",value:function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=u.P6.hex2rgb(this.tint,Sn),e=0;e<this.batches.length;e++){var n=this.batches[e],r=n._batchRGB,i=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);n._tintRGB=(i>>16)+(65280&i)+((255&i)<<16)}}}},{key:"calculateVertices",value:function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,n=e.a,r=e.b,i=e.c,s=e.d,a=e.tx,o=e.ty,u=this._geometry.points,h=this.vertexData,l=0,c=0;c<u.length;c+=2){var f=u[c],d=u[c+1];h[l++]=n*f+i*d+a,h[l++]=s*d+r*f+o}}}},{key:"closePath",value:function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}},{key:"setMatrix",value:function(t){return this._matrix=t,this}},{key:"beginHole",value:function(){return this.finishPoly(),this._holeMode=!0,this}},{key:"endHole",value:function(){return this.finishPoly(),this._holeMode=!1,this}},{key:"destroy",value:function(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,(0,k.Z)((0,o.Z)(n.prototype),"destroy",this).call(this,t)}}]),n}(A.W2),Mn=Pn;Mn._TEMP_POINT=new u.E9;var Cn=function(){function t(e,n){(0,r.Z)(this,t),this.uvBuffer=e,this.uvMatrix=n,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return(0,i.Z)(t,[{key:"update",value:function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}}]),t}();function On(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var Dn=new u.E9,Bn=new u.mg,Nn=function(t){(0,s.Z)(n,t);var e=On(n);function n(t,i,s){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.lg.TRIANGLES;return(0,r.Z)(this,n),(a=e.call(this)).geometry=t,a.shader=i,a.state=s||u.ZM.for2d(),a.drawMode=o,a.start=0,a.size=0,a.uvs=null,a.indices=null,a.vertexData=new Float32Array(1),a.vertexDirty=-1,a._transformID=-1,a._roundPixels=u.Xd.ROUND_PIXELS,a.batchUvs=null,a}return(0,i.Z)(n,[{key:"geometry",get:function(){return this._geometry},set:function(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}},{key:"uvBuffer",get:function(){return this.geometry.buffers[1]}},{key:"verticesBuffer",get:function(){return this.geometry.buffers[0]}},{key:"material",get:function(){return this.shader},set:function(t){this.shader=t}},{key:"blendMode",get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t}},{key:"roundPixels",get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}},{key:"tint",get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t}},{key:"texture",get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t}},{key:"_render",value:function(t){var e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===u.lg.TRIANGLES&&e.length<2*n.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)}},{key:"_renderDefault",value:function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}},{key:"_renderToBatch",value:function(t){var e=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;var r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)}},{key:"calculateVertices",value:function(){var t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var r=this.transform.worldTransform,i=r.a,s=r.b,a=r.c,o=r.d,h=r.tx,l=r.ty,c=this.vertexData,f=0;f<c.length/2;f++){var d=e[2*f],p=e[2*f+1];c[2*f]=i*d+a*p+h,c[2*f+1]=s*d+o*p+l}if(this._roundPixels)for(var v=u.Xd.RESOLUTION,y=0;y<c.length;++y)c[y]=Math.round(c[y]*v)/v;this.vertexDirty=n}}},{key:"calculateUvs",value:function(){var t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Cn(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}},{key:"_calculateBounds",value:function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}},{key:"containsPoint",value:function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Dn);for(var e=this.geometry.getBuffer("aVertexPosition").data,n=Bn.points,r=this.geometry.getIndex().data,i=r.length,s=4===this.drawMode?3:1,a=0;a+2<i;a+=s){var o=2*r[a],u=2*r[a+1],h=2*r[a+2];if(n[0]=e[o],n[1]=e[o+1],n[2]=e[u],n[3]=e[u+1],n[4]=e[h],n[5]=e[h+1],Bn.contains(Dn.x,Dn.y))return!0}return!1}},{key:"destroy",value:function(t){(0,k.Z)((0,o.Z)(n.prototype),"destroy",this).call(this,t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}}]),n}(A.W2),Ln=Nn;Ln.BATCHABLE_SIZE=100;function Zn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var Fn=function(t){(0,s.Z)(n,t);var e=Zn(n);function n(t,i){var s;(0,r.Z)(this,n);var a={uSampler:t,alpha:1,uTextureMatrix:u.y3.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(i=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},i)).uniforms&&Object.assign(a,i.uniforms),(s=e.call(this,i.program||u.$r.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),a))._colorDirty=!1,s.uvMatrix=new u.UX(t),s.batchable=void 0===i.program,s.pluginName=i.pluginName,s.tint=i.tint,s.alpha=i.alpha,s}return(0,i.Z)(n,[{key:"texture",get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}},{key:"alpha",get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}},{key:"tint",get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)}},{key:"update",value:function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;u.P6.premultiplyTintToRgba(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}]),n}(u.ex);function Un(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var Gn=function(t){(0,s.Z)(n,t);var e=Un(n);function n(t,i,s){var a;(0,r.Z)(this,n),a=e.call(this);var o=new u.lW(t),h=new u.lW(i,!0),l=new u.lW(s,!0,!0);return a.addAttribute("aVertexPosition",o,2,!1,u.vK.FLOAT).addAttribute("aTextureCoord",h,2,!1,u.vK.FLOAT).addIndex(l),a._updateId=-1,a}return(0,i.Z)(n,[{key:"vertexDirtyId",get:function(){return this.buffers[0]._updateID}}]),n}(u.wG);function Hn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var Xn=function(t){(0,s.Z)(n,t);var e=Hn(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return(0,r.Z)(this,n),(t=e.call(this)).segWidth=a,t.segHeight=o,t.width=i,t.height=s,t.build(),t}return(0,i.Z)(n,[{key:"build",value:function(){for(var t=this.segWidth*this.segHeight,e=[],n=[],r=[],i=this.segWidth-1,s=this.segHeight-1,a=this.width/i,o=this.height/s,u=0;u<t;u++){var h=u%this.segWidth,l=u/this.segWidth|0;e.push(h*a,l*o),n.push(h/i,l/s)}for(var c=i*s,f=0;f<c;f++){var d=f%i,p=f/i|0,v=p*this.segWidth+d,y=p*this.segWidth+d+1,m=(p+1)*this.segWidth+d,g=(p+1)*this.segWidth+d+1;r.push(v,y,m,y,g,m)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}]),n}(Gn);function Wn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var jn=function(t){(0,s.Z)(n,t);var e=Wn(n);function n(t,i,s){var a;(0,r.Z)(this,n);var o=new Xn(t.width,t.height,i,s),h=new Fn(u.xE.WHITE);return(a=e.call(this,o,h)).texture=t,a.autoResize=!0,a}return(0,i.Z)(n,[{key:"textureUpdated",value:function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,e=this.shader.texture,n=e.width,r=e.height;!this.autoResize||t.width===n&&t.height===r||(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())}},{key:"texture",get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))}},{key:"_render",value:function(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),(0,k.Z)((0,o.Z)(n.prototype),"_render",this).call(this,t)}},{key:"destroy",value:function(t){this.shader.texture.off("update",this.textureUpdated,this),(0,k.Z)((0,o.Z)(n.prototype),"destroy",this).call(this,t)}}]),n}(Ln);function zn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var Vn=10,Yn=function(t){(0,s.Z)(n,t);var e=zn(n);function n(t){var i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vn,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vn,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Vn,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Vn;return(0,r.Z)(this,n),(i=e.call(this,u.xE.WHITE,4,4))._origWidth=t.orig.width,i._origHeight=t.orig.height,i._width=i._origWidth,i._height=i._origHeight,i._leftWidth=s,i._rightWidth=o,i._topHeight=a,i._bottomHeight=h,i.texture=t,i}return(0,i.Z)(n,[{key:"textureUpdated",value:function(){this._textureID=this.shader.texture._updateID,this._refresh()}},{key:"vertices",get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t}},{key:"updateHorizontalVertices",value:function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height}},{key:"updateVerticalVertices",value:function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width}},{key:"_getMinScale",value:function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,r=this._height>n?1:this._height/n;return Math.min(e,r)}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this._refresh()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._refresh()}},{key:"leftWidth",get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()}},{key:"rightWidth",get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()}},{key:"topHeight",get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()}},{key:"bottomHeight",get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()}},{key:"_refresh",value:function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var n=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}]),n}(jn);function Kn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var qn=function(t){(0,s.Z)(n,t);var e=Kn(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500,s=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16384,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,r.Z)(this,n);var h=16384;return a>h&&(a=h),(t=e.call(this))._properties=[!1,!0,!1,!1,!1],t._maxSize=i,t._batchSize=a,t._buffers=null,t._bufferUpdateIDs=[],t._updateID=0,t.interactiveChildren=!1,t.blendMode=u.T$.NORMAL,t.autoResize=o,t.roundPixels=!0,t.baseTexture=null,t.setProperties(s),t._tint=0,t.tintRgb=new Float32Array(4),t.tint=16777215,t}return(0,i.Z)(n,[{key:"setProperties",value:function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])}},{key:"updateTransform",value:function(){this.displayObjectUpdateTransform()}},{key:"tint",get:function(){return this._tint},set:function(t){this._tint=t,u.P6.hex2rgb(t,this.tintRgb)}},{key:"render",value:function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))}},{key:"onChildrenChange",value:function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID}},{key:"dispose",value:function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}}},{key:"destroy",value:function(t){(0,k.Z)((0,o.Z)(n.prototype),"destroy",this).call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}]),n}(A.W2),$n=function(){function t(e,n,i){(0,r.Z)(this,t),this.geometry=new u.wG,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var s=0;s<e.length;++s){var a=e[s];a={attributeName:a.attributeName,size:a.size,uploadFunction:a.uploadFunction,type:a.type||u.vK.FLOAT,offset:a.offset},n[s]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return(0,i.Z)(t,[{key:"initBuffers",value:function(){var t=this.geometry,e=0;this.indexBuffer=new u.lW(u.P6.createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n){var r=this.dynamicProperties[n];r.offset=e,e+=r.size,this.dynamicStride+=r.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new u.lW(this.dynamicData,!1,!1);var s=0;this.staticStride=0;for(var a=0;a<this.staticProperties.length;++a){var o=this.staticProperties[a];o.offset=s,s+=o.size,this.staticStride+=o.size}var h=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(h),this.staticDataUint32=new Uint32Array(h),this.staticBuffer=new u.lW(this.staticData,!0,!1);for(var l=0;l<this.dynamicProperties.length;++l){var c=this.dynamicProperties[l];t.addAttribute(c.attributeName,this.dynamicBuffer,0,c.type===u.vK.UNSIGNED_BYTE,c.type,4*this.dynamicStride,4*c.offset)}for(var f=0;f<this.staticProperties.length;++f){var d=this.staticProperties[f];t.addAttribute(d.attributeName,this.staticBuffer,0,d.type===u.vK.UNSIGNED_BYTE,d.type,4*this.staticStride,4*d.offset)}}},{key:"uploadDynamic",value:function(t,e,n){for(var r=0;r<this.dynamicProperties.length;r++){var i=this.dynamicProperties[r];i.uploadFunction(t,e,n,i.type===u.vK.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++}},{key:"uploadStatic",value:function(t,e,n){for(var r=0;r<this.staticProperties.length;r++){var i=this.staticProperties[r];i.uploadFunction(t,e,n,i.type===u.vK.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++}},{key:"destroy",value:function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}]),t}();function Qn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var Jn=function(t){(0,s.Z)(n,t);var e=Qn(n);function n(t){var i;return(0,r.Z)(this,n),(i=e.call(this,t)).shader=null,i.properties=null,i.tempMatrix=new u.y3,i.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:i.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:i.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:i.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:i.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:u.vK.UNSIGNED_BYTE,uploadFunction:i.uploadTint,offset:0}],i.shader=u.ex.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),i.state=u.ZM.for2d(),i}return(0,i.Z)(n,[{key:"render",value:function(t){var e=t.children,n=t._maxSize,r=t._batchSize,i=this.renderer,s=e.length;if(0!==s){s>n&&!t.autoResize&&(s=n);var a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));var o=e[0]._texture.baseTexture,h=o.alphaMode>0;this.state.blendMode=u.P6.correctBlendMode(t.blendMode,h),i.state.set(this.state);var l=i.gl,c=t.worldTransform.copyTo(this.tempMatrix);c.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=u.P6.premultiplyRgba(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,h),this.shader.uniforms.uSampler=o,this.renderer.shader.bind(this.shader);for(var f=!1,d=0,p=0;d<s;d+=r,p+=1){var v=s-d;v>r&&(v=r),p>=a.length&&a.push(this._generateOneMoreBuffer(t));var y=a[p];y.uploadDynamic(e,d,v);var m=t._bufferUpdateIDs[p]||0;(f=f||y._updateID<m)&&(y._updateID=t._updateID,y.uploadStatic(e,d,v)),i.geometry.bind(y.geometry),l.drawElements(l.TRIANGLES,6*v,l.UNSIGNED_SHORT,0)}}}},{key:"generateBuffers",value:function(t){for(var e=[],n=t._maxSize,r=t._batchSize,i=t._properties,s=0;s<n;s+=r)e.push(new $n(this.properties,i,r));return e}},{key:"_generateOneMoreBuffer",value:function(t){var e=t._batchSize,n=t._properties;return new $n(this.properties,n,e)}},{key:"uploadVertices",value:function(t,e,n,r,i,s){for(var a=0,o=0,u=0,h=0,l=0;l<n;++l){var c=t[e+l],f=c._texture,d=c.scale.x,p=c.scale.y,v=f.trim,y=f.orig;v?(a=(o=v.x-c.anchor.x*y.width)+v.width,u=(h=v.y-c.anchor.y*y.height)+v.height):(a=y.width*(1-c.anchor.x),o=y.width*-c.anchor.x,u=y.height*(1-c.anchor.y),h=y.height*-c.anchor.y),r[s]=o*d,r[s+1]=h*p,r[s+i]=a*d,r[s+i+1]=h*p,r[s+2*i]=a*d,r[s+2*i+1]=u*p,r[s+3*i]=o*d,r[s+3*i+1]=u*p,s+=4*i}}},{key:"uploadPosition",value:function(t,e,n,r,i,s){for(var a=0;a<n;a++){var o=t[e+a].position;r[s]=o.x,r[s+1]=o.y,r[s+i]=o.x,r[s+i+1]=o.y,r[s+2*i]=o.x,r[s+2*i+1]=o.y,r[s+3*i]=o.x,r[s+3*i+1]=o.y,s+=4*i}}},{key:"uploadRotation",value:function(t,e,n,r,i,s){for(var a=0;a<n;a++){var o=t[e+a].rotation;r[s]=o,r[s+i]=o,r[s+2*i]=o,r[s+3*i]=o,s+=4*i}}},{key:"uploadUvs",value:function(t,e,n,r,i,s){for(var a=0;a<n;++a){var o=t[e+a]._texture._uvs;o?(r[s]=o.x0,r[s+1]=o.y0,r[s+i]=o.x1,r[s+i+1]=o.y1,r[s+2*i]=o.x2,r[s+2*i+1]=o.y2,r[s+3*i]=o.x3,r[s+3*i+1]=o.y3,s+=4*i):(r[s]=0,r[s+1]=0,r[s+i]=0,r[s+i+1]=0,r[s+2*i]=0,r[s+2*i+1]=0,r[s+3*i]=0,r[s+3*i+1]=0,s+=4*i)}}},{key:"uploadTint",value:function(t,e,n,r,i,s){for(var a=0;a<n;++a){var o=t[e+a],h=o._texture.baseTexture.alphaMode>0,l=o.alpha,c=l<1&&h?u.P6.premultiplyTint(o._tintRGB,l):o._tintRGB+(255*l<<24);r[s]=c,r[s+i]=c,r[s+2*i]=c,r[s+3*i]=c,s+=4*i}}},{key:"destroy",value:function(){(0,k.Z)((0,o.Z)(n.prototype),"destroy",this).call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}]),n}(u.bO);Jn.extension={name:"particle",type:u.nw.RendererPlugin},u.Rw.add(Jn),u.Xd.UPLOADS_PER_FRAME=4;var tr=function(t){return t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",t}(tr||{}),er={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:tr.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},nr=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rr=function(){function t(e){(0,r.Z)(this,t),this.styleID=0,this.reset(),ar(this,e,e)}return(0,i.Z)(t,[{key:"clone",value:function(){var e={};return ar(e,this,er),new t(e)}},{key:"reset",value:function(){ar(this,er,er)}},{key:"align",get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)}},{key:"breakWords",get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}},{key:"dropShadow",get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}},{key:"dropShadowAlpha",get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}},{key:"dropShadowAngle",get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}},{key:"dropShadowBlur",get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}},{key:"dropShadowColor",get:function(){return this._dropShadowColor},set:function(t){var e=sr(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}},{key:"dropShadowDistance",get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}},{key:"fill",get:function(){return this._fill},set:function(t){var e=sr(t);this._fill!==e&&(this._fill=e,this.styleID++)}},{key:"fillGradientType",get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}},{key:"fillGradientStops",get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}},{key:"fontStyle",get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}},{key:"fontVariant",get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}},{key:"leading",get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)}},{key:"stroke",get:function(){return this._stroke},set:function(t){var e=sr(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}},{key:"strokeThickness",get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}},{key:"textBaseline",get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}},{key:"trim",get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)}},{key:"whiteSpace",get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}},{key:"wordWrap",get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}},{key:"wordWrapWidth",get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}},{key:"toFontString",value:function(){var t="number"==typeof this.fontSize?"".concat(this.fontSize,"px"):this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var r=e[n].trim();/([\"\'])[^\'\"]+\1/.test(r)||nr.includes(r)||(r='"'.concat(r,'"')),e[n]=r}return"".concat(this.fontStyle," ").concat(this.fontVariant," ").concat(this.fontWeight," ").concat(t," ").concat(e.join(","))}}]),t}();function ir(t){return"number"==typeof t?u.P6.hex2string(t):("string"==typeof t&&t.startsWith("0x")&&(t=t.replace("0x","#")),t)}function sr(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=ir(t[e]);return t}return ir(t)}function ar(t,e,n){for(var r in n)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}n(8702);var or={willReadFrequently:!0},ur=function(){function t(e,n,i,s,a,o,u,h,l){(0,r.Z)(this,t),this.text=e,this.style=n,this.width=i,this.height=s,this.lines=a,this.lineWidths=o,this.lineHeight=u,this.maxLineWidth=h,this.fontProperties=l}return(0,i.Z)(t,null,[{key:"measureText",value:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t._canvas;r=null==r?n.wordWrap:r;var s=n.toFontString(),a=t.measureFont(s);0===a.fontSize&&(a.fontSize=n.fontSize,a.ascent=n.fontSize);var o=i.getContext("2d",or);o.font=s;for(var u=r?t.wordWrap(e,n,i):e,h=u.split(/(?:\r\n|\r|\n)/),l=new Array(h.length),c=0,f=0;f<h.length;f++){var d=o.measureText(h[f]).width+(h[f].length-1)*n.letterSpacing;l[f]=d,c=Math.max(c,d)}var p=c+n.strokeThickness;n.dropShadow&&(p+=n.dropShadowDistance);var v=n.lineHeight||a.fontSize+n.strokeThickness,y=Math.max(v,a.fontSize+n.strokeThickness)+(h.length-1)*(v+n.leading);return n.dropShadow&&(y+=n.dropShadowDistance),new t(e,n,p,y,h,l,v+n.leading,c,a)}},{key:"wordWrap",value:function(e,n){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t._canvas,i=r.getContext("2d",or),s=0,a="",o="",u=Object.create(null),h=n.letterSpacing,l=n.whiteSpace,c=t.collapseSpaces(l),f=t.collapseNewlines(l),d=!c,p=n.wordWrapWidth+h,v=t.tokenize(e),y=0;y<v.length;y++){var m=v[y];if(t.isNewline(m)){if(!f){o+=t.addLine(a),d=!c,a="",s=0;continue}m=" "}if(c){var g=t.isBreakingSpace(m),x=t.isBreakingSpace(a[a.length-1]);if(g&&x)continue}var _=t.getFromCache(m,h,u,i);if(_>p)if(""!==a&&(o+=t.addLine(a),a="",s=0),t.canBreakWords(m,n.breakWords))for(var b=t.wordWrapSplit(m),w=0;w<b.length;w++){for(var E=b[w],T=1;b[w+T];){var k=b[w+T],A=E[E.length-1];if(t.canBreakChars(A,k,m,w,n.breakWords))break;E+=k,T++}w+=E.length-1;var R=t.getFromCache(E,h,u,i);R+s>p&&(o+=t.addLine(a),d=!1,a="",s=0),a+=E,s+=R}else{a.length>0&&(o+=t.addLine(a),a="",s=0);var S=y===v.length-1;o+=t.addLine(m,!S),d=!1,a="",s=0}else _+s>p&&(d=!1,o+=t.addLine(a),a="",s=0),(a.length>0||!t.isBreakingSpace(m)||d)&&(a+=m,s+=_)}return o+=t.addLine(a,!1)}},{key:"addLine",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e=t.trimRight(e),e=n?"".concat(e,"\n"):e}},{key:"getFromCache",value:function(t,e,n,r){var i=n[t];if("number"!=typeof i){var s=t.length*e;i=r.measureText(t).width+s,n[t]=i}return i}},{key:"collapseSpaces",value:function(t){return"normal"===t||"pre-line"===t}},{key:"collapseNewlines",value:function(t){return"normal"===t}},{key:"trimRight",value:function(e){if("string"!=typeof e)return"";for(var n=e.length-1;n>=0;n--){var r=e[n];if(!t.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}},{key:"isNewline",value:function(e){return"string"==typeof e&&t._newlines.includes(e.charCodeAt(0))}},{key:"isBreakingSpace",value:function(e,n){return"string"==typeof e&&t._breakingSpaces.includes(e.charCodeAt(0))}},{key:"tokenize",value:function(e){var n=[],r="";if("string"!=typeof e)return n;for(var i=0;i<e.length;i++){var s=e[i],a=e[i+1];t.isBreakingSpace(s,a)||t.isNewline(s)?(""!==r&&(n.push(r),r=""),n.push(s)):r+=s}return""!==r&&n.push(r),n}},{key:"canBreakWords",value:function(t,e){return e}},{key:"canBreakChars",value:function(t,e,n,r,i){return!0}},{key:"wordWrapSplit",value:function(t){return t.split("")}},{key:"measureFont",value:function(e){if(t._fonts[e])return t._fonts[e];var n={ascent:0,descent:0,fontSize:0},r=t._canvas,i=t._context;i.font=e;var s=t.METRICS_STRING+t.BASELINE_SYMBOL,a=Math.ceil(i.measureText(s).width),o=Math.ceil(i.measureText(t.BASELINE_SYMBOL).width),u=Math.ceil(t.HEIGHT_MULTIPLIER*o);o=o*t.BASELINE_MULTIPLIER|0,r.width=a,r.height=u,i.fillStyle="#f00",i.fillRect(0,0,a,u),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,o);var h=i.getImageData(0,0,a,u).data,l=h.length,c=4*a,f=0,d=0,p=!1;for(f=0;f<o;++f){for(var v=0;v<c;v+=4)if(255!==h[d+v]){p=!0;break}if(p)break;d+=c}for(n.ascent=o-f,d=l-c,p=!1,f=u;f>o;--f){for(var y=0;y<c;y+=4)if(255!==h[d+y]){p=!0;break}if(p)break;d-=c}return n.descent=f-o,n.fontSize=n.ascent+n.descent,t._fonts[e]=n,n}},{key:"clearMetrics",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e?delete t._fonts[e]:t._fonts={}}},{key:"_canvas",get:function(){if(!t.__canvas){var e;try{var n=new OffscreenCanvas(0,0),r=n.getContext("2d",or);if(null!=r&&r.measureText)return t.__canvas=n,n;e=u.Xd.ADAPTER.createCanvas()}catch(i){e=u.Xd.ADAPTER.createCanvas()}e.width=e.height=10,t.__canvas=e}return t.__canvas}},{key:"_context",get:function(){return t.__context||(t.__context=t._canvas.getContext("2d",or)),t.__context}}]),t}();function hr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}ur._fonts={},ur.METRICS_STRING="|q",ur.BASELINE_SYMBOL="M",ur.BASELINE_MULTIPLIER=1.4,ur.HEIGHT_MULTIPLIER=2,ur._newlines=[10,13],ur._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var lr={texture:!0,children:!1,baseTexture:!0},cr=function(t){(0,s.Z)(n,t);var e=hr(n);function n(t,i,s){var a;(0,r.Z)(this,n);var o=!1;s||(s=u.Xd.ADAPTER.createCanvas(),o=!0),s.width=3,s.height=3;var h=u.xE.from(s);return h.orig=new u.Ae,h.trim=new u.Ae,(a=e.call(this,h))._ownCanvas=o,a.canvas=s,a.context=s.getContext("2d",{willReadFrequently:!0}),a._resolution=u.Xd.RESOLUTION,a._autoResolution=!0,a._text=null,a._style=null,a._styleListener=null,a._font="",a.text=t,a.style=i,a.localStyleID=-1,a}return(0,i.Z)(n,[{key:"updateText",value:function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var n,r,i=this.context,s=ur.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=s.width,o=s.height,h=s.lines,l=s.lineHeight,c=s.lineWidths,f=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,a)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+2*e.padding)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;for(var p=e.dropShadow?2:1,v=0;v<p;++v){var y=e.dropShadow&&0===v,m=y?Math.ceil(Math.max(1,o)+2*e.padding):0,g=m*this._resolution;if(y){i.fillStyle="black",i.strokeStyle="black";var x=e.dropShadowColor,_=u.P6.hex2rgb("number"==typeof x?x:u.P6.string2hex(x)),b=e.dropShadowBlur*this._resolution,w=e.dropShadowDistance*this._resolution;i.shadowColor="rgba(".concat(255*_[0],",").concat(255*_[1],",").concat(255*_[2],",").concat(e.dropShadowAlpha,")"),i.shadowBlur=b,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*w,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*w+g}else i.fillStyle=this._generateFillStyle(e,h,s),i.strokeStyle=e.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;var E=(l-d.fontSize)/2;l-d.fontSize<0&&(E=0);for(var T=0;T<h.length;T++)n=e.strokeThickness/2,r=e.strokeThickness/2+T*l+d.ascent+E,"right"===e.align?n+=f-c[T]:"center"===e.align&&(n+=(f-c[T])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(h[T],n+e.padding,r+e.padding-m,!0),e.fill&&this.drawLetterSpacing(h[T],n+e.padding,r+e.padding-m)}this.updateTexture()}}},{key:"drawLetterSpacing",value:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this._style,a=s.letterSpacing,o=n.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(0===a||o)return o&&(this.context.letterSpacing=a,this.context.textLetterSpacing=a),void(i?this.context.strokeText(t,e,r):this.context.fillText(t,e,r));for(var u=e,h=Array.from?Array.from(t):t.split(""),l=this.context.measureText(t).width,c=0,f=0;f<h.length;++f){var d=h[f];i?this.context.strokeText(d,u,r):this.context.fillText(d,u,r);for(var p="",v=f+1;v<h.length;++v)p+=h[v];u+=l-(c=this.context.measureText(p).width)+a,l=c}}},{key:"updateTexture",value:function(){var t=this.canvas;if(this._style.trim){var e=u.P6.trimCanvas(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var n=this._texture,r=this._style,i=r.trim?0:r.padding,s=n.baseTexture;n.trim.width=n._frame.width=t.width/this._resolution,n.trim.height=n._frame.height=t.height/this._resolution,n.trim.x=-i,n.trim.y=-i,n.orig.width=n._frame.width-2*i,n.orig.height=n._frame.height-2*i,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),n.updateUvs(),this.dirty=!1}},{key:"_render",value:function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),(0,k.Z)((0,o.Z)(n.prototype),"_render",this).call(this,t)}},{key:"updateTransform",value:function(){this.updateText(!0),(0,k.Z)((0,o.Z)(n.prototype),"updateTransform",this).call(this)}},{key:"getBounds",value:function(t,e){return this.updateText(!0),-1===this._textureID&&(t=!1),(0,k.Z)((0,o.Z)(n.prototype),"getBounds",this).call(this,t,e)}},{key:"getLocalBounds",value:function(t){return this.updateText(!0),(0,k.Z)((0,o.Z)(n.prototype),"getLocalBounds",this).call(this,t)}},{key:"_calculateBounds",value:function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}},{key:"_generateFillStyle",value:function(t,e,n){var r,i=t.fill;if(!Array.isArray(i))return i;if(1===i.length)return i[0];var s=t.dropShadow?t.dropShadowDistance:0,a=t.padding||0,o=this.canvas.width/this._resolution-s-2*a,u=this.canvas.height/this._resolution-s-2*a,h=i.slice(),l=t.fillGradientStops.slice();if(!l.length)for(var c=h.length+1,f=1;f<c;++f)l.push(f/c);if(h.unshift(i[0]),l.unshift(0),h.push(i[i.length-1]),l.push(1),t.fillGradientType===tr.LINEAR_VERTICAL){r=this.context.createLinearGradient(o/2,a,o/2,u+a);for(var d=n.fontProperties.fontSize+t.strokeThickness,p=0;p<e.length;p++){var v=n.lineHeight*(p-1)+d,y=n.lineHeight*p,m=y;p>0&&v>y&&(m=(y+v)/2);var g=y+d,x=n.lineHeight*(p+1),_=g;p+1<e.length&&x<g&&(_=(g+x)/2);for(var b=(_-m)/u,w=0;w<h.length;w++){var E=0;E="number"==typeof l[w]?l[w]:w/h.length;var T=Math.min(1,Math.max(0,m/u+E*b));T=Number(T.toFixed(5)),r.addColorStop(T,h[w])}}}else{r=this.context.createLinearGradient(a,u/2,o+a,u/2);for(var k=h.length+1,A=1,R=0;R<h.length;R++){var S=void 0;S="number"==typeof l[R]?l[R]:A/k,r.addColorStop(S,h[R]),A++}}return r}},{key:"destroy",value:function(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},lr,t),(0,k.Z)((0,o.Z)(n.prototype),"destroy",this).call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}},{key:"width",get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=u.P6.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}},{key:"height",get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=u.P6.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}},{key:"style",get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof rr?t:new rr(t),this.localStyleID=-1,this.dirty=!0}},{key:"text",get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)}},{key:"resolution",get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}}]),n}(P),fr=cr;fr.experimentalLetterSpacing=!1;var dr=function(){function t(e){(0,r.Z)(this,t),this.maxItemsPerFrame=e,this.itemsLeft=0}return(0,i.Z)(t,[{key:"beginFrame",value:function(){this.itemsLeft=this.maxItemsPerFrame}},{key:"allowedToUpload",value:function(){return this.itemsLeft-- >0}}]),t}();function pr(t,e){var n,r=!1;if(null!=t&&null!==(n=t._textures)&&void 0!==n&&n.length)for(var i=0;i<t._textures.length;i++)if(t._textures[i]instanceof u.xE){var s=t._textures[i].baseTexture;e.includes(s)||(e.push(s),r=!0)}return r}function vr(t,e){if(t.baseTexture instanceof u.VL){var n=t.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function yr(t,e){if(t._texture&&t._texture instanceof u.xE){var n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function mr(t,e){return e instanceof fr&&(e.updateText(!0),!0)}function gr(t,e){if(e instanceof rr){var n=e.toFontString();return ur.measureFont(n),!0}return!1}function xr(t,e){if(t instanceof fr){e.includes(t.style)||e.push(t.style),e.includes(t)||e.push(t);var n=t._texture.baseTexture;return e.includes(n)||e.push(n),!0}return!1}function _r(t,e){return t instanceof rr&&(e.includes(t)||e.push(t),!0)}function br(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}function wr(t,e){return e instanceof u.VL&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function Er(t,e){if(!(e instanceof Mn))return!1;var n=e.geometry;e.finishPoly(),n.updateBatches();for(var r=n.batches,i=0;i<r.length;i++){var s=r[i].style.texture;s&&wr(t,s.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function Tr(t,e){return t instanceof Mn&&(e.push(t),!0)}var kr=function(t){(0,s.Z)(n,t);var e=br(n);function n(t){var i;return(0,r.Z)(this,n),(i=e.call(this,t)).uploadHookHelper=i.renderer,i.registerFindHook(Tr),i.registerUploadHook(wr),i.registerUploadHook(Er),i}return(0,i.Z)(n)}(function(){function t(e){var n=this;(0,r.Z)(this,t),this.limiter=new dr(u.Xd.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){n.queue&&n.prepareItems()},this.registerFindHook(xr),this.registerFindHook(_r),this.registerFindHook(pr),this.registerFindHook(vr),this.registerFindHook(yr),this.registerUploadHook(mr),this.registerUploadHook(gr)}return(0,i.Z)(t,[{key:"upload",value:function(t){var e=this;return new Promise((function(n){t&&e.add(t),e.queue.length?(e.completes.push(n),e.ticking||(e.ticking=!0,u.vB.system.addOnce(e.tick,e,u.uF.UTILITY))):n()}))}},{key:"tick",value:function(){setTimeout(this.delayedTick,0)}},{key:"prepareItems",value:function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var n=0,r=this.uploadHooks.length;n<r;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)u.vB.system.addOnce(this.tick,this,u.uF.UTILITY);else{this.ticking=!1;var i=this.completes.slice(0);this.completes.length=0;for(var s=0,a=i.length;s<a;s++)i[s]()}}},{key:"registerFindHook",value:function(t){return t&&this.addHooks.push(t),this}},{key:"registerUploadHook",value:function(t){return t&&this.uploadHooks.push(t),this}},{key:"add",value:function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof A.W2)for(var r=t.children.length-1;r>=0;r--)this.add(t.children[r]);return this}},{key:"destroy",value:function(){this.ticking&&u.vB.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}}]),t}());kr.extension={name:"prepare",type:u.nw.RendererSystem},u.Rw.add(kr);var Ar=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,r.Z)(this,t),this.linkedSheets=[],this._texture=e instanceof u.xE?e:null,this.baseTexture=e instanceof u.VL?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=n;var s=this.baseTexture.resource;this.resolution=this._updateResolution(i||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return(0,i.Z)(t,[{key:"_updateResolution",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.data.meta.scale,n=u.P6.getResolutionOfUrl(t,null);return null===n&&(n=parseFloat(null!=e?e:"1")),1!==n&&this.baseTexture.setResolution(n),n}},{key:"parse",value:function(){var e=this;return new Promise((function(n){e._callback=n,e._batchIndex=0,e._frameKeys.length<=t.BATCH_SIZE?(e._processFrames(0),e._processAnimations(),e._parseComplete()):e._nextBatch()}))}},{key:"_processFrames",value:function(e){for(var n=e,r=t.BATCH_SIZE;n-e<r&&n<this._frameKeys.length;){var i=this._frameKeys[n],s=this._frames[i],a=s.frame;if(a){var o=null,h=null,l=!1!==s.trimmed&&s.sourceSize?s.sourceSize:s.frame,c=new u.Ae(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);o=s.rotated?new u.Ae(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):new u.Ae(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),!1!==s.trimmed&&s.spriteSourceSize&&(h=new u.Ae(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[i]=new u.xE(this.baseTexture,o,c,h,s.rotated?2:0,s.anchor),u.xE.addToCache(this.textures[i],i)}n++}}},{key:"_processAnimations",value:function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var r=t[e][n];this.animations[e].push(this.textures[r])}}}},{key:"_parseComplete",value:function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}},{key:"_nextBatch",value:function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())}),0)}},{key:"destroy",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var n in this.textures)this.textures[n].destroy();(this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e)&&(null===(t=this._texture)||void 0===t||t.destroy(),this.baseTexture.destroy());this._texture=null,this.baseTexture=null,this.linkedSheets=[]}}]),t}(),Rr=Ar;function Sr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ir(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ir(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function Ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Rr.BATCH_SIZE=1e3;var Pr=["jpg","png","jpeg","avif","webp"];function Mr(t,e,n){var r={};if(t.forEach((function(t){r[t]=e})),Object.keys(e.textures).forEach((function(t){r[t]=e.textures[t]})),!n){var i=u.P6.path.dirname(t[0]);e.linkedSheets.forEach((function(t,n){var s=Mr(["".concat(i,"/").concat(e.data.meta.related_multi_packs[n])],t,!0);Object.assign(r,s)}))}return r}var Cr={extension:u.nw.Asset,cache:{test:function(t){return t instanceof Rr},getCacheableAssets:function(t,e){return Mr(t,e,!1)}},resolver:{test:function(t){var e=t.split("?")[0].split("."),n=e.pop(),r=e.pop();return"json"===n&&Pr.includes(r)},parse:function(t){var e,n,r=t.split(".");return{resolution:parseFloat(null!==(e=null===(n=u.Xd.RETINA_PREFIX.exec(t))||void 0===n?void 0:n[1])&&void 0!==e?e:"1"),format:r[r.length-2],src:t}}},loader:{extension:{type:u.nw.LoadParser,priority:vt.Normal},testParse:function(t,e){return(0,$.Z)(J().mark((function n(){return J().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",u.P6.path.extname(e.src).includes(".json")&&!!t.frames);case 1:case"end":return n.stop()}}),n)})))()},parse:function(t,e,n){return(0,$.Z)(J().mark((function r(){var i,s,a,o,h,l,c,f,d,p,v,y,m,g;return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(s=u.P6.path.dirname(e.src))&&s.lastIndexOf("/")!==s.length-1&&(s+="/"),a=s+t.meta.image,r.next=5,n.load([a]);case 5:return o=r.sent,h=o[a],l=new Rr(h.baseTexture,t,e.src),r.next=10,l.parse();case 10:if(c=null==t||null===(i=t.meta)||void 0===i?void 0:i.related_multi_packs,!Array.isArray(c)){r.next=39;break}f=[],d=Sr(c),r.prev=14,d.s();case 16:if((p=d.n()).done){r.next=26;break}if("string"==typeof(y=p.value)){r.next=20;break}return r.abrupt("continue",24);case 20:if(m=s+y,null===(v=e.data)||void 0===v||!v.ignoreMultiPack){r.next=23;break}return r.abrupt("continue",24);case 23:f.push(n.load({src:m,data:{ignoreMultiPack:!0}}));case 24:r.next=16;break;case 26:r.next=31;break;case 28:r.prev=28,r.t0=r.catch(14),d.e(r.t0);case 31:return r.prev=31,d.f(),r.finish(31);case 34:return r.next=36,Promise.all(f);case 36:g=r.sent,l.linkedSheets=g,g.forEach((function(t){t.linkedSheets=[l].concat(l.linkedSheets.filter((function(e){return e!==t})))}));case 39:return r.abrupt("return",l);case 40:case"end":return r.stop()}}),r,null,[[14,28,31,34]])})))()},unload:function(t){t.destroy(!0)}}};u.Rw.add(Cr);function Or(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var Dr=new u.E9,Br=function(t){(0,s.Z)(n,t);var e=Or(n);function n(t){var i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return(0,r.Z)(this,n),(i=e.call(this,t)).tileTransform=new u.wx,i._width=s,i._height=a,i.uvMatrix=i.texture.uvMatrix||new u.UX(t),i.pluginName="tilingSprite",i.uvRespectAnchor=!1,i}return(0,i.Z)(n,[{key:"clampMargin",get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)}},{key:"tileScale",get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)}},{key:"tilePosition",get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)}},{key:"_onTextureUpdate",value:function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}},{key:"_render",value:function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))}},{key:"_calculateBounds",value:function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,n,r)}},{key:"getLocalBounds",value:function(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new u.Ae),t=this._localBoundsRect),this._bounds.getRectangle(t)):(0,k.Z)((0,o.Z)(n.prototype),"getLocalBounds",this).call(this,t)}},{key:"containsPoint",value:function(t){this.worldTransform.applyInverse(t,Dr);var e=this._width,n=this._height,r=-e*this.anchor._x;if(Dr.x>=r&&Dr.x<r+e){var i=-n*this.anchor._y;if(Dr.y>=i&&Dr.y<i+n)return!0}return!1}},{key:"destroy",value:function(t){(0,k.Z)((0,o.Z)(n.prototype),"destroy",this).call(this,t),this.tileTransform=null,this.uvMatrix=null}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}}],[{key:"from",value:function(t,e){return new n(t instanceof u.xE?t:u.xE.from(t,e),e.width,e.height)}}]),n}(P),Nr="#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n";function Lr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var Zr=new u.y3,Fr=function(t){(0,s.Z)(n,t);var e=Lr(n);function n(t){var i;return(0,r.Z)(this,n),i=e.call(this,t),t.runners.contextChange.add((0,T.Z)(i)),i.quad=new u.ud,i.state=u.ZM.for2d(),i}return(0,i.Z)(n,[{key:"contextChange",value:function(){var t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=u.ex.from(Nr,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",e),this.shader=t.context.webGLVersion>1?u.ex.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",e):u.ex.from(Nr,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",e)}},{key:"render",value:function(t){var e=this.renderer,n=this.quad,r=n.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);var i=t.uvRespectAnchor?t.anchor.x:0,s=t.uvRespectAnchor?t.anchor.y:0;(r=n.uvs)[0]=r[6]=-i,r[1]=r[3]=-s,r[2]=r[4]=1-i,r[5]=r[7]=1-s,n.invalidate();var a=t._texture,o=a.baseTexture,h=o.alphaMode>0,l=t.tileTransform.localTransform,c=t.uvMatrix,f=o.isPowerOfTwo&&a.frame.width===o.width&&a.frame.height===o.height;f&&(o._glTextures[e.CONTEXT_UID]?f=o.wrapMode!==u.Nt.CLAMP:o.wrapMode===u.Nt.CLAMP&&(o.wrapMode=u.Nt.REPEAT));var d=f?this.simpleShader:this.shader,p=a.width,v=a.height,y=t._width,m=t._height;Zr.set(l.a*p/y,l.b*p/m,l.c*v/y,l.d*v/m,l.tx/y,l.ty/m),Zr.invert(),f?Zr.prepend(c.mapCoord):(d.uniforms.uMapCoord=c.mapCoord.toArray(!0),d.uniforms.uClampFrame=c.uClampFrame,d.uniforms.uClampOffset=c.uClampOffset),d.uniforms.uTransform=Zr.toArray(!0),d.uniforms.uColor=u.P6.premultiplyTintToRgba(t.tint,t.worldAlpha,d.uniforms.uColor,h),d.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),d.uniforms.uSampler=a,e.shader.bind(d),e.geometry.bind(n),this.state.blendMode=u.P6.correctBlendMode(t.blendMode,h),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}]),n}(u.bO);Fr.extension={name:"tilingSprite",type:u.nw.RendererPlugin},u.Rw.add(Fr);var Ur=n(4925),Gr=(0,i.Z)((function t(){(0,r.Z)(this,t),this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]})),Hr=function(){function t(){(0,r.Z)(this,t)}return(0,i.Z)(t,null,[{key:"test",value:function(t){return"string"==typeof t&&t.startsWith("info face=")}},{key:"parse",value:function(t){var e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var r in e){var i=e[r].match(/^[a-z]+/gm)[0],s=e[r].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var o in s){var u=s[o].split("="),h=u[0],l=u[1].replace(/"/gm,""),c=parseFloat(l),f=isNaN(c)?l:c;a[h]=f}n[i].push(a)}var d=new Gr;return n.info.forEach((function(t){return d.info.push({face:t.face,size:parseInt(t.size,10)})})),n.common.forEach((function(t){return d.common.push({lineHeight:parseInt(t.lineHeight,10)})})),n.page.forEach((function(t){return d.page.push({id:parseInt(t.id,10),file:t.file})})),n.char.forEach((function(t){return d.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})})),n.kerning.forEach((function(t){return d.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})})),n.distanceField.forEach((function(t){return d.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType})})),d}}]),t}(),Xr=function(){function t(){(0,r.Z)(this,t)}return(0,i.Z)(t,null,[{key:"test",value:function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")}},{key:"parse",value:function(t){for(var e=new Gr,n=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),i=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),o=t.getElementsByTagName("distanceField"),u=0;u<n.length;u++)e.info.push({face:n[u].getAttribute("face"),size:parseInt(n[u].getAttribute("size"),10)});for(var h=0;h<r.length;h++)e.common.push({lineHeight:parseInt(r[h].getAttribute("lineHeight"),10)});for(var l=0;l<i.length;l++)e.page.push({id:parseInt(i[l].getAttribute("id"),10)||0,file:i[l].getAttribute("file")});for(var c=0;c<s.length;c++){var f=s[c];e.char.push({id:parseInt(f.getAttribute("id"),10),page:parseInt(f.getAttribute("page"),10)||0,x:parseInt(f.getAttribute("x"),10),y:parseInt(f.getAttribute("y"),10),width:parseInt(f.getAttribute("width"),10),height:parseInt(f.getAttribute("height"),10),xoffset:parseInt(f.getAttribute("xoffset"),10),yoffset:parseInt(f.getAttribute("yoffset"),10),xadvance:parseInt(f.getAttribute("xadvance"),10)})}for(var d=0;d<a.length;d++)e.kerning.push({first:parseInt(a[d].getAttribute("first"),10),second:parseInt(a[d].getAttribute("second"),10),amount:parseInt(a[d].getAttribute("amount"),10)});for(var p=0;p<o.length;p++)e.distanceField.push({fieldType:o[p].getAttribute("fieldType"),distanceRange:parseInt(o[p].getAttribute("distanceRange"),10)});return e}}]),t}(),Wr=function(){function t(){(0,r.Z)(this,t)}return(0,i.Z)(t,null,[{key:"test",value:function(t){if("string"==typeof t&&t.includes("<font>")){var e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return Xr.test(e)}return!1}},{key:"parse",value:function(t){var e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return Xr.parse(e)}}]),t}(),jr=[Hr,Xr,Wr];function zr(t,e,n,r,i,s,a){var o=n.text,h=n.fontProperties;e.translate(r,i),e.scale(s,s);var l=a.strokeThickness/2,c=-a.strokeThickness/2;if(e.font=a.toFontString(),e.lineWidth=a.strokeThickness,e.textBaseline=a.textBaseline,e.lineJoin=a.lineJoin,e.miterLimit=a.miterLimit,e.fillStyle=function(t,e,n,r,i,s){var a,o=n.fill;if(!Array.isArray(o))return o;if(1===o.length)return o[0];var u=n.dropShadow?n.dropShadowDistance:0,h=n.padding||0,l=t.width/r-u-2*h,c=t.height/r-u-2*h,f=o.slice(),d=n.fillGradientStops.slice();if(!d.length)for(var p=f.length+1,v=1;v<p;++v)d.push(v/p);if(f.unshift(o[0]),d.unshift(0),f.push(o[o.length-1]),d.push(1),n.fillGradientType===tr.LINEAR_VERTICAL){a=e.createLinearGradient(l/2,h,l/2,c+h);for(var y=0,m=(s.fontProperties.fontSize+n.strokeThickness)/c,g=0;g<i.length;g++)for(var x=s.lineHeight*g,_=0;_<f.length;_++){var b=x/c+("number"==typeof d[_]?d[_]:_/f.length)*m,w=Math.max(y,b);w=Math.min(w,1),a.addColorStop(w,f[_]),y=w}}else{a=e.createLinearGradient(h,c/2,l+h,c/2);for(var E=f.length+1,T=1,k=0;k<f.length;k++){var A=void 0;A="number"==typeof d[k]?d[k]:T/E,a.addColorStop(A,f[k]),T++}}return a}(t,e,a,s,[o],n),e.strokeStyle=a.stroke,a.dropShadow){var f=a.dropShadowColor,d=u.P6.hex2rgb("number"==typeof f?f:u.P6.string2hex(f)),p=a.dropShadowBlur*s,v=a.dropShadowDistance*s;e.shadowColor="rgba(".concat(255*d[0],",").concat(255*d[1],",").concat(255*d[2],",").concat(a.dropShadowAlpha,")"),e.shadowBlur=p,e.shadowOffsetX=Math.cos(a.dropShadowAngle)*v,e.shadowOffsetY=Math.sin(a.dropShadowAngle)*v}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;a.stroke&&a.strokeThickness&&e.strokeText(o,l,c+n.lineHeight-h.descent),a.fill&&e.fillText(o,l,c+n.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function Vr(t){return Array.from?Array.from(t):t.split("")}function Yr(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}var Kr=["chars","padding","resolution","textureWidth","textureHeight"];function qr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qr(Object(n),!0).forEach((function(e){(0,gt.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qr=function(){function t(e,n,i){var s,a;(0,r.Z)(this,t);var o=(0,ft.Z)(e.info,1)[0],h=(0,ft.Z)(e.common,1)[0],l=(0,ft.Z)(e.page,1)[0],c=(0,ft.Z)(e.distanceField,1)[0],f=u.P6.getResolutionOfUrl(l.file),d={};this._ownsTextures=i,this.font=o.face,this.size=o.size,this.lineHeight=h.lineHeight/f,this.chars={},this.pageTextures=d;for(var p=0;p<e.page.length;p++){var v=e.page[p],y=v.id,m=v.file;d[y]=n instanceof Array?n[p]:n[m],null!=c&&c.fieldType&&"none"!==c.fieldType&&(d[y].baseTexture.alphaMode=u.iw.NO_PREMULTIPLIED_ALPHA,d[y].baseTexture.mipmap=u.KI.OFF)}for(var g=0;g<e.char.length;g++){var x=e.char[g],_=x.id,b=x.page,w=e.char[g],E=w.x,T=w.y,k=w.width,A=w.height,R=w.xoffset,S=w.yoffset,I=w.xadvance;E/=f,T/=f,k/=f,A/=f,R/=f,S/=f,I/=f;var P=new u.Ae(E+d[b].frame.x/f,T+d[b].frame.y/f,k,A);this.chars[_]={xOffset:R,yOffset:S,xAdvance:I,kerning:{},texture:new u.xE(d[b].baseTexture,P),page:b}}for(var M=0;M<e.kerning.length;M++){var C=e.kerning[M],O=C.first,D=C.second,B=C.amount;O/=f,D/=f,B/=f,this.chars[D]&&(this.chars[D].kerning[O]=B)}this.distanceFieldRange=null==c?void 0:c.distanceRange,this.distanceFieldType=null!==(s=null==c||null===(a=c.fieldType)||void 0===a?void 0:a.toLowerCase())&&void 0!==s?s:"none"}return(0,i.Z)(t,[{key:"destroy",value:function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}}],[{key:"install",value:function(e,n,r){var i;if(e instanceof Gr)i=e;else{var s=function(t){for(var e=0;e<jr.length;e++)if(jr[e].test(t))return jr[e];return null}(e);if(!s)throw new Error("Unrecognized data format for font.");i=s.parse(e)}n instanceof u.xE&&(n=[n]);var a=new t(i,n,r);return t.available[a.font]=a,a}},{key:"uninstall",value:function(e){var n=t.available[e];if(!n)throw new Error("No font found named '".concat(e,"'"));n.destroy(),delete t.available[e]}},{key:"from",value:function(e,n,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var i=Object.assign({},t.defaultOptions,r),s=i.chars,a=i.padding,o=i.resolution,h=i.textureWidth,l=i.textureHeight,c=(0,Ur.Z)(i,Kr),f=function(t){"string"==typeof t&&(t=[t]);for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(Array.isArray(i)){if(2!==i.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got ".concat(i.length,"."));var s=i[0].charCodeAt(0),a=i[1].charCodeAt(0);if(a<s)throw new Error("[BitmapFont]: Invalid character range.");for(var o=s,u=a;o<=u;o++)e.push(String.fromCharCode(o))}else e.push.apply(e,(0,q.Z)(Vr(i)))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(s),d=n instanceof rr?n:new rr(n),p=h,v=new Gr;v.info[0]={face:d.fontFamily,size:d.fontSize},v.common[0]={lineHeight:d.fontSize};for(var y,m,g,x=0,_=0,b=0,w=[],E=[],T=0;T<f.length;T++){y||((y=u.Xd.ADAPTER.createCanvas()).width=h,y.height=l,m=y.getContext("2d"),g=new u.VL(y,$r({resolution:o},c)),w.push(g),E.push(new u.xE(g)),v.page.push({id:E.length-1,file:""}));var k=f[T],A=ur.measureText(k,d,!1,y),R=A.width,S=Math.ceil(A.height),I=Math.ceil(("italic"===d.fontStyle?2:1)*R);if(_>=l-S*o){if(0===_)throw new Error("[BitmapFont] textureHeight ".concat(l,"px is too small (fontFamily: '").concat(d.fontFamily,"', fontSize: ").concat(d.fontSize,"px, char: '").concat(k,"')"));--T,y=null,m=null,g=null,_=0,x=0,b=0}else if(b=Math.max(S+A.fontProperties.descent,b),I*o+x>=p){if(0===x)throw new Error("[BitmapFont] textureWidth ".concat(h,"px is too small (fontFamily: '").concat(d.fontFamily,"', fontSize: ").concat(d.fontSize,"px, char: '").concat(k,"')"));--T,_+=b*o,_=Math.ceil(_),x=0,b=0}else{zr(y,m,A,x,_,o,d);var P=Yr(A.text);v.char.push({id:P,page:E.length-1,x:x/o,y:_/o,width:I,height:S,xoffset:0,yoffset:0,xadvance:Math.ceil(R-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0))}),x+=(I+2*a)*o,x=Math.ceil(x)}}for(var M=0,C=f.length;M<C;M++)for(var O=f[M],D=0;D<C;D++){var B=f[D],N=m.measureText(O).width,L=m.measureText(B).width,Z=m.measureText(O+B).width-(N+L);Z&&v.kerning.push({first:Yr(O),second:Yr(B),amount:Z})}var F=new t(v,E,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=F,F}}]),t}(),Jr=Qr;Jr.ALPHA=[["a","z"],["A","Z"]," "],Jr.NUMERIC=[["0","9"]],Jr.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Jr.ASCII=[[" ","~"]],Jr.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Qr.ALPHANUMERIC},Jr.available={};function ti(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ei(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ei(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function ei(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ni(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,o.Z)(t);if(e){var i=(0,o.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.Z)(this,n)}}var ri=[],ii=[],si=[],ai=function(t){(0,s.Z)(n,t);var e=ni(n);function n(t){var i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.Z)(this,n),(i=e.call(this))._tint=16777215;var a=Object.assign({},n.styleDefaults,s),o=a.align,h=a.tint,l=a.maxWidth,c=a.letterSpacing,f=a.fontName,d=a.fontSize;if(!Jr.available[f])throw new Error('Missing BitmapFont "'.concat(f,'"'));return i._activePagesMeshData=[],i._textWidth=0,i._textHeight=0,i._align=o,i._tint=h,i._font=void 0,i._fontName=f,i._fontSize=d,i.text=t,i._maxWidth=l,i._maxLineHeight=0,i._letterSpacing=c,i._anchor=new u.AB((function(){i.dirty=!0}),(0,T.Z)(i),0,0),i._roundPixels=u.Xd.ROUND_PIXELS,i.dirty=!0,i._resolution=u.Xd.RESOLUTION,i._autoResolution=!0,i._textureCache={},i}return(0,i.Z)(n,[{key:"updateText",value:function(){for(var t=Jr.available[this._fontName],e=this.fontSize,n=e/t.size,r=new u.E9,i=[],s=[],a=[],o=Vr(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),h=this._maxWidth*t.size/e,l="none"===t.distanceFieldType?ri:ii,c=null,f=0,d=0,p=0,v=-1,y=0,m=0,g=0,x=0,_=0;_<o.length;_++){var b=o[_],w=Yr(b);if(/(?:\s)/.test(b)&&(v=_,y=f,x++),"\r"!==b&&"\n"!==b){var E=t.chars[w];if(E){c&&E.kerning[c]&&(r.x+=E.kerning[c]);var T=si.pop()||{texture:u.xE.EMPTY,line:0,charCode:0,prevSpaces:0,position:new u.E9};T.texture=E.texture,T.line=p,T.charCode=w,T.position.x=r.x+E.xOffset+this._letterSpacing/2,T.position.y=r.y+E.yOffset,T.prevSpaces=x,i.push(T),f=T.position.x+Math.max(E.xAdvance-E.xOffset,E.texture.orig.width),r.x+=E.xAdvance+this._letterSpacing,g=Math.max(g,E.yOffset+E.texture.height),c=w,-1!==v&&h>0&&r.x>h&&(++m,u.P6.removeItems(i,1+v-m,1+_-v),_=v,v=-1,s.push(y),a.push(i.length>0?i[i.length-1].prevSpaces:0),d=Math.max(d,y),p++,r.x=0,r.y+=t.lineHeight,c=null,x=0)}}else s.push(f),a.push(-1),d=Math.max(d,f),++p,++m,r.x=0,r.y+=t.lineHeight,c=null,x=0}var k=o[o.length-1];"\r"!==k&&"\n"!==k&&(/(?:\s)/.test(k)&&(f=y),s.push(f),d=Math.max(d,f),a.push(-1));for(var A=[],R=0;R<=p;R++){var S=0;"right"===this._align?S=d-s[R]:"center"===this._align?S=(d-s[R])/2:"justify"===this._align&&(S=a[R]<0?0:(d-s[R])/a[R]),A.push(S)}var I=i.length,P={},M=[],C=this._activePagesMeshData;l.push.apply(l,(0,q.Z)(C));for(var O=0;O<I;O++){var D=i[O].texture,B=D.baseTexture.uid;if(!P[B]){var N=l.pop();if(!N){var L=new Gn,Z=void 0,F=void 0;"none"===t.distanceFieldType?(Z=new Fn(u.xE.EMPTY),F=u.T$.NORMAL):(Z=new Fn(u.xE.EMPTY,{program:u.$r.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r\n\r\n}\r\n"),uniforms:{uFWidth:0}}),F=u.T$.NORMAL_NPM);var U=new Ln(L,Z);U.blendMode=F,N={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:U,vertices:null,uvs:null,indices:null}}N.index=0,N.indexCount=0,N.vertexCount=0,N.uvsCount=0,N.total=0;var G=this._textureCache;G[B]=G[B]||new u.xE(D.baseTexture),N.mesh.texture=G[B],N.mesh.tint=this._tint,M.push(N),P[B]=N}P[B].total++}for(var H=0;H<C.length;H++)M.includes(C[H])||this.removeChild(C[H].mesh);for(var X=0;X<M.length;X++)M[X].mesh.parent!==this&&this.addChild(M[X].mesh);for(var W in this._activePagesMeshData=M,P){var j,z=P[W],V=z.total;if(!((null===(j=z.indices)||void 0===j?void 0:j.length)>6*V)||z.vertices.length<2*Ln.BATCHABLE_SIZE)z.vertices=new Float32Array(8*V),z.uvs=new Float32Array(8*V),z.indices=new Uint16Array(6*V);else for(var Y=z.total,K=z.vertices,$=4*Y*2;$<K.length;$++)K[$]=0;z.mesh.size=6*V}for(var Q=0;Q<I;Q++){var J=i[Q],tt=J.position.x+A[J.line]*("justify"===this._align?J.prevSpaces:1);this._roundPixels&&(tt=Math.round(tt));var et=tt*n,nt=J.position.y*n,rt=J.texture,it=P[rt.baseTexture.uid],st=rt.frame,at=rt._uvs,ot=it.index++;it.indices[6*ot+0]=0+4*ot,it.indices[6*ot+1]=1+4*ot,it.indices[6*ot+2]=2+4*ot,it.indices[6*ot+3]=0+4*ot,it.indices[6*ot+4]=2+4*ot,it.indices[6*ot+5]=3+4*ot,it.vertices[8*ot+0]=et,it.vertices[8*ot+1]=nt,it.vertices[8*ot+2]=et+st.width*n,it.vertices[8*ot+3]=nt,it.vertices[8*ot+4]=et+st.width*n,it.vertices[8*ot+5]=nt+st.height*n,it.vertices[8*ot+6]=et,it.vertices[8*ot+7]=nt+st.height*n,it.uvs[8*ot+0]=at.x0,it.uvs[8*ot+1]=at.y0,it.uvs[8*ot+2]=at.x1,it.uvs[8*ot+3]=at.y1,it.uvs[8*ot+4]=at.x2,it.uvs[8*ot+5]=at.y2,it.uvs[8*ot+6]=at.x3,it.uvs[8*ot+7]=at.y3}for(var ut in this._textWidth=d*n,this._textHeight=(r.y+t.lineHeight)*n,P){var ht=P[ut];if(0!==this.anchor.x||0!==this.anchor.y)for(var lt=0,ct=this._textWidth*this.anchor.x,ft=this._textHeight*this.anchor.y,dt=0;dt<ht.total;dt++)ht.vertices[lt++]-=ct,ht.vertices[lt++]-=ft,ht.vertices[lt++]-=ct,ht.vertices[lt++]-=ft,ht.vertices[lt++]-=ct,ht.vertices[lt++]-=ft,ht.vertices[lt++]-=ct,ht.vertices[lt++]-=ft;this._maxLineHeight=g*n;var pt=ht.mesh.geometry.getBuffer("aVertexPosition"),vt=ht.mesh.geometry.getBuffer("aTextureCoord"),yt=ht.mesh.geometry.getIndex();pt.data=ht.vertices,vt.data=ht.uvs,yt.data=ht.indices,pt.update(),vt.update(),yt.update()}for(var mt=0;mt<i.length;mt++)si.push(i[mt]);this._font=t,this.dirty=!1}},{key:"updateTransform",value:function(){this.validate(),this.containerUpdateTransform()}},{key:"_render",value:function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);var e=Jr.available[this._fontName],r=e.distanceFieldRange,i=e.distanceFieldType,s=e.size;if("none"!==i){var a,u=this.worldTransform,h=u.a,l=u.b,c=u.c,f=u.d,d=Math.sqrt(h*h+l*l),p=Math.sqrt(c*c+f*f),v=(Math.abs(d)+Math.abs(p))/2,y=this.fontSize/s,m=t._view.resolution,g=ti(this._activePagesMeshData);try{for(g.s();!(a=g.n()).done;){a.value.mesh.shader.uniforms.uFWidth=v*r*y*m}}catch(x){g.e(x)}finally{g.f()}}(0,k.Z)((0,o.Z)(n.prototype),"_render",this).call(this,t)}},{key:"getLocalBounds",value:function(){return this.validate(),(0,k.Z)((0,o.Z)(n.prototype),"getLocalBounds",this).call(this)}},{key:"validate",value:function(){var t=Jr.available[this._fontName];if(!t)throw new Error('Missing BitmapFont "'.concat(this._fontName,'"'));this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}},{key:"tint",get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}},{key:"align",get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)}},{key:"fontName",get:function(){return this._fontName},set:function(t){if(!Jr.available[t])throw new Error('Missing BitmapFont "'.concat(t,'"'));this._fontName!==t&&(this._fontName=t,this.dirty=!0)}},{key:"fontSize",get:function(){var t;return null!==(t=this._fontSize)&&void 0!==t?t:Jr.available[this._fontName].size},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}},{key:"anchor",get:function(){return this._anchor},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)}},{key:"text",get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}},{key:"maxLineHeight",get:function(){return this.validate(),this._maxLineHeight}},{key:"textWidth",get:function(){return this.validate(),this._textWidth}},{key:"letterSpacing",get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}},{key:"roundPixels",get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}},{key:"textHeight",get:function(){return this.validate(),this._textHeight}},{key:"resolution",get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}},{key:"destroy",value:function(t){var e=this._textureCache,r="none"===Jr.available[this._fontName].distanceFieldType?ri:ii;r.push.apply(r,(0,q.Z)(this._activePagesMeshData));var i,s=ti(this._activePagesMeshData);try{for(s.s();!(i=s.n()).done;){var a=i.value;this.removeChild(a.mesh)}}catch(l){s.e(l)}finally{s.f()}for(var h in this._activePagesMeshData=[],r.filter((function(t){return e[t.mesh.texture.baseTexture.uid]})).forEach((function(t){t.mesh.texture=u.xE.EMPTY})),e){e[h].destroy(),delete e[h]}this._font=null,this._textureCache=null,(0,k.Z)((0,o.Z)(n.prototype),"destroy",this).call(this,t)}}]),n}(A.W2),oi=ai;oi.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};var ui=[".xml",".fnt"],hi={extension:{type:u.nw.LoadParser,priority:vt.Normal},test:function(t){return ui.includes(u.P6.path.extname(t))},testParse:function(t){return(0,$.Z)(J().mark((function e(){return J().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hr.test(t)||Wr.test(t));case 1:case"end":return e.stop()}}),e)})))()},parse:function(t,e,n){return(0,$.Z)(J().mark((function r(){var i,s,a,o,h,l,c,f,d;return J().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(i=Hr.test(t)?Hr.parse(t):Wr.parse(t),s=e.src,a=i.page,o=[],h=0;h<a.length;++h)l=a[h].file,c=u.P6.path.join(u.P6.path.dirname(s),l),o.push(c);return r.next=7,n.load(o);case 7:return f=r.sent,d=o.map((function(t){return f[t]})),r.abrupt("return",Jr.install(i,d,!0));case 10:case"end":return r.stop()}}),r)})))()},load:function(t,e){return(0,$.Z)(J().mark((function e(){var n;return J().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.Xd.ADAPTER.fetch(t);case 2:return n=e.sent,e.abrupt("return",n.text());case 4:case"end":return e.stop()}}),e)})))()},unload:function(t){t.destroy()}};u.Rw.add(hi)},2131:function(t){"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,n,r,i){n=n||"&",r=r||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(n);var o=1e3;i&&"number"==typeof i.maxKeys&&(o=i.maxKeys);var u=t.length;o>0&&u>o&&(u=o);for(var h=0;h<u;++h){var l,c,f,d,p=t[h].replace(a,"%20"),v=p.indexOf(r);v>=0?(l=p.substr(0,v),c=p.substr(v+1)):(l=p,c=""),f=decodeURIComponent(l),d=decodeURIComponent(c),e(s,f)?Array.isArray(s[f])?s[f].push(d):s[f]=[s[f],d]:s[f]=d}return s}},3054:function(t){"use strict";var e=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,n,r,i){return n=n||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(i){var s=encodeURIComponent(e(i))+r;return Array.isArray(t[i])?t[i].map((function(t){return s+encodeURIComponent(e(t))})).join(n):s+encodeURIComponent(e(t[i]))})).join(n):i?encodeURIComponent(e(i))+r+encodeURIComponent(e(t)):""}},2620:function(t,e,n){"use strict";e.decode=e.parse=n(2131),e.encode=e.stringify=n(3054)},1410:function(t,e,n){var r;t=n.nmd(t),function(i){e&&e.nodeType,t&&t.nodeType;var s="object"==typeof n.g&&n.g;s.global!==s&&s.window!==s&&s.self;var a,o=2147483647,u=36,h=/^xn--/,l=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,p=String.fromCharCode;function v(t){throw RangeError(f[t])}function y(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function m(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+y((t=t.replace(c,".")).split("."),e).join(".")}function g(t){for(var e,n,r=[],i=0,s=t.length;i<s;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<s?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function x(t){return y(t,(function(t){var e="";return t>65535&&(e+=p((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=p(t)})).join("")}function _(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function b(t,e,n){var r=0;for(t=n?d(t/700):t>>1,t+=d(t/e);t>455;r+=u)t=d(t/35);return d(r+36*t/(t+38))}function w(t){var e,n,r,i,s,a,h,l,c,f,p,y=[],m=t.length,g=0,_=128,w=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&v("not-basic"),y.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<m;){for(s=g,a=1,h=u;i>=m&&v("invalid-input"),((l=(p=t.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:u)>=u||l>d((o-g)/a))&&v("overflow"),g+=l*a,!(l<(c=h<=w?1:h>=w+26?26:h-w));h+=u)a>d(o/(f=u-c))&&v("overflow"),a*=f;w=b(g-s,e=y.length+1,0==s),d(g/e)>o-_&&v("overflow"),_+=d(g/e),g%=e,y.splice(g++,0,_)}return x(y)}function E(t){var e,n,r,i,s,a,h,l,c,f,y,m,x,w,E,T=[];for(m=(t=g(t)).length,e=128,n=0,s=72,a=0;a<m;++a)(y=t[a])<128&&T.push(p(y));for(r=i=T.length,i&&T.push("-");r<m;){for(h=o,a=0;a<m;++a)(y=t[a])>=e&&y<h&&(h=y);for(h-e>d((o-n)/(x=r+1))&&v("overflow"),n+=(h-e)*x,e=h,a=0;a<m;++a)if((y=t[a])<e&&++n>o&&v("overflow"),y==e){for(l=n,c=u;!(l<(f=c<=s?1:c>=s+26?26:c-s));c+=u)E=l-f,w=u-f,T.push(p(_(f+E%w,0))),l=d(E/w);T.push(p(_(l,0))),s=b(n,x,r==i),n=0,++r}++n,++e}return T.join("")}a={version:"1.3.2",ucs2:{decode:g,encode:x},decode:w,encode:E,toASCII:function(t){return m(t,(function(t){return l.test(t)?"xn--"+E(t):t}))},toUnicode:function(t){return m(t,(function(t){return h.test(t)?w(t.slice(4).toLowerCase()):t}))}},void 0===(r=function(){return a}.call(e,n,e,t))||(t.exports=r)}()},3629:function(t,e,n){"use strict";var r=n(1410),i=n(1894);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.Qc=x,e.DB=function(t,e){return x(t,!1,!0).resolve(e)},e.WU=function(t){i.isString(t)&&(t=x(t));return t instanceof s?t.format():s.prototype.format.call(t)};var a=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(h),c=["%","/","?",";","#"].concat(l),f=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=n(2620);function x(t,e,n){if(t&&i.isObject(t)&&t instanceof s)return t;var r=new s;return r.parse(t,e,n),r}s.prototype.parse=function(t,e,n){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),o=-1!==s&&s<t.indexOf("#")?"?":"#",h=t.split(o);h[0]=h[0].replace(/\\/g,"/");var x=t=h.join(o);if(x=x.trim(),!n&&1===t.split("#").length){var _=u.exec(x);if(_)return this.path=x,this.href=x,this.pathname=_[1],_[2]?(this.search=_[2],this.query=e?g.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var b=a.exec(x);if(b){var w=(b=b[0]).toLowerCase();this.protocol=w,x=x.substr(b.length)}if(n||b||x.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===x.substr(0,2);!E||b&&y[b]||(x=x.substr(2),this.slashes=!0)}if(!y[b]&&(E||b&&!m[b])){for(var T,k,A=-1,R=0;R<f.length;R++){-1!==(S=x.indexOf(f[R]))&&(-1===A||S<A)&&(A=S)}-1!==(k=-1===A?x.lastIndexOf("@"):x.lastIndexOf("@",A))&&(T=x.slice(0,k),x=x.slice(k+1),this.auth=decodeURIComponent(T)),A=-1;for(R=0;R<c.length;R++){var S;-1!==(S=x.indexOf(c[R]))&&(-1===A||S<A)&&(A=S)}-1===A&&(A=x.length),this.host=x.slice(0,A),x=x.slice(A),this.parseHost(),this.hostname=this.hostname||"";var I="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!I)for(var P=this.hostname.split(/\./),M=(R=0,P.length);R<M;R++){var C=P[R];if(C&&!C.match(d)){for(var O="",D=0,B=C.length;D<B;D++)C.charCodeAt(D)>127?O+="x":O+=C[D];if(!O.match(d)){var N=P.slice(0,R),L=P.slice(R+1),Z=C.match(p);Z&&(N.push(Z[1]),L.unshift(Z[2])),L.length&&(x="/"+L.join(".")+x),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),I||(this.hostname=r.toASCII(this.hostname));var F=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+F,this.href+=this.host,I&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==x[0]&&(x="/"+x))}if(!v[w])for(R=0,M=l.length;R<M;R++){var G=l[R];if(-1!==x.indexOf(G)){var H=encodeURIComponent(G);H===G&&(H=escape(G)),x=x.split(G).join(H)}}var X=x.indexOf("#");-1!==X&&(this.hash=x.substr(X),x=x.slice(0,X));var W=x.indexOf("?");if(-1!==W?(this.search=x.substr(W),this.query=x.substr(W+1),e&&(this.query=g.parse(this.query)),x=x.slice(0,W)):e&&(this.search="",this.query={}),x&&(this.pathname=x),m[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){F=this.pathname||"";var j=this.search||"";this.path=F+j}return this.href=this.format(),this},s.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",s=!1,a="";this.host?s=t+this.host:this.hostname&&(s=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(a=g.stringify(this.query));var o=this.search||a&&"?"+a||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||m[e])&&!1!==s?(s="//"+(s||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):s||(s=""),r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),e+s+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(o=o.replace("#","%23"))+r},s.prototype.resolve=function(t){return this.resolveObject(x(t,!1,!0)).format()},s.prototype.resolveObject=function(t){if(i.isString(t)){var e=new s;e.parse(t,!1,!0),t=e}for(var n=new s,r=Object.keys(this),a=0;a<r.length;a++){var o=r[a];n[o]=this[o]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var u=Object.keys(t),h=0;h<u.length;h++){var l=u[h];"protocol"!==l&&(n[l]=t[l])}return m[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!m[t.protocol]){for(var c=Object.keys(t),f=0;f<c.length;f++){var d=c[f];n[d]=t[d]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||y[t.protocol])n.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var v=n.pathname||"",g=n.search||"";n.path=v+g}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var x=n.pathname&&"/"===n.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=_||x||n.host&&t.pathname,w=b,E=n.pathname&&n.pathname.split("/")||[],T=(p=t.pathname&&t.pathname.split("/")||[],n.protocol&&!m[n.protocol]);if(T&&(n.hostname="",n.port=null,n.host&&(""===E[0]?E[0]=n.host:E.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),b=b&&(""===p[0]||""===E[0])),_)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,E=p;else if(p.length)E||(E=[]),E.pop(),E=E.concat(p),n.search=t.search,n.query=t.query;else if(!i.isNullOrUndefined(t.search)){if(T)n.hostname=n.host=E.shift(),(I=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=I.shift(),n.host=n.hostname=I.shift());return n.search=t.search,n.query=t.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!E.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var k=E.slice(-1)[0],A=(n.host||t.host||E.length>1)&&("."===k||".."===k)||""===k,R=0,S=E.length;S>=0;S--)"."===(k=E[S])?E.splice(S,1):".."===k?(E.splice(S,1),R++):R&&(E.splice(S,1),R--);if(!b&&!w)for(;R--;R)E.unshift("..");!b||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),A&&"/"!==E.join("/").substr(-1)&&E.push("");var I,P=""===E[0]||E[0]&&"/"===E[0].charAt(0);T&&(n.hostname=n.host=P?"":E.length?E.shift():"",(I=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=I.shift(),n.host=n.hostname=I.shift()));return(b=b||n.host&&E.length)&&!P&&E.unshift(""),E.length?n.pathname=E.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},s.prototype.parseHost=function(){var t=this.host,e=o.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},1894:function(t){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},6135:function(t,e,n){"use strict";var r=n(4948),i=n(3070),s=n(9114);t.exports=function(t,e,n){var a=r(e);a in t?i.f(t,a,s(0,n)):t[a]=n}},1246:function(t,e,n){var r=n(648),i=n(8173),s=n(8554),a=n(7497),o=n(5112)("iterator");t.exports=function(t){if(!s(t))return i(t,o)||i(t,"@@iterator")||a[r(t)]}},4121:function(t,e,n){var r=n(6916),i=n(9662),s=n(9670),a=n(6330),o=n(1246),u=TypeError;t.exports=function(t,e){var n=arguments.length<2?o(t):e;if(i(n))return s(r(n,t));throw u(a(t)+" is not iterable")}},7659:function(t,e,n){var r=n(5112),i=n(7497),s=r("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[s]===t)}},408:function(t,e,n){var r=n(9974),i=n(6916),s=n(9670),a=n(6330),o=n(7659),u=n(6244),h=n(7976),l=n(4121),c=n(1246),f=n(9212),d=TypeError,p=function(t,e){this.stopped=t,this.result=e},v=p.prototype;t.exports=function(t,e,n){var y,m,g,x,_,b,w,E=n&&n.that,T=!(!n||!n.AS_ENTRIES),k=!(!n||!n.IS_RECORD),A=!(!n||!n.IS_ITERATOR),R=!(!n||!n.INTERRUPTED),S=r(e,E),I=function(t){return y&&f(y,"normal",t),new p(!0,t)},P=function(t){return T?(s(t),R?S(t[0],t[1],I):S(t[0],t[1])):R?S(t,I):S(t)};if(k)y=t.iterator;else if(A)y=t;else{if(!(m=c(t)))throw d(a(t)+" is not iterable");if(o(m)){for(g=0,x=u(t);x>g;g++)if((_=P(t[g]))&&h(v,_))return _;return new p(!1)}y=l(t,m)}for(b=k?t.next:y.next;!(w=i(b,y)).done;){try{_=P(w.value)}catch(M){f(y,"throw",M)}if("object"==typeof _&&_&&h(v,_))return _}return new p(!1)}},9212:function(t,e,n){var r=n(6916),i=n(9670),s=n(8173);t.exports=function(t,e,n){var a,o;i(t);try{if(!(a=s(t,"return"))){if("throw"===e)throw n;return n}a=r(a,t)}catch(u){o=!0,a=u}if("throw"===e)throw n;if(o)throw a;return i(a),n}},7497:function(t){t.exports={}},365:function(t,e,n){"use strict";var r=n(3111).end,i=n(6091);t.exports=i("trimEnd")?function(){return r(this)}:"".trimEnd},6091:function(t,e,n){var r=n(6530).PROPER,i=n(7293),s=n(1361);t.exports=function(t){return i((function(){return!!s[t]()||""!==""[t]()||r&&s[t].name!==t}))}},3111:function(t,e,n){var r=n(1702),i=n(4488),s=n(1340),a=n(1361),o=r("".replace),u="["+a+"]",h=RegExp("^"+u+u+"*"),l=RegExp(u+u+"*$"),c=function(t){return function(e){var n=s(i(e));return 1&t&&(n=o(n,h,"")),2&t&&(n=o(n,l,"")),n}};t.exports={start:c(1),end:c(2),trim:c(3)}},1340:function(t,e,n){var r=n(648),i=String;t.exports=function(t){if("Symbol"===r(t))throw TypeError("Cannot convert a Symbol value to a string");return i(t)}},1361:function(t){t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},4944:function(t,e,n){"use strict";var r=n(2109),i=n(6790),s=n(7908),a=n(6244),o=n(9303),u=n(5417);r({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=s(this),n=a(e),r=u(e,0);return r.length=i(r,e,e,n,0,void 0===t?1:o(t)),r}})},3792:function(t,e,n){n(1223)("flat")},8559:function(t,e,n){var r=n(2109),i=n(408),s=n(6135);r({target:"Object",stat:!0},{fromEntries:function(t){var e={};return i(t,(function(t,n){s(e,t,n)}),{AS_ENTRIES:!0}),e}})},8702:function(t,e,n){n(3462);var r=n(2109),i=n(365);r({target:"String",proto:!0,name:"trimEnd",forced:"".trimEnd!==i},{trimEnd:i})},3462:function(t,e,n){var r=n(2109),i=n(365);r({target:"String",proto:!0,name:"trimEnd",forced:"".trimRight!==i},{trimRight:i})},3565:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return ee}});var r=n(7294),i=n(3060),s=n(448),a=(n(4944),n(3792),n(1176)),o=n(2221),u=n.n(o),h=n(5839),l=n.n(h),c=n(1381),f=n(8631),d=n(6780),p=n(7093),v=function(t,e,n,r,i){t.clear();var a=function(e,n,r,i,a,o){var u=r-e;t.lineStyle(1,s.vM);for(var h=0;h<a;h++)t.moveTo(e+(h-1)/a*u,n+o((h-1)/a)*(i-n)-s.N4),t.lineTo(e+h/a*u,n+o(h/a)*(i-n)-s.N4);t.endFill(),t.lineStyle(1,s.vM);for(var l=0;l<a;l++)t.moveTo(e+(l-1)/a*u,n+o((l-1)/a)*(i-n)+s.N4),t.lineTo(e+l/a*u,n+o(l/a)*(i-n)+s.N4);t.endFill(),t.lineStyle(1,s.vM);for(var c=0;c<a;c++)t.moveTo(e+c/a*u,n+o(c/a)*(i-n)-s.XV),t.lineTo(e+c/a*u,n+o(c/a)*(i-n)+s.XV);t.endFill()},o=e/r,h=o/2,c=Math.floor(o/s.jZ*s.e0),f=o/c;t.x=i?n%f:0;var d=Math.sin(n/100)*s.A7*Math.atan(Math.min(0,(n+o)/300))/(Math.PI/2)*Math.atan(Math.max(0,(n+s.Ct)/300))/(Math.PI/2);a(-o,s.JK,-h,s.JK,c,l()),a(-h,s.JK,0+f,s.JK+d,c+1,u())},y={customDisplayObject:function(t){var e=t.width,n=t.trainX,r=t.zoom,i=t.transitionLocked,s=new c.TCu;return v(s,e,n,r,i),s},customApplyProps:function(t,e,n){var r=n.width,i=n.trainX,s=n.zoom,a=n.transitionLocked;v(t,r,i,s,a)}},m=(0,a.Yh)(y,"RailTransition"),g=function(){var t=(0,f.v9)(p.VM),e=(0,f.v9)(d.ef).width,n=(0,f.v9)(d.Ut),i=n.zoom,s=n.transitionLocked,a=t&&t.carts[0].x||0;return r.createElement(m,{width:e,trainX:a,zoom:i,transitionLocked:s})};function x(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var b=function(t,e,n,r){t.clear();for(var i,a,o=function(e,n,r,i,a){var o=r-e;t.lineStyle(1,s.vM);for(var u=0;u<s.e0;u++)t.moveTo(e+(u-1)/s.e0*o,n+a((u-1)/s.e0)*(i-n)-s.N4),t.lineTo(e+u/s.e0*o,n+a(u/s.e0)*(i-n)-s.N4);t.endFill(),t.lineStyle(1,s.vM);for(var h=0;h<s.e0;h++)t.moveTo(e+(h-1)/s.e0*o,n+a((h-1)/s.e0)*(i-n)+s.N4),t.lineTo(e+h/s.e0*o,n+a(h/s.e0)*(i-n)+s.N4);t.endFill(),t.lineStyle(1,s.vM);for(var l=0;l<s.e0;l++)t.moveTo(e+l/s.e0*o,n+a(l/s.e0)*(i-n)-s.XV),t.lineTo(e+l/s.e0*o,n+a(l/s.e0)*(i-n)+s.XV);t.endFill()},h=x(r.to);!(a=h()).done;){i=a.value-n,o(s.dQ,s.JK,s.jZ,s.JK+i*s.JK,u())}for(var c,f=x(r.from);!(c=f()).done;){i=c.value-n,o(0,s.JK+i*s.JK,s.dQ,s.JK,l())}r.isCart&&(t.beginFill(s.vs),t.lineStyle(),t.drawRect(s.dQ-s.eM,s.JK-s.YO,s.ak,s.pW))},w={customDisplayObject:function(t){var e=t.x,n=t.y,r=t.railPiece,i=new c.TCu;return i.x=e*s.jZ,i.y=n*s.T0,i.width=s.jZ,i.height=s.T0,b(i,0,n,r),i},customApplyProps:function(t,e,n){n.x;var r=n.y,i=n.railPiece;b(t,0,r,i)}},E=(0,a.Yh)(w,"Rail"),T={customDisplayObject:function(t){var e=t.x,n=t.y,r=new c.TCu;r.width=s.u5,r.height=s.u5,r.x=e*s.jZ+s.dQ,r.y=n*s.T0+s.JK,r.lineStyle(s.sh,s.jn),r.drawEllipse(0,0,s.u5,s.u5);for(var i=0;i<4;i++){var a=Math.cos(i/2*Math.PI+Math.PI/4),o=Math.sin(i/2*Math.PI+Math.PI/4);r.moveTo(a*s.u5*.5,o*s.u5*.5),r.lineTo(a*s.u5*1.3,o*s.u5*1.3)}return r.endFill(),r},customApplyProps:function(t,e,n){var r=n.x,i=n.y;t.x=r*s.jZ+s.dQ+20,t.y=i*s.T0+s.JK}},k=(0,a.Yh)(T,"SwitchCursor"),A=function(t,e,n){t.clear(),t.lineStyle(7,14757948,.5),t.moveTo(0,s.JK);for(var r=0;r<e.length;r++)n[r-1]&&Object.keys(n[r-1]).length>1||n[r]&&Object.keys(n[r]).length>1?t.lineTo(s.jZ*r+s.dQ,s.T0*e[r]+s.JK):t.moveTo(s.jZ*r+s.dQ,s.T0*e[r]+s.JK);t.endFill()},R={customDisplayObject:function(t){var e=t.path,n=t.rails,r=new c.TCu;return A(r,e,n),r},customApplyProps:function(t,e,n){var r=n.path,i=n.rails;A(t,r,i)}},S=(0,a.Yh)(R,"SwitchPath"),I=function(t){var e=t.rails,n=t.switchCursor,i=t.switchPath;return r.createElement(a.W2,{x:0,y:0},r.createElement(g,null),e&&e.map((function(t,e){return Object.entries(t).map((function(t){var n=t[0],i=t[1];return r.createElement(E,{key:e+":"+n,x:e,y:n,railPiece:i})}))})).flat(1),void 0!==n.x&&void 0!==n.y&&r.createElement(k,{x:n.x,y:n.y}),i&&r.createElement(S,{path:i,rails:e}))},P=n(3873),M=n.n(P),C={customDisplayObject:function(t){var e,n,r=t.train,i=t.cart,a=new c.W20;r.isEnemy?(e=M()(s.H6).num(),n=M()(s.H6).darken(.5).num()):(e=M()(s.uH).num(),n=M()(s.uH).darken(.5).num());var o=new c.TCu;o.width=s.ak,o.height=s.pW,o.beginFill(n),o.drawRect(0,0,s.ak,s.pW),o.x=-s.eM,o.y=-s.YO,a.addChild(o);var u=new c.TCu;return u.width=s.ak,u.height=s.pW,u.beginFill(e),u.drawRect(0,0,s.ak,s.pW),u.x=-s.eM,u.y=-s.YO,a.addChild(u),a.x=i.x,a.y=i.y,a.rotation=i.rotation,a},customApplyProps:function(t,e,n){var r=n.train,i=n.cart,a=i.x,o=i.y,u=i.rotation,h=i.skew;t.x=a,t.y=o,t.rotation=u,t.children[0].y=-s.YO-h*Math.min(1,Math.sqrt(r.speed))}},O=(0,a.Yh)(C,"Cart"),D=function(t){var e=t.train,n=(0,f.v9)(d.ef).width,i=(0,f.v9)(d.Ut).zoom,o=-1*Math.min(0,e.carts[0].x+n/i/2+s.tl*n/i);return r.createElement(a.W2,{x:o+s.dQ,y:s.JK},e.carts.map((function(t,n){return r.createElement(O,{key:n,train:e,cart:t})})))},B=n(1752),N=n(885),L=n(7326),Z=n(136),F=n(2963),U=n(1120),G=n(5671),H=n(3144),X=(n(5743),n(4386)),W=n(6260),j=n(6397);function z(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return V(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){o=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw s}}}}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,U.Z)(t);if(e){var i=(0,U.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,F.Z)(this,n)}}var K=function(){function t(e){(0,G.Z)(this,t),this.parent=e,this.paused=!1}return(0,H.Z)(t,[{key:"destroy",value:function(){}},{key:"down",value:function(t){return!1}},{key:"move",value:function(t){return!1}},{key:"up",value:function(t){return!1}},{key:"wheel",value:function(t){return!1}},{key:"update",value:function(t){}},{key:"resize",value:function(){}},{key:"reset",value:function(){}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}}]),t}(),q="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};var $,Q,J,tt=($=function(t,e){(function(){var e,n;n=e={linear:function(t,e,n,r){return n*t/r+e},easeInQuad:function(t,e,n,r){return n*(t/=r)*t+e},easeOutQuad:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},easeInOutQuad:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,r){return n*(t/=r)*t*t+e},easeOutCubic:function(t,e,n,r){return n*((t=t/r-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,r){return n*(t/=r)*t*t*t+e},easeOutQuart:function(t,e,n,r){return-n*((t=t/r-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,r){return n*(t/=r)*t*t*t*t+e},easeOutQuint:function(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,r){return-n*Math.cos(t/r*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,r){return n*Math.sin(t/r*(Math.PI/2))+e},easeInOutSine:function(t,e,n,r){return-n/2*(Math.cos(Math.PI*t/r)-1)+e},easeInExpo:function(t,e,n,r){return 0===t?e:n*Math.pow(2,10*(t/r-1))+e},easeOutExpo:function(t,e,n,r){return t===r?e+n:n*(1-Math.pow(2,-10*t/r))+e},easeInOutExpo:function(t,e,n,r){return(t/=r/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,n,r){return-n*(Math.sqrt(1-(t/=r)*t)-1)+e},easeOutCirc:function(t,e,n,r){return n*Math.sqrt(1-(t=t/r-1)*t)+e},easeInOutCirc:function(t,e,n,r){return(t/=r/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,r){var i,s,a;return a=1.70158,0===t||(t/=r),(s=0)||(s=.3*r),(i=n)<Math.abs(n)?(i=n,a=s/4):a=s/(2*Math.PI)*Math.asin(n/i),-i*Math.pow(2,10*(t-=1))*Math.sin((t*r-a)*(2*Math.PI)/s)+e},easeOutElastic:function(t,e,n,r){var i,s,a;return a=1.70158,0===t||(t/=r),(s=0)||(s=.3*r),(i=n)<Math.abs(n)?(i=n,a=s/4):a=s/(2*Math.PI)*Math.asin(n/i),i*Math.pow(2,-10*t)*Math.sin((t*r-a)*(2*Math.PI)/s)+n+e},easeInOutElastic:function(t,e,n,r){var i,s,a;return a=1.70158,0===t||(t/=r/2),(s=0)||(s=r*(.3*1.5)),(i=n)<Math.abs(n)?(i=n,a=s/4):a=s/(2*Math.PI)*Math.asin(n/i),t<1?i*Math.pow(2,10*(t-=1))*Math.sin((t*r-a)*(2*Math.PI)/s)*-.5+e:i*Math.pow(2,-10*(t-=1))*Math.sin((t*r-a)*(2*Math.PI)/s)*.5+n+e},easeInBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),n*(t/=r)*t*((i+1)*t-i)+e},easeOutBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),n*((t=t/r-1)*t*((i+1)*t+i)+1)+e},easeInOutBack:function(t,e,n,r,i){return void 0===i&&(i=1.70158),(t/=r/2)<1?n/2*(t*t*((1+(i*=1.525))*t-i))+e:n/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+e},easeInBounce:function(t,n,r,i){return r-e.easeOutBounce(i-t,0,r,i)+n},easeOutBounce:function(t,e,n,r){return(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,n,r,i){return t<i/2?.5*e.easeInBounce(2*t,0,r,i)+n:.5*e.easeOutBounce(2*t-i,0,r,i)+.5*r+n}},t.exports=n}).call(q)},$(J={path:Q,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&J.path)}},J.exports),J.exports);function et(t,e){return t?"function"==typeof t?t:"string"==typeof t?tt[t]:void 0:tt[e]}var nt={removeOnInterrupt:!1,ease:"linear",time:1e3},rt=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,G.Z)(this,n),r=e.call(this,t),n.prototype.__init.call((0,L.Z)(r)),n.prototype.__init2.call((0,L.Z)(r)),n.prototype.__init3.call((0,L.Z)(r)),n.prototype.__init4.call((0,L.Z)(r)),n.prototype.__init5.call((0,L.Z)(r)),n.prototype.__init6.call((0,L.Z)(r)),n.prototype.__init7.call((0,L.Z)(r)),r.options=Object.assign({},nt,i),r.options.ease=et(r.options.ease),r.setupPosition(),r.setupZoom(),r.time=0,r}return(0,H.Z)(n,[{key:"__init",value:function(){this.startWidth=null}},{key:"__init2",value:function(){this.startHeight=null}},{key:"__init3",value:function(){this.deltaWidth=null}},{key:"__init4",value:function(){this.deltaHeight=null}},{key:"__init5",value:function(){this.width=null}},{key:"__init6",value:function(){this.height=null}},{key:"__init7",value:function(){this.time=0}},{key:"setupPosition",value:function(){void 0!==this.options.position?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}},{key:"setupZoom",value:function(){this.width=null,this.height=null,void 0!==this.options.scale?this.width=this.parent.screenWidth/this.options.scale:void 0!==this.options.scaleX||void 0!==this.options.scaleY?(void 0!==this.options.scaleX&&(this.width=this.parent.screenWidth/this.options.scaleX),void 0!==this.options.scaleY&&(this.height=this.parent.screenHeight/this.options.scaleY)):(void 0!==this.options.width&&(this.width=this.options.width),void 0!==this.options.height&&(this.height=this.options.height)),null!==this.width&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),null!==this.height&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}},{key:"down",value:function(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}},{key:"complete",value:function(){this.parent.plugins.remove("animate"),null!==this.width&&this.parent.fitWidth(this.width,this.keepCenter,null===this.height),null!==this.height&&this.parent.fitHeight(this.height,this.keepCenter,null===this.width),!this.keepCenter&&this.options.position&&this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}},{key:"update",value:function(t){if(!this.paused){this.time+=t;var e=new X.E9(this.parent.scale.x,this.parent.scale.y);if(this.time>=this.options.time){var n=this.parent.width,r=this.parent.height;this.complete(),n===this.parent.width&&r===this.parent.height||this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}else{var i=this.options.ease(this.time,0,1,this.options.time);if(null!==this.width){var s=this.startWidth,a=this.deltaWidth;this.parent.fitWidth(s+a*i,this.keepCenter,null===this.height)}if(null!==this.height){var o=this.startHeight,u=this.deltaHeight;this.parent.fitHeight(o+u*i,this.keepCenter,null===this.width)}if(null===this.width?this.parent.scale.x=this.parent.scale.y:null===this.height&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){var h=this.startX,l=this.startY,c=this.deltaX,f=this.deltaY,d=new X.E9(this.parent.x,this.parent.y);this.parent.moveCenter(h+c*i,l+f*i),this.parent.emit("moved",{viewport:this.parent,original:d,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}}}}]),n}(K);function it(t){for(var e=void 0,n=t[0],r=1;r<t.length;){var i=t[r],s=t[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(e=n,n=s(n)):"call"!==i&&"optionalCall"!==i||(n=s((function(){for(var t,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(t=n).call.apply(t,[e].concat(i))})),e=void 0)}return n}var st={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null},at=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,G.Z)(this,n),(r=e.call(this,t)).options=Object.assign({},st,i),r.ease=et(r.options.ease,"easeInOutSine"),r.options.sides?"all"===r.options.sides?r.top=r.bottom=r.left=r.right=!0:"horizontal"===r.options.sides?(r.right=r.left=!0,r.top=r.bottom=!1):"vertical"===r.options.sides?(r.left=r.right=!1,r.top=r.bottom=!0):(r.top=-1!==r.options.sides.indexOf("top"),r.bottom=-1!==r.options.sides.indexOf("bottom"),r.left=-1!==r.options.sides.indexOf("left"),r.right=-1!==r.options.sides.indexOf("right")):r.left=r.top=r.right=r.bottom=!1;var s=r.options.underflow.toLowerCase();return"center"===s?(r.underflowX=0,r.underflowY=0):(r.underflowX=-1!==s.indexOf("left")?-1:-1!==s.indexOf("right")?1:0,r.underflowY=-1!==s.indexOf("top")?-1:-1!==s.indexOf("bottom")?1:0),r.reset(),r}return(0,H.Z)(n,[{key:"isActive",value:function(){return null!==this.toX||null!==this.toY}},{key:"down",value:function(){return this.toX=this.toY=null,!1}},{key:"up",value:function(){return this.bounce(),!1}},{key:"update",value:function(t){if(!this.paused){if(this.bounce(),this.toX){var e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){var n=this.toY;n.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),n.time>=this.options.time?(this.parent.y=n.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(n.time,n.start,n.delta,this.options.time)}}}},{key:"calcUnderflowX",value:function(){var t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}},{key:"calcUnderflowY",value:function(){var t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}},{key:"oob",value:function(){var t=this.options.bounceBox;if(t){var e=void 0===t.x?0:t.x,n=void 0===t.y?0:t.y,r=void 0===t.width?this.parent.worldWidth:t.width,i=void 0===t.height?this.parent.worldHeight:t.height;return{left:this.parent.left<e,right:this.parent.right>r,top:this.parent.top<n,bottom:this.parent.bottom>i,topLeft:new X.E9(e*this.parent.scale.x,n*this.parent.scale.y),bottomRight:new X.E9(r*this.parent.scale.x-this.parent.screenWidth,i*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new X.E9(0,0),bottomRight:new X.E9(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}},{key:"bounce",value:function(){if(!this.paused){var t,e=this.parent.plugins.get("decelerate",!0);e&&(e.x||e.y)&&(e.x&&e.percentChangeX===it([e,"access",function(t){return t.options},"optionalAccess",function(t){return t.friction}])||e.y&&e.percentChangeY===it([e,"access",function(t){return t.options},"optionalAccess",function(t){return t.friction}]))&&(((t=this.oob()).left&&this.left||t.right&&this.right)&&(e.percentChangeX=this.options.friction),(t.top&&this.top||t.bottom&&this.bottom)&&(e.percentChangeY=this.options.friction));var n=this.parent.plugins.get("drag",!0)||{},r=this.parent.plugins.get("pinch",!0)||{};if(e=e||{},!(it([n,"optionalAccess",function(t){return t.active}])||it([r,"optionalAccess",function(t){return t.active}])||this.toX&&this.toY||e.x&&e.y)){var i=(t=t||this.oob()).topLeft,s=t.bottomRight;if(!this.toX&&!e.x){var a=null;t.left&&this.left?a=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-i.x:t.right&&this.right&&(a=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-s.x),null!==a&&this.parent.x!==a&&(this.toX={time:0,start:this.parent.x,delta:a-this.parent.x,end:a},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!e.y){var o=null;t.top&&this.top?o=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-i.y:t.bottom&&this.bottom&&(o=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-s.y),null!==o&&this.parent.y!==o&&(this.toY={time:0,start:this.parent.y,delta:o-this.parent.y,end:o},this.parent.emit("bounce-y-start",this.parent))}}}}},{key:"reset",value:function(){this.toX=this.toY=null,this.bounce()}}]),n}(K),ot={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"},ut=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,G.Z)(this,n),(r=e.call(this,t)).options=Object.assign({},ot,i),r.options.direction&&(r.options.left="x"===r.options.direction||"all"===r.options.direction||null,r.options.right="x"===r.options.direction||"all"===r.options.direction||null,r.options.top="y"===r.options.direction||"all"===r.options.direction||null,r.options.bottom="y"===r.options.direction||"all"===r.options.direction||null),r.parseUnderflow(),r.last={x:null,y:null,scaleX:null,scaleY:null},r.update(),r}return(0,H.Z)(n,[{key:"parseUnderflow",value:function(){var t=this.options.underflow.toLowerCase();"none"===t?this.noUnderflow=!0:"center"===t?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0,this.noUnderflow=!1)}},{key:"move",value:function(){return this.update(),!1}},{key:"update",value:function(){if(!this.paused&&(this.parent.x!==this.last.x||this.parent.y!==this.last.y||this.parent.scale.x!==this.last.scaleX||this.parent.scale.y!==this.last.scaleY)){var t={x:this.parent.x,y:this.parent.y},e=this.parent.plugins.decelerate||{};if(null!==this.options.left||null!==this.options.right){var n=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:0!==this.parent.x&&(this.parent.x=0,n=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,n=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,n=!0)}else null!==this.options.left&&this.parent.left<(!0===this.options.left?0:this.options.left)&&(this.parent.x=-(!0===this.options.left?0:this.options.left)*this.parent.scale.x,e.x=0,n=!0),null!==this.options.right&&this.parent.right>(!0===this.options.right?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(!0===this.options.right?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(null!==this.options.top||null!==this.options.bottom){var r=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:0!==this.parent.y&&(this.parent.y=0,r=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,r=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,r=!0)}else null!==this.options.top&&this.parent.top<(!0===this.options.top?0:this.options.top)&&(this.parent.y=-(!0===this.options.top?0:this.options.top)*this.parent.scale.y,e.y=0,r=!0),null!==this.options.bottom&&this.parent.bottom>(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,r=!0);r&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}}},{key:"reset",value:function(){this.update()}}]),n}(K),ht={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null},lt=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,G.Z)(this,n),(r=e.call(this,t)).options=Object.assign({},ht,i),r.clamp(),r}return(0,H.Z)(n,[{key:"resize",value:function(){this.clamp()}},{key:"clamp",value:function(){if(!this.paused)if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){var t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(null!==this.options.minWidth&&t<this.options.minWidth){var n=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxWidth&&t>this.options.maxWidth){var r=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/r,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.minHeight&&e<this.options.minHeight){var i=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxHeight&&e>this.options.maxHeight){var s=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/s,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){var a={x:null,y:null},o={x:null,y:null};if("number"==typeof this.options.minScale)a.x=this.options.minScale,a.y=this.options.minScale;else if(null!==this.options.minScale){var u=this.options.minScale;a.x=void 0===u.x?null:u.x,a.y=void 0===u.y?null:u.y}if("number"==typeof this.options.maxScale)o.x=this.options.maxScale,o.y=this.options.maxScale;else if(null!==this.options.maxScale){var h=this.options.maxScale;o.x=void 0===h.x?null:h.x,o.y=void 0===h.y?null:h.y}var l=this.parent.scale.x,c=this.parent.scale.y;null!==a.x&&l<a.x&&(l=a.x),null!==o.x&&l>o.x&&(l=o.x),null!==a.y&&c<a.y&&(c=a.y),null!==o.y&&c>o.y&&(c=o.y),l===this.parent.scale.x&&c===this.parent.scale.y||(this.parent.scale.set(l,c),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}},{key:"reset",value:function(){this.clamp()}}]),n}(K),ct={friction:.98,bounce:.8,minSpeed:.01},ft=16,dt=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,G.Z)(this,n),(r=e.call(this,t)).options=Object.assign({},ct,i),r.saved=[],r.timeSinceRelease=0,r.reset(),r.parent.on("moved",(function(t){return r.moved(t)})),r}return(0,H.Z)(n,[{key:"down",value:function(){return this.saved=[],this.x=this.y=null,!1}},{key:"isActive",value:function(){return!(!this.x&&!this.y)}},{key:"move",value:function(){if(this.paused)return!1;var t=this.parent.input.count();return(1===t||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}},{key:"moved",value:function(t){if(this.saved.length){var e=this.saved[this.saved.length-1];"clamp-x"===t.type?e.x===t.original.x&&(e.x=this.parent.x):"clamp-y"===t.type&&e.y===t.original.y&&(e.y=this.parent.y)}}},{key:"up",value:function(){if(0===this.parent.input.count()&&this.saved.length){var t,e=performance.now(),n=z(this.saved);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.time>=e-100){var i=e-r.time;this.x=(this.parent.x-r.x)/i,this.y=(this.parent.y-r.y)/i,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}}catch(s){n.e(s)}finally{n.f()}}return!1}},{key:"activate",value:function(t){void 0!==(t=t||{}).x&&(this.x=t.x,this.percentChangeX=this.options.friction),void 0!==t.y&&(this.y=t.y,this.percentChangeY=this.options.friction)}},{key:"update",value:function(t){if(!this.paused){var e=this.x||this.y,n=this.timeSinceRelease,r=this.timeSinceRelease+t;if(this.x){var i=this.percentChangeX,s=Math.log(i);this.parent.x+=this.x*ft/s*(Math.pow(i,r/ft)-Math.pow(i,n/ft)),this.x*=Math.pow(this.percentChangeX,t/ft)}if(this.y){var a=this.percentChangeY,o=Math.log(a);this.parent.y+=this.y*ft/o*(Math.pow(a,r/ft)-Math.pow(a,n/ft)),this.y*=Math.pow(this.percentChangeY,t/ft)}this.timeSinceRelease+=t,this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.x=0,this.y=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0)),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}}},{key:"reset",value:function(){this.x=this.y=null}}]),n}(K),pt={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20,wheelSwapAxes:!1},vt=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,G.Z)(this,n),r=e.call(this,t),n.prototype.__init.call((0,L.Z)(r)),r.options=Object.assign({},pt,i),r.moved=!1,r.reverse=r.options.reverse?1:-1,r.xDirection=!r.options.direction||"all"===r.options.direction||"x"===r.options.direction,r.yDirection=!r.options.direction||"all"===r.options.direction||"y"===r.options.direction,r.keyIsPressed=!1,r.parseUnderflow(),r.mouseButtons(r.options.mouseButtons),r.options.keyToPress&&r.handleKeyPresses(r.options.keyToPress),r}return(0,H.Z)(n,[{key:"__init",value:function(){this.windowEventHandlers=new Array}},{key:"handleKeyPresses",value:function(t){var e=this;this.addWindowEventHandler("keyup",(function(n){t.includes(n.code)&&(e.keyIsPressed=!1)})),this.addWindowEventHandler("keydown",(function(n){t.includes(n.code)&&(e.keyIsPressed=!0)}))}},{key:"addWindowEventHandler",value:function(t,e){window.addEventListener(t,e),this.windowEventHandlers.push({event:t,handler:e})}},{key:"destroy",value:function(){this.windowEventHandlers.forEach((function(t){var e=t.event,n=t.handler;window.removeEventListener(e,n)}))}},{key:"mouseButtons",value:function(t){this.mouse=t&&"all"!==t?[-1!==t.indexOf("left"),-1!==t.indexOf("middle"),-1!==t.indexOf("right")]:[!0,!0,!0]}},{key:"parseUnderflow",value:function(){var t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(t.includes("left")?this.underflowX=-1:t.includes("right")?this.underflowX=1:this.underflowX=0,t.includes("top")?this.underflowY=-1:t.includes("bottom")?this.underflowY=1:this.underflowY=0)}},{key:"checkButtons",value:function(t){var e="mouse"===t.data.pointerType,n=this.parent.input.count();return!(!(1===n||n>1&&!this.parent.plugins.get("pinch",!0))||e&&!this.mouse[t.data.button])}},{key:"checkKeyPress",value:function(t){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&"touch"===t.data.pointerType}},{key:"down",value:function(t){return!(this.paused||!this.options.pressDrag)&&(this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.data.global.x,y:t.data.global.y},this.current=t.data.pointerId,!0):(this.last=null,!1))}},{key:"active",get:function(){return this.moved}},{key:"move",value:function(t){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===t.data.pointerId){var e=t.data.global.x,n=t.data.global.y,r=this.parent.input.count();if(1===r||r>1&&!this.parent.plugins.get("pinch",!0)){var i=e-this.last.x,s=n-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(i)||this.yDirection&&this.parent.input.checkThreshold(s)){var a={x:e,y:n};return this.xDirection&&(this.parent.x+=(a.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(a.y-this.last.y)*this.options.factor),this.last=a,this.moved||this.parent.emit("drag-start",{event:t,screen:new X.E9(this.last.x,this.last.y),world:this.parent.toWorld(new X.E9(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}},{key:"up",value:function(t){if(this.paused)return!1;var e=this.parent.input.touches;if(1===e.length){var n=e[0];return n.last&&(this.last={x:n.last.x,y:n.last.y},this.current=n.id),this.moved=!1,!0}if(this.last&&this.moved){var r=new X.E9(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:r,world:this.parent.toWorld(r),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}},{key:"wheel",value:function(t){if(this.paused)return!1;if(this.options.wheel){var e=this.parent.plugins.get("wheel",!0);if(!e||!e.options.wheelZoom&&!t.ctrlKey){var n=t.deltaMode?this.options.lineHeight:1,r=[t.deltaX,t.deltaY],i=this.options.wheelSwapAxes?r.reverse():r,s=(0,N.Z)(i,2),a=s[0],o=s[1];return this.xDirection&&(this.parent.x+=a*n*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=o*n*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),this.parent.options.stopPropagation&&t.stopPropagation(),!0}}return!1}},{key:"resume",value:function(){this.last=null,this.paused=!1}},{key:"clamp",value:function(){var t=this.parent.plugins.get("decelerate",!0)||{};if("y"!==this.options.clampWheel)if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if("x"!==this.options.clampWheel)if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}]),n}(K),yt={speed:0,acceleration:null,radius:null},mt=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t,r){var i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,G.Z)(this,n),(i=e.call(this,t)).target=r,i.options=Object.assign({},yt,s),i.velocity={x:0,y:0},i}return(0,H.Z)(n,[{key:"update",value:function(t){if(!this.paused){var e=this.parent.center,n=this.target.x,r=this.target.y;if(this.options.radius){if(!(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius))return;var i=Math.atan2(this.target.y-e.y,this.target.x-e.x);n=this.target.x-Math.cos(i)*this.options.radius,r=this.target.y-Math.sin(i)*this.options.radius}var s=n-e.x,a=r-e.y;if(s||a)if(this.options.speed)if(this.options.acceleration){var o=Math.atan2(r-e.y,n-e.x),u=Math.sqrt(Math.pow(s,2)+Math.pow(a,2));if(u){var h=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);this.velocity=u>h?{x:Math.min(this.velocity.x+(this.options.acceleration,this.options.speed)),y:Math.min(this.velocity.y+(this.options.acceleration,this.options.speed))}:{x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};var l=Math.cos(o)*this.velocity.x,c=Math.sin(o)*this.velocity.y,f=Math.abs(l)>Math.abs(s)?n:e.x+l,d=Math.abs(c)>Math.abs(a)?r:e.y+c;this.parent.moveCenter(f,d),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{var p=Math.atan2(r-e.y,n-e.x),v=Math.cos(p)*this.options.speed,y=Math.sin(p)*this.options.speed,m=Math.abs(v)>Math.abs(s)?n:e.x+v,g=Math.abs(y)>Math.abs(a)?r:e.y+y;this.parent.moveCenter(m,g),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(n,r),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}}]),n}(K),gt={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1},xt=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,G.Z)(this,n),(r=e.call(this,t)).options=Object.assign({},gt,i),r.reverse=r.options.reverse?1:-1,r.radiusSquared="number"==typeof r.options.radius?Math.pow(r.options.radius,2):null,r.resize(),r}return(0,H.Z)(n,[{key:"resize",value:function(){var t=this.options.distance;null!==t?(this.left=t,this.top=t,this.right=this.parent.screenWidth-t,this.bottom=this.parent.screenHeight-t):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=null===this.options.right?null:this.parent.screenWidth-this.options.right,this.bottom=null===this.options.bottom?null:this.parent.screenHeight-this.options.bottom)}},{key:"down",value:function(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}},{key:"move",value:function(t){if(this.paused)return!1;if("mouse"!==t.data.pointerType&&1!==t.data.identifier||!this.options.allowButtons&&0!==t.data.buttons)return!1;var e=t.data.global.x,n=t.data.global.y;if(this.radiusSquared){var r=this.parent.toScreen(this.parent.center);if(Math.pow(r.x-e,2)+Math.pow(r.y-n,2)>=this.radiusSquared){var i=Math.atan2(r.y-n,r.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(i))*this.options.speed*this.reverse*.06,this.vertical=Math.round(Math.sin(i))*this.options.speed*this.reverse*.06):(this.horizontal=Math.cos(i)*this.options.speed*this.reverse*.06,this.vertical=Math.sin(i)*this.options.speed*this.reverse*.06)}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else null!==this.left&&e<this.left?this.horizontal=Number(this.reverse)*this.options.speed*.06:null!==this.right&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*.06:(this.decelerateHorizontal(),this.horizontal=0),null!==this.top&&n<this.top?this.vertical=Number(this.reverse)*this.options.speed*.06:null!==this.bottom&&n>this.bottom?this.vertical=-1*this.reverse*this.options.speed*.06:(this.decelerateVertical(),this.vertical=0);return!1}},{key:"decelerateHorizontal",value:function(){var t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}},{key:"decelerateVertical",value:function(){var t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}},{key:"up",value:function(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}},{key:"update",value:function(){if(!this.paused&&(this.horizontal||this.vertical)){var t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}]),n}(K),_t={noDrag:!1,percent:1,center:null,factor:1,axis:"all"},bt=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,G.Z)(this,n),r=e.call(this,t),n.prototype.__init.call((0,L.Z)(r)),n.prototype.__init2.call((0,L.Z)(r)),n.prototype.__init3.call((0,L.Z)(r)),r.options=Object.assign({},_t,i),r}return(0,H.Z)(n,[{key:"__init",value:function(){this.active=!1}},{key:"__init2",value:function(){this.pinching=!1}},{key:"__init3",value:function(){this.moved=!1}},{key:"down",value:function(){return this.parent.input.count()>=2&&(this.active=!0,!0)}},{key:"isAxisX",value:function(){return["all","x"].includes(this.options.axis)}},{key:"isAxisY",value:function(){return["all","y"].includes(this.options.axis)}},{key:"move",value:function(t){if(this.paused||!this.active)return!1;var e=t.data.global.x,n=t.data.global.y,r=this.parent.input.touches;if(r.length>=2){var i=r[0],s=r[1],a=i.last&&s.last?Math.sqrt(Math.pow(s.last.x-i.last.x,2)+Math.pow(s.last.y-i.last.y,2)):null;if(i.id===t.data.pointerId?i.last={x:e,y:n,data:t.data}:s.id===t.data.pointerId&&(s.last={x:e,y:n,data:t.data}),a){var o,u={x:i.last.x+(s.last.x-i.last.x)/2,y:i.last.y+(s.last.y-i.last.y)/2};this.options.center||(o=this.parent.toLocal(u));var h=Math.sqrt(Math.pow(s.last.x-i.last.x,2)+Math.pow(s.last.y-i.last.y,2)),l=(1-a/(h=0===h?h=1e-10:h))*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=l),this.isAxisY()&&(this.parent.scale.y+=l),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:u});var c=this.parent.plugins.get("clamp-zoom",!0);if(c&&c.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{var f=this.parent.toGlobal(o);this.parent.x+=(u.x-f.x)*this.options.factor,this.parent.y+=(u.y-f.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(u.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(u.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=u,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}},{key:"up",value:function(){return!!(this.pinching&&this.parent.input.touches.length<=1)&&(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0)}}]),n}(K),wt={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1},Et=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t,r,i){var s,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,G.Z)(this,n),(s=e.call(this,t)).options=Object.assign({},wt,a),s.ease=et(a.ease,"easeInOutSine"),s.x=r,s.y=i,s.options.forceStart&&s.snapStart(),s}return(0,H.Z)(n,[{key:"snapStart",value:function(){this.percent=0,this.snapping={time:0};var t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}},{key:"wheel",value:function(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}},{key:"down",value:function(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}},{key:"up",value:function(){if(0===this.parent.input.count()){var t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}return!1}},{key:"update",value:function(t){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count()))if(this.snapping){var e,n,r,i=this.snapping;i.time+=t;var s=this.startX,a=this.startY,o=this.deltaX,u=this.deltaY;if(i.time>this.options.time)e=!0,n=s+o,r=a+u;else{var h=this.ease(i.time,0,1,this.options.time);n=s+o*h,r=a+u*h}this.options.topLeft?this.parent.moveCorner(n,r):this.parent.moveCenter(n,r),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),e&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{var l=this.options.topLeft?this.parent.corner:this.parent.center;l.x===this.x&&l.y===this.y||this.snapStart()}}}]),n}(K),Tt={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1},kt=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,G.Z)(this,n),(r=e.call(this,t)).options=Object.assign({},Tt,i),r.ease=et(r.options.ease),r.xIndependent=!1,r.yIndependent=!1,r.xScale=0,r.yScale=0,r.options.width>0&&(r.xScale=t.screenWidth/r.options.width,r.xIndependent=!0),r.options.height>0&&(r.yScale=t.screenHeight/r.options.height,r.yIndependent=!0),r.xScale=r.xIndependent?r.xScale:r.yScale,r.yScale=r.yIndependent?r.yScale:r.xScale,0===r.options.time?(t.container.scale.x=r.xScale,t.container.scale.y=r.yScale,r.options.removeOnComplete&&r.parent.plugins.remove("snap-zoom")):i.forceStart&&r.createSnapping(),r}return(0,H.Z)(n,[{key:"createSnapping",value:function(){var t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,n=this.parent.screenWidth/this.xScale,r=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:e,deltaX:n-t,deltaY:r-e},this.parent.emit("snap-zoom-start",this.parent)}},{key:"resize",value:function(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}},{key:"wheel",value:function(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}},{key:"down",value:function(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}},{key:"update",value:function(t){var e;if(!this.paused&&(!this.options.interrupt||0===this.parent.input.count()))if(this.options.center||this.options.noMove||(e=this.parent.center),this.snapping){if(this.snapping){var n=this.snapping;if(n.time+=t,n.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{var r=this.snapping,i=this.ease(r.time,r.startX,r.deltaX,this.options.time),s=this.ease(r.time,r.startY,r.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/i,this.parent.scale.y=this.parent.screenHeight/s}var a=this.parent.plugins.get("clamp-zoom",!0);a&&a.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}else this.parent.scale.x===this.xScale&&this.parent.scale.y===this.yScale||this.createSnapping()}},{key:"resume",value:function(){this.snapping=null,(0,B.Z)((0,U.Z)(n.prototype),"resume",this).call(this)}}]),n}(K),At={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0},Rt=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,G.Z)(this,n),(r=e.call(this,t)).options=Object.assign({},At,i),r.keyIsPressed=!1,r.options.keyToPress&&r.handleKeyPresses(r.options.keyToPress),r}return(0,H.Z)(n,[{key:"handleKeyPresses",value:function(t){var e=this;window.addEventListener("keydown",(function(n){t.includes(n.code)&&(e.keyIsPressed=!0)})),window.addEventListener("keyup",(function(n){t.includes(n.code)&&(e.keyIsPressed=!1)}))}},{key:"checkKeyPress",value:function(){return!this.options.keyToPress||this.keyIsPressed}},{key:"down",value:function(){return this.options.interrupt&&(this.smoothing=null),!1}},{key:"isAxisX",value:function(){return["all","x"].includes(this.options.axis)}},{key:"isAxisY",value:function(){return["all","y"].includes(this.options.axis)}},{key:"update",value:function(){if(this.smoothing){var t,e=this.smoothingCenter,n=this.smoothing;this.options.center||(t=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x+=n.x),this.isAxisY()&&(this.parent.scale.y+=n.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});var r=this.parent.plugins.get("clamp-zoom",!0);if(r&&r.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{var i=this.parent.toGlobal(t);this.parent.x+=e.x-i.x,this.parent.y+=e.y-i.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}},{key:"pinch",value:function(t){if(!this.paused){var e,n=this.parent.input.getPointerPosition(t),r=-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/200,i=Math.pow(2,(1+this.options.percent)*r);this.options.center||(e=this.parent.toLocal(n)),this.isAxisX()&&(this.parent.scale.x*=i),this.isAxisY()&&(this.parent.scale.y*=i),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});var s=this.parent.plugins.get("clamp-zoom",!0);if(s&&s.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{var a=this.parent.toGlobal(e);this.parent.x+=n.x-a.x,this.parent.y+=n.y-a.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:t.deltaX,dy:t.deltaY,dz:t.deltaZ},event:t,viewport:this.parent})}}},{key:"wheel",value:function(t){if(this.paused)return!1;if(!this.checkKeyPress())return!1;if(t.ctrlKey&&this.options.trackpadPinch)this.pinch(t);else if(this.options.wheelZoom){var e=this.parent.input.getPointerPosition(t),n=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,r=Math.pow(2,(1+this.options.percent)*n);if(this.options.smooth){var i={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+i.x)*r-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+i.y)*r-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{var s;this.options.center||(s=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=r),this.isAxisY()&&(this.parent.scale.y*=r),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});var a=this.parent.plugins.get("clamp-zoom",!0);if(a&&a.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{var o=this.parent.toGlobal(s);this.parent.x+=e.x-o.x,this.parent.y+=e.y-o.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:t.deltaX,dy:t.deltaY,dz:t.deltaZ},event:t,viewport:this.parent})}return!this.parent.options.passiveWheel}}]),n}(K),St=function(){function t(e){(0,G.Z)(this,t),this.viewport=e,this.touches=[],this.addListeners()}return(0,H.Z)(t,[{key:"addListeners",value:function(){var t=this;this.viewport.interactive=!0,this.viewport.forceHitArea||(this.viewport.hitArea=new X.Ae(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.on("pointerout",this.up,this),this.wheelFunction=function(e){return t.handleWheel(e)},this.viewport.options.divWheel.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}},{key:"destroy",value:function(){this.viewport.options.divWheel.removeEventListener("wheel",this.wheelFunction)}},{key:"down",value:function(t){if(!this.viewport.pause&&this.viewport.worldVisible){if("mouse"===t.data.pointerType?this.isMouseDown=!0:this.get(t.data.pointerId)||this.touches.push({id:t.data.pointerId,last:null}),1===this.count()){this.last=t.data.global.clone();var e=this.viewport.plugins.get("decelerate",!0),n=this.viewport.plugins.get("bounce",!0);e&&e.isActive()||n&&n.isActive()?this.clickedAvailable=!1:this.clickedAvailable=!0}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}}},{key:"clear",value:function(){this.isMouseDown=!1,this.touches=[],this.last=null}},{key:"checkThreshold",value:function(t){return Math.abs(t)>=this.viewport.threshold}},{key:"move",value:function(t){if(!this.viewport.pause&&this.viewport.worldVisible){var e=this.viewport.plugins.move(t);if(this.clickedAvailable&&this.last){var n=t.data.global.x-this.last.x,r=t.data.global.y-this.last.y;(this.checkThreshold(n)||this.checkThreshold(r))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}}},{key:"up",value:function(t){if(!this.viewport.pause&&this.viewport.worldVisible){"mouse"===t.data.pointerType&&(this.isMouseDown=!1),"mouse"!==t.data.pointerType&&this.remove(t.data.pointerId);var e=this.viewport.plugins.up(t);this.clickedAvailable&&0===this.count()&&this.last&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}}},{key:"getPointerPosition",value:function(t){var e=new X.E9;if(this.viewport.options.interaction)this.viewport.options.interaction.mapPositionToPoint(e,t.clientX,t.clientY);else if(this.viewport.options.useDivWheelForInputManager&&this.viewport.options.divWheel){var n=this.viewport.options.divWheel.getBoundingClientRect();e.x=t.clientX-n.left,e.y=t.clientY-n.top}else e.x=t.clientX,e.y=t.clientY;return e}},{key:"handleWheel",value:function(t){if(!this.viewport.pause&&this.viewport.worldVisible&&(!this.viewport.options.interaction||this.viewport.options.interaction.interactionDOMElement===t.target)){var e=this.viewport.toLocal(this.getPointerPosition(t));if(this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom)this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}}},{key:"pause",value:function(){this.touches=[],this.isMouseDown=!1}},{key:"get",value:function(t){var e,n=z(this.touches);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.id===t)return r}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"remove",value:function(t){for(var e=0;e<this.touches.length;e++)if(this.touches[e].id===t)return void this.touches.splice(e,1)}},{key:"count",value:function(){return(this.isMouseDown?1:0)+this.touches.length}}]),t}();function It(t){for(var e=void 0,n=t[0],r=1;r<t.length;){var i=t[r],s=t[r+1];if(r+=2,("optionalAccess"===i||"optionalCall"===i)&&null==n)return;"access"===i||"optionalAccess"===i?(e=n,n=s(n)):"call"!==i&&"optionalCall"!==i||(n=s((function(){for(var t,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(t=n).call.apply(t,[e].concat(i))})),e=void 0)}return n}var Pt=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"],Mt=function(){function t(e){(0,G.Z)(this,t),this.viewport=e,this.list=[],this.plugins={}}return(0,H.Z)(t,[{key:"add",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pt.length,r=this.plugins[t];r&&r.destroy(),this.plugins[t]=e;var i=Pt.indexOf(t);-1!==i&&Pt.splice(i,1),Pt.splice(n,0,t),this.sort()}},{key:"get",value:function(t,e){return e&&It([this,"access",function(t){return t.plugins},"access",function(e){return e[t]},"optionalAccess",function(t){return t.paused}])?null:this.plugins[t]}},{key:"update",value:function(t){var e,n=z(this.list);try{for(n.s();!(e=n.n()).done;){e.value.update(t)}}catch(r){n.e(r)}finally{n.f()}}},{key:"resize",value:function(){var t,e=z(this.list);try{for(e.s();!(t=e.n()).done;){t.value.resize()}}catch(n){e.e(n)}finally{e.f()}}},{key:"reset",value:function(){var t,e=z(this.list);try{for(e.s();!(t=e.n()).done;){t.value.reset()}}catch(n){e.e(n)}finally{e.f()}}},{key:"removeAll",value:function(){this.list.forEach((function(t){t.destroy()})),this.plugins={},this.sort()}},{key:"remove",value:function(t){this.plugins[t]&&(It([this,"access",function(t){return t.plugins},"access",function(e){return e[t]},"optionalAccess",function(t){return t.destroy},"call",function(t){return t()}]),delete this.plugins[t],this.viewport.emit("".concat(t,"-remove")),this.sort())}},{key:"pause",value:function(t){It([this,"access",function(t){return t.plugins},"access",function(e){return e[t]},"optionalAccess",function(t){return t.pause},"call",function(t){return t()}])}},{key:"resume",value:function(t){It([this,"access",function(t){return t.plugins},"access",function(e){return e[t]},"optionalAccess",function(t){return t.resume},"call",function(t){return t()}])}},{key:"sort",value:function(){this.list=[];var t,e=z(Pt);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.plugins[n]&&this.list.push(this.plugins[n])}}catch(r){e.e(r)}finally{e.f()}}},{key:"down",value:function(t){var e,n=!1,r=z(this.list);try{for(r.s();!(e=r.n()).done;){e.value.down(t)&&(n=!0)}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"move",value:function(t){var e,n=!1,r=z(this.viewport.plugins.list);try{for(r.s();!(e=r.n()).done;){e.value.move(t)&&(n=!0)}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"up",value:function(t){var e,n=!1,r=z(this.list);try{for(r.s();!(e=r.n()).done;){e.value.up(t)&&(n=!0)}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"wheel",value:function(t){var e,n=!1,r=z(this.list);try{for(r.s();!(e=r.n()).done;){e.value.wheel(t)&&(n=!0)}}catch(i){r.e(i)}finally{r.f()}return n}}]),t}(),Ct={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,interaction:null,disableOnContextMenu:!1,ticker:j.vB.shared},Ot=function(t){(0,Z.Z)(n,t);var e=Y(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,G.Z)(this,n),t=e.call(this),n.prototype.__init.call((0,L.Z)(t)),t.options=Object.assign({},{divWheel:document.body},Ct,r),t.screenWidth=t.options.screenWidth,t.screenHeight=t.options.screenHeight,t._worldWidth=t.options.worldWidth,t._worldHeight=t.options.worldHeight,t.forceHitArea=t.options.forceHitArea,t.threshold=t.options.threshold,t.options.divWheel=t.options.divWheel||document.body,t.options.disableOnContextMenu&&t.options.divWheel.addEventListener("contextmenu",t._disableOnContextMenu),t.options.noTicker||(t.tickerFunction=function(){return t.update(t.options.ticker.elapsedMS)},t.options.ticker.add(t.tickerFunction)),t.input=new St((0,L.Z)(t)),t.plugins=new Mt((0,L.Z)(t)),t}return(0,H.Z)(n,[{key:"__init",value:function(){this._disableOnContextMenu=function(t){return t.preventDefault()}}},{key:"destroy",value:function(t){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.options.disableOnContextMenu&&this.options.divWheel.removeEventListener("contextmenu",this._disableOnContextMenu),this.input.destroy(),(0,B.Z)((0,U.Z)(n.prototype),"destroy",this).call(this,t)}},{key:"update",value:function(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new X.Ae(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.innerWidth,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerHeight,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.screenWidth=t,this.screenHeight=e,void 0!==n&&(this._worldWidth=n),void 0!==r&&(this._worldHeight=r),this.plugins.resize(),this.dirty=!0}},{key:"worldWidth",get:function(){return this._worldWidth?this._worldWidth:this.width/this.scale.x},set:function(t){this._worldWidth=t,this.plugins.resize()}},{key:"worldHeight",get:function(){return this._worldHeight?this._worldHeight:this.height/this.scale.y},set:function(t){this._worldHeight=t,this.plugins.resize()}},{key:"getVisibleBounds",value:function(){return new X.Ae(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}},{key:"toWorld",value:function(t,e){return 2===arguments.length?this.toLocal(new X.E9(t,e)):this.toLocal(t)}},{key:"toScreen",value:function(t,e){return 2===arguments.length?this.toGlobal(new X.E9(t,e)):this.toGlobal(t)}},{key:"worldScreenWidth",get:function(){return this.screenWidth/this.scale.x}},{key:"worldScreenHeight",get:function(){return this.screenHeight/this.scale.y}},{key:"screenWorldWidth",get:function(){return this.worldWidth*this.scale.x}},{key:"screenWorldHeight",get:function(){return this.worldHeight*this.scale.y}},{key:"center",get:function(){return new X.E9(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)},set:function(t){this.moveCenter(t)}},{key:"moveCenter",value:function(){for(var t,e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];"number"==typeof r[0]?(t=r[0],e=r[1]):(t=r[0].x,e=r[0].y);var s=(this.worldScreenWidth/2-t)*this.scale.x,a=(this.worldScreenHeight/2-e)*this.scale.y;return this.x===s&&this.y===a||(this.position.set(s,a),this.plugins.reset(),this.dirty=!0),this}},{key:"corner",get:function(){return new X.E9(-this.x/this.scale.x,-this.y/this.scale.y)},set:function(t){this.moveCorner(t)}},{key:"moveCorner",value:function(){for(var t,e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return 1===r.length?(t=-r[0].x*this.scale.x,e=-r[0].y*this.scale.y):(t=-r[0]*this.scale.x,e=-r[1]*this.scale.y),t===this.x&&e===this.y||(this.position.set(t,e),this.plugins.reset(),this.dirty=!0),this}},{key:"screenWidthInWorldPixels",get:function(){return this.screenWidth/this.scale.x}},{key:"screenHeightInWorldPixels",get:function(){return this.screenHeight/this.scale.y}},{key:"findFitWidth",value:function(t){return this.screenWidth/t}},{key:"findFitHeight",value:function(t){return this.screenHeight/t}},{key:"findFit",value:function(t,e){var n=this.screenWidth/t,r=this.screenHeight/e;return Math.min(n,r)}},{key:"findCover",value:function(t,e){var n=this.screenWidth/t,r=this.screenHeight/e;return Math.max(n,r)}},{key:"fitWidth",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.worldWidth,n=arguments.length>1?arguments[1]:void 0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;n&&(t=this.center),this.scale.x=this.screenWidth/e,r&&(this.scale.y=this.scale.x);var s=this.plugins.get("clamp-zoom",!0);return!i&&s&&s.clamp(),n&&t&&this.moveCenter(t),this}},{key:"fitHeight",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.worldHeight,n=arguments.length>1?arguments[1]:void 0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;n&&(t=this.center),this.scale.y=this.screenHeight/e,r&&(this.scale.x=this.scale.y);var s=this.plugins.get("clamp-zoom",!0);return!i&&s&&s.clamp(),n&&t&&this.moveCenter(t),this}},{key:"fitWorld",value:function(t){var e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;var n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),t&&e&&this.moveCenter(e),this}},{key:"fit",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.worldWidth,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.worldHeight;t&&(e=this.center),this.scale.x=this.screenWidth/n,this.scale.y=this.screenHeight/r,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;var i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),t&&e&&this.moveCenter(e),this}},{key:"setZoom",value:function(t,e){var n;e&&(n=this.center),this.scale.set(t);var r=this.plugins.get("clamp-zoom",!0);return r&&r.clamp(),e&&n&&this.moveCenter(n),this}},{key:"zoomPercent",value:function(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}},{key:"zoom",value:function(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}},{key:"scaled",get:function(){return this.scale.x},set:function(t){this.setZoom(t,!0)}},{key:"snapZoom",value:function(t){return this.plugins.add("snap-zoom",new kt(this,t)),this}},{key:"OOB",value:function(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new X.E9(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}},{key:"right",get:function(){return-this.x/this.scale.x+this.worldScreenWidth},set:function(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}},{key:"left",get:function(){return-this.x/this.scale.x},set:function(t){this.x=-t*this.scale.x,this.plugins.reset()}},{key:"top",get:function(){return-this.y/this.scale.y},set:function(t){this.y=-t*this.scale.y,this.plugins.reset()}},{key:"bottom",get:function(){return-this.y/this.scale.y+this.worldScreenHeight},set:function(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}},{key:"dirty",get:function(){return!!this._dirty},set:function(t){this._dirty=t}},{key:"forceHitArea",get:function(){return this._forceHitArea},set:function(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new X.Ae(0,0,this.worldWidth,this.worldHeight))}},{key:"drag",value:function(t){return this.plugins.add("drag",new vt(this,t)),this}},{key:"clamp",value:function(t){return this.plugins.add("clamp",new ut(this,t)),this}},{key:"decelerate",value:function(t){return this.plugins.add("decelerate",new dt(this,t)),this}},{key:"bounce",value:function(t){return this.plugins.add("bounce",new at(this,t)),this}},{key:"pinch",value:function(t){return this.plugins.add("pinch",new bt(this,t)),this}},{key:"snap",value:function(t,e,n){return this.plugins.add("snap",new Et(this,t,e,n)),this}},{key:"follow",value:function(t,e){return this.plugins.add("follow",new mt(this,t,e)),this}},{key:"wheel",value:function(t){return this.plugins.add("wheel",new Rt(this,t)),this}},{key:"animate",value:function(t){return this.plugins.add("animate",new rt(this,t)),this}},{key:"clampZoom",value:function(t){return this.plugins.add("clamp-zoom",new lt(this,t)),this}},{key:"mouseEdges",value:function(t){return this.plugins.add("mouse-edges",new xt(this,t)),this}},{key:"pause",get:function(){return!!this._pause},set:function(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}},{key:"ensureVisible",value:function(t,e,n,r,i){i&&(n>this.worldScreenWidth||r>this.worldScreenHeight)&&(this.fit(!0,n,r),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));var s=!1;t<this.left?(this.left=t,s=!0):t+n>this.right&&(this.right=t+n,s=!0),e<this.top?(this.top=e,s=!0):e+r>this.bottom&&(this.bottom=e+r,s=!0),s&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}]),n}(W.W2),Dt={customDisplayObject:function(t){var e=t.app,n=t.width,r=t.height;return new Ot({screenWidth:n,screenHeight:r,interaction:e.renderer.plugins.interaction})},customApplyProps:function(t,e,n){var r=n.width,i=n.height,s=n.x,a=n.y,o=n.zoom;t.screenWidth=r,t.screenHeight=i,void 0!==s&&void 0!==a&&void 0!==o&&(t.setZoom(o),t.moveCenter(s,a))}},Bt=(0,a.Yh)(Dt,"Viewport"),Nt=function(t){var e=t.children,n=(0,a.NA)(),i=(0,f.v9)(d.ef),s=i.width,o=i.height,u=(0,f.v9)(d.Ut),h=u.x,l=u.y,c=u.zoom;return r.createElement(Bt,{app:n,width:s,height:o,x:h,y:l,zoom:c},e)},Lt=function(){function t(t,e,n){var r=this;this.code=t,this.isDown=!1,this.isUp=!0,this.press=e,this.release=n,this.downHandler=function(t){t.keyCode===r.code&&(r.isUp&&r.press&&r.press(),r.isDown=!0,r.isUp=!1,t.preventDefault())},this.upHandler=function(t){t.keyCode===r.code&&(r.isDown&&r.release&&r.release(),r.isDown=!1,r.isUp=!0,t.preventDefault())},window.addEventListener("keydown",this.downHandler,!1),window.addEventListener("keyup",this.upHandler,!1)}return t.prototype.close=function(){window.removeEventListener("keydown",this.downHandler),window.removeEventListener("keyup",this.upHandler)},t}(),Zt=n(4481),Ft=(n(8559),function(){function t(){this.to=[],this.from=[],this.isSwitch=!1,this.isEmpty=!0,this.isCart=!1,this.switched={from:void 0,to:void 0}}var e=t.prototype;return e.addTo=function(t){this.to.push(t),this.to.sort((function(t,e){return t-e})),this.onRailAdded()},e.addFrom=function(t){this.from.push(t),this.from.sort((function(t,e){return t-e})),this.onRailAdded()},e.onRailAdded=function(){this.isEmpty=!1,this.isSwitch=this.railsCount()>2,this.isSwitch&&(this.switched={from:Math.floor(Math.random()*this.from.length),to:Math.floor(Math.random()*this.to.length)})},e.isConnectedTo=function(t){return this.to.indexOf(t)>=0},e.switchPrefered=function(t,e){t===s.pX?this.to.length>=2?this.switchTo(e):this.switchFrom(e):this.from.length>=2?this.switchFrom(e):this.switchTo(e)},e.switchTo=function(t){this.switched.to=t},e.switchFrom=function(t){this.switched.from=t},e.railsCount=function(){return this.from.length+this.to.length},e.getData=function(){return{to:this.to,from:this.from,isSwitch:this.isSwitch,isEmpty:this.isEmpty,isCart:this.isCart,switched:this.switched}},t}()),Ut=function(){function t(){this.initGenarator()}var e=t.prototype;return e.generate=function(t,e){var n=[];n[0]={0:new Ft},n[0][0].addFrom(0);for(var r=1;r<t-1;r++){var i=function(t,e){return void 0===e?Math.pow(Math.abs(Math.sin(t)),2):e+Math.pow(Math.abs(Math.sin(t)),2)*(1-e)},s=e*i(r/321,.3)*Math.min(1,i((r+1)/10)+i((r-64)/41))*i(10*Math.sin(r/51),.5),a=Math.max(1,Math.min(e,Math.min(r,t-r))),o=Math.min(a,2*Math.floor(s)+1);this.generateColumn(n,o,!1)}for(var u=0;u<40;u++)this.generateColumn(n,1,!0);return n[n.length-1][0].addTo(0),n.map((function(t){return Object.fromEntries(Object.entries(t).map((function(t){return[t[0],t[1].getData()]})))}))},e.generateColumn=function(t,e,n){for(var r=this,i=Math.floor(e/2),a={},o=-i;o<=i;o++)a[o]=new Ft;t.push(a);var u=t[t.length-2];if(Object.keys(u).forEach((function(t){t=parseInt(t,10);var e=r.railGenerators.filter((function(e){return e.canUse(u,a,t)}));e.length>0&&e[Math.floor(Math.random()*e.length)].use(u,a,t)})),!n)for(var h in a){var l=a[h];Math.random()<s.bA&&(l.isCart=!0)}},e.initGenarator=function(){var t=this;this.railGenerators=[];var e=function(e,n){for(var r=0;r<n;r++)t.railGenerators.push(e)};e({canUse:function(t,e,n){return void 0!==e[n]},use:function(e,n,r){t.connectRails(e[r],r,n[r],r)}},8),e({canUse:function(t,e,n){return void 0!==e[n+1]},use:function(e,n,r){t.connectRails(e[r],r,n[r+1],r+1)}},2),e({canUse:function(t,e,n){return void 0!==e[n-1]},use:function(e,n,r){t.connectRails(e[r],r,n[r-1],r-1)}},2),e({canUse:function(t,e,n){return void 0!==e[n]&&void 0!==e[n+1]&&e[n+1].railsCount()<=2&&e[n].railsCount()<=2&&t[n].railsCount()<=2},use:function(e,n,r){t.connectRails(e[r],r,n[r+1],r+1),t.connectRails(e[r],r,n[r],r)}},3),e({canUse:function(t,e,n){return void 0!==e[n]&&void 0!==e[n-1]&&e[n-1].railsCount()<=2&&e[n].railsCount()<=2&&t[n].railsCount()<=2},use:function(e,n,r){t.connectRails(e[r],r,n[r-1],r-1),t.connectRails(e[r],r,n[r],r)}},3)},e.connectRails=function(t,e,n,r){t.addTo(r),n.addFrom(e)},t}(),Gt=n(9627),Ht=function(){return function(t,e){e();t(Xt(1)),t(Wt())}},Xt=function(t){return function(e,n){n();var r=s.lg+t*s.on,i=s.n2+t*s.fd,a=(new Ut).generate(r,i);e((0,Zt.Aq)({rails:a,level:t})),setTimeout((function(){e(zt(t)),e((0,p.I1)({train:0,path:(0,Zt.dY)(n(),0,0,s.pX)}))}))}},Wt=function(){return function(t,e){var n=e(),r=(0,Zt.dY)(n,0,0,s.pX);t((0,p.qd)({clear:!0,x:-5,y:0,path:r}))}},jt=function(t,e,n,r,i,a){var o=r[i],u=o.carts[0],h=Math.floor(u.x/s.jZ);if(!o.isCrashed&&h>=(0,Zt.aZ)(e)&&0==i){t((0,p.FB)({train:i}));var l=(0,Zt.s6)(e);return t(Xt(l+1)),!0}if(!o.isCrashed&&h<0||void 0!==o.path[h]){var c=o.speed;o.speed>s.lz&&(c=o.speed-s.dv,t((0,p.j4)({train:i,speed:c})));var f=function(t){if(t<0)return 0;var e=s.T0*o.path[Math.floor(t/s.jZ)],n=s.T0*o.path[Math.floor(t/s.jZ)+1];return Object.is(n,NaN)&&(n=e),e+t%s.jZ/s.jZ*(n-e)},d=function(t){if(t<0)return 0;var e=f(t-s.eM),n=f(t+s.eM);return Math.atan((n-e)/s.ak)},v=o.carts.map((function(t){return{x:t.x,y:t.y}}));v[0].x=u.x+o.direction*c*n,v[0].y=f(v[0].x),t((0,p.gX)({train:i,cart:0,x:v[0].x,y:v[0].y,rotation:d(v[0].x)}));var y=Math.round(v[0].x/s.jZ),m=o.path[y];(0,Zt.dk)(e,y,m)&&(t((0,p.Z5)({train:i})),t((0,Zt.HB)({x:y,y:m})));for(var g=1;g<v.length;g++){var x=v[g].x-v[g-1].x,_=v[g].y-v[g-1].y,b=s.AA/Math.sqrt(x*x+_*_);x*=b,_*=b;var w=o.carts[g].y-f(v[g].x);Math.abs(w)>s.Tk&&(w=Math.sign(w)*s.Tk),v[g].x=v[g-1].x+x,v[g].y=v[g-1].y+_,t((0,p.gX)({train:i,cart:g,x:v[g].x,y:v[g].y,rotation:d(v[g].x),skew:w}))}r.forEach((function(n,r){r!==i&&(n.isCrashed||n.isEnemy!==o.isEnemy&&n.carts.forEach((function(h){var l=h.x-u.x,c=h.y-u.y;if(Math.sqrt(l*l+c*c)<(o.isEnemy?.81*s.yR:s.yR)){var f=o.carts.length-n.carts.length,d=n.carts.length-o.carts.length,v=f<1&&d>=1||f>=1&&d<1;if(a.includes(r+":"+i)||a.includes(i+":"+r))return void console.log("alreadyColided",r,i,a);if(t((0,p.ZC)({train:i,carts:Math.max(1,f)})),f<1)if(0==i){console.log("m1"),t((0,p.zI)({train:i,speed:Math.max(o.speed,n.speed),hard:v,bounce:!v}));var y=(0,p.gA)(e);y>0&&t((0,Gt.n4)({score:y}))}else console.log("m2"),t((0,p.zI)({train:i,speed:Math.max(o.speed,n.speed),bounce:!0}));if(t((0,p.ZC)({train:r,carts:Math.max(1,d)})),d<1)if(0==r){console.log("ma"),t((0,p.zI)({train:r,speed:Math.max(o.speed,n.speed),hard:v,bounce:!v}));var m=(0,p.gA)(e);m>0&&t((0,Gt.n4)({score:m}))}else console.log("mb"),t((0,p.zI)({train:r,speed:Math.max(o.speed,n.speed),bounce:!0}));a.push(i+":"+r)}})))}))}else{if(!o.isCrashed){t((0,p.zI)({train:i}));var E=(0,p.gA)(e);E>0&&t((0,Gt.n4)({score:E}))}var T=o.speed*s.S;t((0,p.j4)({train:i,speed:T}));var k=o.carts.map((function(t){return{x:t.x,y:t.y}})),A=(u.rotation||0)+Math.min(3,T)*(Math.random()-.5)*.2*n;k[0].x=u.x+T*Math.cos(A)*n,k[0].y=u.y+T*Math.sin(A)*n,t((0,p.gX)({train:i,cart:0,x:k[0].x,y:k[0].y,rotation:A,skew:(u.skew+s.gk)/2}));for(var R=1;R<k.length;R++){var S=k[R].x-k[R-1].x,I=k[R].y-k[R-1].y,P=s.AA/Math.sqrt(S*S+I*I);S*=P,I*=P,k[R].x=k[R-1].x+S,k[R].y=k[R-1].y+I,t((0,p.gX)({train:i,cart:R,x:k[R].x,y:k[R].y,rotation:Math.min(Math.max(Math.atan(I/S),-1),1),skew:(o.carts[R].skew+s.gk)/2}))}}},zt=function(t){return function(e,n){var r=n(),i=(0,Zt.yC)(r),a=s.Do+t*s.UC;for(var o in i){var u=parseInt(o);if(Object.keys(i[o]).length>1)for(var h in i[o]){var l=parseInt(h);if(Math.random()<a){var c=(0,Zt.dY)(r,u,l,s.RL);e((0,p.qd)({x:u,y:l,path:c,direction:s.RL,isEnemy:!0}))}}}}},Vt=function(t){var e=t.x,n=t.y,r=t.value;return function(t,i){var a=i(),o=(0,p.VM)(a);t((0,Zt.VQ)({x:e,y:n,side:o.direction==s.pX?"to":"from",value:r}));for(var u=i(),h=Math.max(0,Math.floor(o.carts[0].x/s.jZ)),l=o.path[h],c=(0,Zt.dY)(u,h,l,o.direction),f=o.path.slice(),d=h;d<c.length;d++)f[d]=c[d];t((0,p.I1)({train:0,path:f}))}},Yt=function(){var t=(0,f.I0)(),e=(0,f.v9)(Zt.yC),n=(0,f.v9)(Zt.xq),i=(0,f.v9)(p.VM),o=(0,f.v9)(p.a5),u=(0,r.useState)(),h=u[0],l=u[1];return(0,r.useEffect)((function(){var t={up:new Lt(38),down:new Lt(40),left:new Lt(37),right:new Lt(39),space:new Lt(32)};return l(t),function(){Object.values(t).forEach((function(t){t.close()}))}}),[]),(0,r.useEffect)((function(){t(Ht()),t((0,Gt.GD)())}),[]),(0,a.HC)((function(e){t(function(t){return function(e,n){var r=n(),i=(0,p.r4)(r),s=(0,d.g2)(r),a=[];for(var o in i){var u=i[o].carts[0].x;if((0==o||u>=s.x&&u<s.x+s.width)&&jt(e,r,t,i,o,a))break}}}(e)),t((function(t,e){var n=e(),r=(0,p.VM)(n);if(r){for(var i=(0,Zt.xq)(n),s=(0,p.lJ)(n).x+r.direction;s<r.path.length&&!(0,Zt.oG)(n,s,r.path[s]);)s+=r.direction;i.x===s&&i.y===r.path[s]||t((0,Zt.KJ)({x:s,y:r.path[s]}))}})),h&&i&&(i.isCrashed||(h.up.isDown&&void 0!==n.x&&void 0!==n.y&&t(Vt({x:n.x,y:n.y,value:0})),h.down.isDown&&void 0!==n.x&&void 0!==n.y&&t(Vt({x:n.x,y:n.y,value:1})),h.left.isDown&&t((function(t,e){var n=e(),r=(0,p.VM)(n);(void 0===s.sb||r.speed>s.sb)&&t((0,p.j4)({train:0,speed:r.speed-s.tm*Math.pow(s.Hd,r.carts.length)}))})),h.right.isDown&&t((function(t,e){var n=e(),r=(0,p.VM)(n);(void 0===s.nR||r.speed<s.nR)&&t((0,p.j4)({train:0,speed:r.speed+s.tm*Math.pow(s.Hd,r.carts.length)}))})),(h.up.isDown||h.down.isDown||h.left.isDown||h.right.isDown)&&t((0,p.hA)())),h.space.isDown&&(i.isCrashed||s.PX)&&t(Ht()))})),r.createElement(r.Fragment,null,e&&r.createElement(I,{rails:e,switchCursor:n,switchPath:i&&i.path}),i&&r.createElement(D,{train:i}),o.map((function(t,e){return r.createElement(D,{key:e,train:t})})))},Kt=n(5715),qt=n(1082),$t=function(){var t=(0,f.v9)(Zt.s6),e=(0,f.v9)(p._G),n=(0,f.v9)(p.gA),i=(0,f.v9)(p.v1),s=(0,f.v9)(p.Wd),a=(0,f.v9)(p.cO);return r.createElement("div",{className:"overlay"},r.createElement("div",{className:"v-top h-right"},r.createElement("div",{className:"stats"},r.createElement("i",null,""),r.createElement("span",{className:"carts"},e),r.createElement("i",null,""),r.createElement("span",{className:"score"},n)),r.createElement("div",{className:"stats"},r.createElement("span",{className:"speed"},Math.round(100*i)/100,r.createElement("abbr",null," km/s")))),s?r.createElement("div",{className:"v-center h-center"},r.createElement("span",{className:"title"},"Crashed"),r.createElement(Kt.Z,{size:10,score:n}),r.createElement("span",{className:"hint"},"Press space to continue")):t&&r.createElement("div",{key:t,className:"v-center h-center animate-level"},r.createElement("span",{className:"title"},"Level ",t)),r.createElement("div",{className:"v-bottom h-center"},r.createElement("span",{className:"hint",style:{opacity:a}},"hold  and  to control train speed,  and  for railroad switches")),r.createElement("div",{className:"v-bottom h-right"},r.createElement("button",{onClick:function(){return(0,qt.navigate)("/leaderboard")}},"Leaderboard")))},Qt=n(8571),Jt=function(){var t=(0,f.I0)(),e=(0,f.v9)(d.ef),n=e.width,i=e.height,s=function(){t((0,d.SI)({width:window.innerWidth,height:window.innerHeight}))};return(0,r.useEffect)((function(){return window.addEventListener("resize",s),function(){window.removeEventListener("resize",s)}}),[]),r.createElement(r.Fragment,null,"undefined"!=typeof window&&r.createElement(a.Hf,{options:{backgroundColor:c.P6Y.string2hex("white"),width:n,height:i,antialias:!0,autoDensity:!0,resolution:2}},r.createElement(f.zt,{store:Qt.Z},r.createElement(Nt,null,r.createElement(Yt,null)))),r.createElement(f.zt,{store:Qt.Z},r.createElement($t,null)))},te=function(){return r.createElement(f.zt,{store:Qt.Z},r.createElement(Jt,null),r.createElement($t,null))},ee=function(t){var e=t.data.site;return r.createElement(i.Z,{siteMetadata:e.siteMetadata},r.createElement("main",null,r.createElement(te,null)))}},7061:function(t,e,n){var r=n(8698).default;function i(){"use strict";t.exports=i=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},n=Object.prototype,s=n.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},u=o.iterator||"@@iterator",h=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(M){c=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var i=e&&e.prototype instanceof v?e:v,s=Object.create(i.prototype),o=new S(r||[]);return a(s,"_invoke",{value:T(t,n,o)}),s}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(M){return{type:"throw",arg:M}}}e.wrap=f;var p={};function v(){}function y(){}function m(){}var g={};c(g,u,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(I([])));_&&_!==n&&s.call(_,u)&&(g=_);var b=m.prototype=v.prototype=Object.create(g);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(i,a,o,u){var h=d(t[i],t,a);if("throw"!==h.type){var l=h.arg,c=l.value;return c&&"object"==r(c)&&s.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,u)}),(function(t){n("throw",t,o,u)})):e.resolve(c).then((function(t){l.value=t,o(l)}),(function(t){return n("throw",t,o,u)}))}u(h.arg)}var i;a(this,"_invoke",{value:function(t,r){function s(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(s,s):s()}})}function T(t,e,n){var r="suspendedStart";return function(i,s){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw s;return P()}for(n.method=i,n.arg=s;;){var a=n.delegate;if(a){var o=k(a,n);if(o){if(o===p)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=d(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function k(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=d(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,p;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(t){if(t){var e=t[u];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(s.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:P}}function P(){return{value:void 0,done:!0}}return y.prototype=m,a(b,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:y,configurable:!0}),y.displayName=c(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,c(t,l,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},w(E.prototype),c(E.prototype,h,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,i,s){void 0===s&&(s=Promise);var a=new E(f(t,n,r,i),s);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(b),c(b,l,"Generator"),c(b,u,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=I,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var o=s.call(i,"catchLoc"),u=s.call(i,"finallyLoc");if(o&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:I(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},8698:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},4687:function(t,e,n){var r=n(7061)();t.exports=r;try{regeneratorRuntime=r}catch(i){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},7326:function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,{Z:function(){return r}})},5861:function(t,e,n){"use strict";function r(t,e,n,r,i,s,a){try{var o=t[s](a),u=o.value}catch(h){return void n(h)}o.done?e(u):Promise.resolve(u).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,s){var a=t.apply(e,n);function o(t){r(a,i,s,o,u,"next",t)}function u(t){r(a,i,s,o,u,"throw",t)}o(void 0)}))}}n.d(e,{Z:function(){return i}})},5671:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,{Z:function(){return r}})},3144:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var r=n(9142);function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(0,r.Z)(i.key),i)}}function s(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}},1752:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var r=n(1120);function i(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=(0,r.Z)(t)););return t}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=i(t,e);if(r){var s=Object.getOwnPropertyDescriptor(r,e);return s.get?s.get.call(arguments.length<3?t:n):s.value}},s.apply(this,arguments)}},1120:function(t,e,n){"use strict";function r(t){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},r(t)}n.d(e,{Z:function(){return r}})},136:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(9611);function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&(0,r.Z)(t,e)}},2963:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var r=n(1002),i=n(7326);function s(t,e){if(e&&("object"===(0,r.Z)(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(t)}}}]);
//# sourceMappingURL=component---src-pages-index-js-836ed9b2d609e1dc419d.js.map